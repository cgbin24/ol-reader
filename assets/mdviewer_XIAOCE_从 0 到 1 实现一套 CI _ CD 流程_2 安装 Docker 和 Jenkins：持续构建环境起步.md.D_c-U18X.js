import{_ as s}from"./app.BdTF1atn.js";import{j as e,i,Z as a}from"./chunks/@vue.D6nrJjhM.js";/* empty css                          */import"./chunks/@vueuse.ErXst1iV.js";const y=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"mdviewer/XIAOCE/ä» 0 åˆ° 1 å®ç°ä¸€å¥— CI & CD æµç¨‹/2 å®‰è£… Docker å’Œ Jenkinsï¼šæŒç»­æ„å»ºç¯å¢ƒèµ·æ­¥.md","filePath":"mdviewer/XIAOCE/ä» 0 åˆ° 1 å®ç°ä¸€å¥— CI & CD æµç¨‹/2 å®‰è£… Docker å’Œ Jenkinsï¼šæŒç»­æ„å»ºç¯å¢ƒèµ·æ­¥.md"}'),n={name:"mdviewer/XIAOCE/ä» 0 åˆ° 1 å®ç°ä¸€å¥— CI & CD æµç¨‹/2 å®‰è£… Docker å’Œ Jenkinsï¼šæŒç»­æ„å»ºç¯å¢ƒèµ·æ­¥.md"},d=a(`<h3 id="å‰è¨€" tabindex="-1">å‰è¨€ â€‹</h3><p>åœ¨ç¬¬ä¸€ç« ï¼Œæˆ‘ä»¬å·²ç»å¤§è‡´äº†è§£è¿‡ <code>CI/CD</code> çš„ä½œç”¨å’Œå†å²ã€‚ä»è¿™ä¸€ç« èµ·ï¼Œæˆ‘ä»¬å°†æ­£å¼å¼€å¯æ­å»ºä¸€å¥— <code>CI/CD</code> æµç¨‹ã€‚åœ¨å¼€å§‹ä¹‹å‰ï¼Œé¦–å…ˆè¦å­¦ä¹ ä¸‹è´¯ç©¿æˆ‘ä»¬å°å†Œå…¨ç¨‹çš„ä¸€ä¸ªæŠ€æœ¯ï¼š<code>Docker å’Œ Jenkins</code></p><h3 id="ä»€ä¹ˆæ˜¯-docker" tabindex="-1">ä»€ä¹ˆæ˜¯ Docker â€‹</h3><p><code>Docker</code> æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ã€‚å¼€å‘è€…å¯ä»¥å°†è‡ªå·±çš„åº”ç”¨æ‰“åŒ…åœ¨è‡ªå·±çš„é•œåƒé‡Œé¢ï¼Œç„¶åè¿ç§»åˆ°å…¶ä»–å¹³å°çš„ <code>Docker</code> ä¸­ã€‚é•œåƒä¸­å¯ä»¥å­˜æ”¾ä½ è‡ªå·±è‡ªå®šä¹‰çš„è¿è¡Œç¯å¢ƒï¼Œæ–‡ä»¶ï¼Œä»£ç ï¼Œè®¾ç½®ç­‰ç­‰å†…å®¹ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒç¯å¢ƒé€ æˆçš„è¿è¡Œé—®é¢˜ã€‚é•œåƒå…±äº«è¿è¡Œæœºå™¨çš„ç³»ç»Ÿå†…æ ¸ã€‚</p><p>åŒæ ·ï¼Œ <code>Docker</code> ä¹Ÿæ”¯æŒè·¨å¹³å°ã€‚ä½ çš„é•œåƒä¹Ÿå¯ä»¥åŠ è½½åœ¨ <code>Windows</code> å’Œ <code>Linux</code>ï¼Œå®ç°å¿«é€Ÿè¿è¡Œå’Œéƒ¨ç½²ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0f582c982b59497fa8527d751ca2c2c7~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><p><code>Docker</code> çš„ä¼˜åŠ¿åœ¨äº å¿«é€Ÿï¼Œè½»é‡ï¼Œçµæ´»ã€‚å¼€å‘è€…å¯ä»¥åˆ¶ä½œä¸€ä¸ªè‡ªå·±è‡ªå®šä¹‰çš„é•œåƒï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å®˜æ–¹æˆ–è€…å…¶ä»–å¼€å‘è€…çš„é•œåƒæ¥å¯åŠ¨ä¸€ä¸ªæœåŠ¡ã€‚é€šè¿‡å°†é•œåƒåˆ›å»ºä¸ºå®¹å™¨ï¼Œå®¹å™¨ä¹‹é—´ç›¸äº’éš”ç¦»èµ„æºå’Œè¿›ç¨‹ä¸å†²çªã€‚ä½†ç¡¬ä»¶èµ„æºåˆæ˜¯å…±äº«çš„ã€‚ åˆ›å»ºçš„é•œåƒä¹Ÿå¯ä»¥é€šè¿‡æ–‡ä»¶å¿«é€Ÿåˆ†äº«ï¼Œä¹Ÿå¯ä»¥ä¸Šä¼ åˆ°é•œåƒåº“è¿›è¡Œå­˜å–å’Œç®¡ç†ã€‚åŒæ—¶ <code>Docker</code> çš„é•œåƒæœ‰ <code>åˆ†å±‚ç­–ç•¥</code> ï¼Œæ¯æ¬¡å¯¹é•œåƒçš„æ›´æ–°æ“ä½œï¼Œéƒ½ä¼šå †å ä¸€ä¸ªæ–°å±‚ã€‚å½“ä½ æ‹‰å– / æ¨é€æ–°ç‰ˆæœ¬é•œåƒæ—¶ï¼Œåªæ¨é€ / æ‹‰å–ä¿®æ”¹çš„éƒ¨åˆ†ã€‚å¤§å¤§åŠ å¿«äº†é•œåƒçš„ä¼ è¾“æ•ˆç‡</p><p>é‚£ä¹ˆ <code>Docker</code> åœ¨ <code>CI/CD</code> ä¸­çš„ä½œç”¨æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p><code>Docker</code> è´¯ç©¿ <code>CI/CD</code> ä¸­æ•´ä¸ªæµç¨‹ã€‚ä½œä¸ºåº”ç”¨æœåŠ¡çš„è½½ä½“æœ‰ç€éå¸¸é‡è¦çš„åœ°ä½ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>Docker</code> å°†åº”ç”¨æ‰“åŒ…æˆä¸€ä¸ªé•œåƒï¼Œäº¤ç»™ <code>Kubernetes</code> å»éƒ¨ç½²åœ¨ç›®æ ‡æœåŠ¡é›†ç¾¤ã€‚å¹¶ä¸”å¯ä»¥å°†é•œåƒä¸Šä¼ åˆ°è‡ªå·±çš„é•œåƒä»“åº“ï¼Œåšå¥½ç‰ˆæœ¬åˆ†ç±»å¤„ç†ã€‚</p><h3 id="å®‰è£…-docker" tabindex="-1">å®‰è£… <code>Docker</code> â€‹</h3><p>åœ¨äº†è§£äº† <code>Docker</code> çš„ä½œç”¨åï¼Œæˆ‘ä»¬æ¥å¼€å§‹å®‰è£… <code>Docker</code>ã€‚åœ¨å¼€å§‹å®‰è£…ä¹‹å‰ï¼Œéœ€è¦å®‰è£… <code>device-mapper-persistent-data</code> å’Œ <code>lvm2</code> ä¸¤ä¸ªä¾èµ–ã€‚</p><p><code>device-mapper-persistent-data</code> æ˜¯ <code>Linux</code> ä¸‹çš„ä¸€ä¸ªå­˜å‚¨é©±åŠ¨ï¼Œ <code>Linux</code> ä¸Šçš„é«˜çº§å­˜å‚¨æŠ€æœ¯ã€‚ <code>Lvm</code> çš„ä½œç”¨åˆ™æ˜¯åˆ›å»ºé€»è¾‘ç£ç›˜åˆ†åŒºã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ <code>CentOS</code> çš„ <code>Yum</code> åŒ…ç®¡ç†å™¨å®‰è£…ä¸¤ä¸ªä¾èµ–ï¼š</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum-utils</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> device-mapper-persistent-data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lvm2</span></span></code></pre></div><p>ä¾èµ–å®‰è£…å®Œæ¯•åï¼Œæˆ‘ä»¬å°†é˜¿é‡Œäº‘çš„ <code>Docker</code> é•œåƒæºæ·»åŠ è¿›å»ã€‚å¯ä»¥åŠ é€Ÿ <code>Docker</code> çš„å®‰è£…ã€‚</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum-config-manager</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --add-repo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-ce</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span></code></pre></div><p>å®‰è£…å®Œæ¯•ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ <code>systemctl</code> å¯åŠ¨æ¥å¯åŠ¨ <code>Docker</code> <code>äº†ã€‚systemctl</code> æ˜¯ <code>Linux</code> çš„è¿›ç¨‹ç®¡ç†æœåŠ¡å‘½ä»¤ï¼Œä»–å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¯åŠ¨ <code>docker</code></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span></code></pre></div><p>æ¥ç€æ‰§è¡Œä¸€ä¸‹ <code>docker -v</code> ï¼Œè¿™æ¡å‘½ä»¤å¯ä»¥ç”¨æ¥æŸ¥çœ‹ <code>Docker</code> å®‰è£…çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å½“ç„¶ä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬æŸ¥çœ‹ <code>docker</code> å®‰è£…çŠ¶æ€ã€‚å¦‚æœæ­£å¸¸å±•ç¤ºç‰ˆæœ¬ä¿¡æ¯ï¼Œä»£è¡¨ <code>Docker</code> å·²ç»å®‰è£…æˆåŠŸã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7d98208c9e174be6b0d82acdaa1a2a28~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><h4 id="é…ç½®é˜¿é‡Œäº‘é•œåƒæº" tabindex="-1">é…ç½®é˜¿é‡Œäº‘é•œåƒæº â€‹</h4><p>åœ¨ <code>Docker</code> å®‰è£…å®Œæ¯•åï¼Œä¹‹åæˆ‘ä»¬å»æ‹‰å– <code>docker</code> é•œåƒæ—¶ï¼Œä¸€èˆ¬é»˜è®¤ä¼šå» <code>docker</code> å®˜æ–¹æºæ‹‰å–é•œåƒã€‚ä½†æ˜¯å›½å†…å‡ºæµ·ç½‘é€Ÿå®åœ¨æ˜¯å¤ªæ…¢ï¼Œæ‰€ä»¥é€‰æ‹©æˆ‘ä»¬æ›´æ¢ä¸º é˜¿é‡Œäº‘é•œåƒä»“åº“ æºè¿›è¡Œé•œåƒä¸‹è½½åŠ é€Ÿã€‚</p><p>ç™»å½•é˜¿é‡Œäº‘å®˜ç½‘ï¼Œæ‰“å¼€ é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ã€‚ç‚¹å‡»å·¦ä¾§èœå•æœ€ä¸‹é¢çš„ é•œåƒåŠ é€Ÿå™¨ ï¼Œé€‰æ‹© <code>CentOS</code> ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚æŒ‰ç…§å®˜ç½‘çš„æç¤ºæ‰§è¡Œå‘½ä»¤ï¼Œå³å¯æ›´æ¢ <code>docker</code> é•œåƒæºåœ°å€ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ea464ab9fe1941bba822a6131dd631c8~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><h3 id="å®‰è£…-jenkins" tabindex="-1">å®‰è£… Jenkins â€‹</h3><p>åœ¨å®‰è£…å®Œ <code>Docker</code> åï¼Œæˆ‘ä»¬åªæ˜¯æ‹¥æœ‰äº†ä¸€ä¸ªå¯ä»¥æ‰¿è½½æœåŠ¡çš„è½½ä½“ã€‚æƒ³å®ç°è‡ªåŠ¨åŒ–æ„å»ºï¼Œè¿˜éœ€è¦å®‰è£…å¦ä¸€ä¸ªæ„å»ºå·¥å…· <code>Jenkins</code>ã€‚é‚£ä»€ä¹ˆæ˜¯ <code>Jenkins</code> å‘¢ï¼Ÿ</p><p><code>Jenkins</code> æ˜¯ä¸€ä¸ªåŸºäº <code>Java</code> è¯­è¨€å¼€å‘çš„æŒç»­æ„å»ºå·¥å…·å¹³å°ï¼Œä¸»è¦ç”¨äºæŒç»­ã€è‡ªåŠ¨çš„æ„å»º/æµ‹è¯•ä½ çš„è½¯ä»¶å’Œé¡¹ç›®ã€‚å®ƒå¯ä»¥æ‰§è¡Œä½ é¢„å…ˆè®¾å®šå¥½çš„è®¾ç½®å’Œæ„å»ºè„šæœ¬ï¼Œä¹Ÿå¯ä»¥å’Œ Git ä»£ç åº“åšé›†æˆï¼Œå®ç°è‡ªåŠ¨è§¦å‘å’Œå®šæ—¶è§¦å‘æ„å»ºã€‚</p><h4 id="_1-å®‰è£…-openjdk" tabindex="-1">1. å®‰è£… OpenJDK â€‹</h4><p>å› ä¸º <code>Jenkins</code> æ˜¯ <code>Java</code> ç¼–å†™çš„æŒç»­æ„å»ºå¹³å°ï¼Œæ‰€ä»¥å®‰è£… <code>Java</code> å¿…ä¸å¯å°‘ã€‚</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©å®‰è£…å¼€æºçš„ <code>openjdk</code> å³å¯ã€‚ <code>openjdk</code> æ˜¯ <code>SunJDK</code> <strong>ä¸€ç§å¼€æºå®ç°</strong>ã€‚å…³äºopenjdk æ˜¯ <code>SunJDK</code> çš„å…·ä½“åŒºåˆ«å¯ä»¥çœ‹ä¸‹é¢çš„æ–‡ç« äº†è§£ä¸‹ã€‚åœ¨è¿™æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ <code>yum</code> åŒ…ç®¡ç†å™¨å®‰è£… <code>openjdk</code> å³å¯ã€‚</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span></span></code></pre></div><blockquote><p>www.zhihu.com/question/19â€¦</p></blockquote><h4 id="_2-ä½¿ç”¨-yum-å®‰è£…-jenkins" tabindex="-1">2. ä½¿ç”¨ Yum å®‰è£… Jenkins â€‹</h4><p>ç”±äº <code>Yum</code> æºä¸è‡ªå¸¦ <code>Jenkins</code> çš„å®‰è£…æºï¼Œäºæ˜¯æˆ‘ä»¬éœ€è¦è‡ªå·±å¯¼å…¥ä¸€ä»½ <code>Jenkins</code> å®‰è£…æºè¿›è¡Œå®‰è£…ã€‚å¯¼å…¥åï¼Œä½¿ç”¨ <code>Yum</code> å‘½ä»¤å®‰è£…å³å¯ã€‚</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/yum.repos.d/jenkins.repo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://pkg.jenkins.io/redhat-stable/jenkins.repo</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rpm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --import</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://pkg.jenkins.io/redhat-stable/jenkins.io.key</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jenkins</span></span></code></pre></div><h4 id="_3-å¯åŠ¨-jenkins" tabindex="-1">3. å¯åŠ¨ Jenkins â€‹</h4><p><code>Jenkins</code> å®‰è£…åï¼Œä¼šå°†å¯åŠ¨å‘½ä»¤æ³¨å†Œåˆ°ç³»ç»Ÿ <code>Service</code> å‘½ä»¤ä¸­ã€‚æ‰€ä»¥æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ç³»ç»Ÿ <code>service</code> å‘½ä»¤å¯åŠ¨ <code>Jenkins</code> å³å¯ã€‚åœ¨è¿™é‡Œï¼Œæœ‰ä¸‰ä¸ªå‘½ä»¤å¯ä»¥ä½¿ç”¨ï¼Œåˆ†åˆ«å¯¹åº” å¯åŠ¨ / é‡å¯ / åœæ­¢ ä¸‰ä¸ªå‘½ä»¤ã€‚</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨ <code>service jenkins start</code> å¯åŠ¨ <code>Jenkins</code> å³å¯</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jenkins</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># service jenkins restart restart é‡å¯ Jenkins</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># service jenkins restart stop åœæ­¢ Jenkins</span></span></code></pre></div><h4 id="_4-ç»™-jenkins-æ”¾è¡Œç«¯å£" tabindex="-1">4. ç»™ Jenkins æ”¾è¡Œç«¯å£ â€‹</h4><p>åœ¨å¯åŠ¨ <code>Jenkins</code> åï¼Œæ­¤æ—¶ <code>Jenkins</code> ä¼šå¼€å¯å®ƒçš„é»˜è®¤ç«¯å£ <code>8080</code> ã€‚ä½†ç”±äºé˜²ç«å¢™é™åˆ¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨è®©é˜²ç«å¢™æ”¾è¡Œ <code>8080</code> ç«¯å£æ‰èƒ½å¯¹å¤–è®¿é—®åˆ°ç•Œé¢ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬åœ¨ <code>CentOS</code> ä¸‹çš„ <code>firewall-cmd</code> é˜²ç«å¢™æ·»åŠ ç«¯å£æ”¾è¡Œè§„åˆ™ï¼Œæ·»åŠ å®Œåé‡å¯é˜²ç«å¢™ã€‚</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --zone=public</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --add-port=8080/tcp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --zone=public</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --add-port=50000/tcp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --permanent</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reload</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> firewalld</span></span></code></pre></div><p>æœåŠ¡å¯åŠ¨åï¼Œè®¿é—® <code>IP:8080</code> ã€‚å¦‚æœèƒ½å¤Ÿçœ‹åˆ°ä»¥ä¸‹ç•Œé¢ï¼Œä»£è¡¨æ­£åœ¨å¯åŠ¨ã€‚ <code>Jenkins</code> ç¬¬ä¸€æ¬¡çš„å¯åŠ¨æ—¶é—´ä¸€èˆ¬æ¯”è¾ƒé•¿ï¼ˆè§†æœåŠ¡å™¨æ€§èƒ½è€Œçœ‹ï¼‰</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/590e97ce582543dea52a5f90501f5cd1~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><h4 id="_5-åˆå§‹åŒ–-jenkins-é…ç½®" tabindex="-1">5. åˆå§‹åŒ– Jenkins é…ç½® â€‹</h4><h5 id="_5-1-è§£é”-jenkins" tabindex="-1">5.1 è§£é” Jenkins â€‹</h5><p>åœ¨ <code>Jenkins</code> å¯åŠ¨å®Œæˆåï¼Œä¼šè‡ªåŠ¨è·³è½¬è‡³è¿™ä¸ªç•Œé¢ï¼ˆä¸‹æ–¹äºŒå›¾ï¼‰ã€‚è¿™æ˜¯ <code>Jenkins</code> çš„è§£é”ç•Œé¢ï¼Œä½ éœ€è¦è¾“å…¥å­˜æ”¾åœ¨æœåŠ¡å™¨çš„åˆå§‹è§£é”å¯†ç æ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚</p><p><code>Jenkins</code> å¯åŠ¨åï¼Œä¼šç”Ÿæˆä¸€ä¸ª<strong>åˆå§‹å¯†ç </strong>ã€‚è¯¥å¯†ç åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶å†…å­˜æ”¾ï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥æœåŠ¡å™¨æŸ¥çœ‹å¯†ç å†…å®¹ï¼Œå°†å¯†ç å¡«å†™åœ¨ <code>Jenkins</code> çš„ç®¡ç†å‘˜å¯†ç è¾“å…¥æ¡†å†…ï¼š</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/jenkins/secrets/initialAdminPassword</span></span></code></pre></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/80991521841c4fbfbfc24330e820488c~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/48924f5f22e444cf8b61da8466fb228b~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><p>ç‚¹å‡» <code>ç»§ç»­</code> æŒ‰é’®ï¼Œè§£é” Jenkinsã€‚</p><h5 id="_5-2-ä¸‹è½½æ’ä»¶" tabindex="-1">5.2 ä¸‹è½½æ’ä»¶ â€‹</h5><p>è§£é”åå°±æ¥åˆ°äº†æ’ä»¶ä¸‹è½½é¡µé¢ï¼Œè¿™ä¸€æ­¥è¦ä¸‹è½½ä¸€äº› <code>Jenkins</code> çš„åŠŸèƒ½æ’ä»¶ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/78b36782863c4d1e9d7e06fad09d2dec~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><p>å› ä¸º <code>Jenkins</code> æ’ä»¶æœåŠ¡å™¨åœ¨å›½å¤–ï¼Œæ‰€ä»¥é€Ÿåº¦ä¸å¤ªç†æƒ³ã€‚æˆ‘ä»¬éœ€è¦æ›´æ¢ä¸ºæ¸…åå¤§å­¦çš„ <code>Jenkins</code> æ’ä»¶æºåï¼Œå†å®‰è£…æ’ä»¶ï¼Œ<strong>æ‰€ä»¥å…ˆä¸è¦ç‚¹å®‰è£…æ’ä»¶</strong>ã€‚</p><p>æ›´æ¢æ–¹æ³•å¾ˆç®€å•ã€‚è¿›å…¥æœåŠ¡å™¨ï¼Œå°† <code>/var/lib/jenkins/updates/default.json</code> å†…çš„æ’ä»¶æºåœ°å€æ›¿æ¢æˆæ¸…åå¤§å­¦çš„æºåœ°å€ï¼Œå°† google æ›¿æ¢ä¸º baidu å³å¯ã€‚</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/http:\\/\\/updates.jenkins-ci.org\\/download/https:\\/\\/mirrors.tuna.tsinghua.edu.cn\\/jenkins/g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/jenkins/updates/default.json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/http:\\/\\/www.google.com/https:\\/\\/www.baidu.com/g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/jenkins/updates/default.json</span></span></code></pre></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6ec4d971326e4a938596e501dcc92cff~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><p>æ¥ç€ç‚¹å‡» <code>å®‰è£…æ¨èçš„æ’ä»¶</code> å³å¯ã€‚ç¨ç­‰ä¸€ä¼šæ’ä»¶å®‰è£…å®Œæ¯•</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a29085d29f31454d9f4bd0b323f8bc62~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><h5 id="_6-å®Œæˆå®‰è£…" tabindex="-1">6. å®Œæˆå®‰è£… â€‹</h5><p>æ’ä»¶å®‰è£…å®Œæ¯•åï¼Œæ¥ç€æ˜¯æ³¨å†Œç®¡ç†å‘˜è´¦å·ã€‚æŒ‰ç…§æç¤ºä¸€è·¯é…ç½®åï¼Œç›´åˆ°çœ‹åˆ°ä»¥ä¸‹ç•Œé¢ä»£è¡¨å®‰è£…æˆåŠŸ</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2bd4415a6da34d05aad501bfd5d5029f~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><h5 id="_7-æµ‹è¯•å®‰è£…" tabindex="-1">7. æµ‹è¯•å®‰è£… â€‹</h5><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„ <code>Jenkins</code> ç®—æ˜¯å¯åŠ¨æˆåŠŸäº†ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹ <code>Jenkins</code> åšä¸€ç‚¹ç‚¹ç®€å•çš„é…ç½®ï¼Œæ‰å¯ä»¥è®©å®ƒå¯ä»¥æ„å»º <code>docker</code> é•œåƒã€‚</p><p>æˆ‘ä»¬ç‚¹å‡» <code>Jenkins</code> é¦–é¡µ -&gt; å·¦ä¾§å¯¼èˆª -&gt; æ–°å»ºä»»åŠ¡ -&gt; <code>Freestyle project</code></p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c4bae87d4a1c4494a0615e6f169d5423~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><p>æ–°å»ºå®Œæ¯•åï¼Œæ‰¾åˆ° <code>æ„å»º</code> ä¸€é¡¹ï¼Œé€‰æ‹© <code>å¢åŠ æ„å»ºæ­¥éª¤</code>ï¼Œé€‰æ‹© <code>æ‰§è¡Œshell</code> ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node:latest</span></span></code></pre></div><p>è¯¥å‘½ä»¤ä¼šå»æ‹‰å–ä¸€ä¸ª <code>nodejs</code> ç¨³å®šç‰ˆçš„é•œåƒï¼Œæˆ‘ä»¬å¯ä»¥æ¥æµ‹è¯• <code>Docker</code> çš„å¯ç”¨æ€§</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/198a7f5fbe0f41e8b663f2c2af425fb2~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><p>ä¿å­˜åï¼Œæˆ‘ä»¬ç‚¹å‡»å·¦ä¾§èœå•çš„<strong>ç«‹å³æ„å»º</strong>ï¼Œ <code>Jenkins</code> å°±ä¼šå¼€å§‹æ„å»ºã€‚é€‰æ‹©å·¦ä¾§å†å²è®°å½•ç¬¬ä¸€é¡¹ï¼ˆæœ€æ–°çš„ä¸€é¡¹ï¼‰ï¼Œç‚¹å‡»æ§åˆ¶å°è¾“å‡ºï¼ŒæŸ¥çœ‹æ„å»ºæ—¥å¿—ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a633c410f75c4db8be48133a4a516830~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><p>æ‰§è¡Œåï¼Œæˆ‘ä»¬å‘ç°æç¤ºæ— è®¿é—®æƒé™ã€‚è¿™åˆæ˜¯ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿè¿™é‡Œå°±ä¸å¾—ä¸æåˆ° <code>Linux</code> ä¸‹çš„ <code>Unix Socket</code>æƒé™é—®é¢˜äº†</p><h5 id="_8-unix-socket-æƒé™é—®é¢˜" tabindex="-1">8. Unix Socket æƒé™é—®é¢˜ â€‹</h5><p><code>docker</code> çš„æ¶æ„æ˜¯ <code>C/S</code> æ¶æ„ã€‚åœ¨æˆ‘ä»¬ä½¿ç”¨ <code>docker</code> å‘½ä»¤æ—¶ï¼Œå…¶å®æ˜¯å‘½ä»¤ä½¿ç”¨ <code>socket</code> ä¸ <code>docker</code> çš„å®ˆæŠ¤è¿›ç¨‹è¿›è¡Œé€šä¿¡ï¼Œæ‰èƒ½æ­£å¸¸æ‰§è¡Œ <code>docker</code> å‘½ä»¤ã€‚</p><p>è€Œåœ¨ <code>Linux</code> ä¸­ï¼Œ <code>Unix socket</code> å±äº <code>root</code> ç”¨æˆ·ï¼Œå› æ­¤éœ€è¦ <code>root</code> æƒé™æ‰èƒ½è®¿é—®ã€‚å®˜æ–¹æ˜¯è¿™ä¹ˆè§£é‡Šçš„ï¼š</p><blockquote><p>Manage Docker as a non-root user The docker daemon binds to a Unix socket instead of a TCP port. By default that Unix socket is owned by the user root and other users can only access it using sudo. The docker daemon always runs as the root user. If you donâ€™t want to use sudo when you use the docker command, create a Unix group called docker and add users to it. When the docker daemon starts, it makes the ownership of the Unix socket read/writable by the docker group.</p></blockquote><p>ä½†æ˜¯åœ¨ <code>docker</code> ä¸­ï¼Œ <code>docker</code> æä¾›äº†ä¸€ä¸ª <code>ç”¨æˆ·ç»„</code> çš„æ¦‚å¿µã€‚æˆ‘ä»¬å¯ä»¥å°†æ‰§è¡Œ <code>Shell</code> çš„ç”¨æˆ·æ·»åŠ åˆ°åç§°ä¸º <code>docker</code> çš„ç”¨æˆ·ç»„ï¼Œåˆ™å¯ä»¥æ­£å¸¸æ‰§è¡Œ <code>docker</code> å‘½ä»¤ã€‚</p><p>è€Œåœ¨ <code>Jenkins</code> ä¸­æ‰§è¡Œçš„ç»ˆç«¯ç”¨æˆ·åš <code>jenkins</code> ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å°† <code>jenkins</code> åŠ å…¥åˆ° <code>docker</code> ç”¨æˆ·ç»„å³å¯ï¼š</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> groupadd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          #æ–°å¢dockerç”¨æˆ·ç»„</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gpasswd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jenkins</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  #å°†å½“å‰ç”¨æˆ·æ·»åŠ è‡³dockerç”¨æˆ·ç»„</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">newgrp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 #æ›´æ–°dockerç”¨æˆ·ç»„</span></span></code></pre></div><p>åŠ å…¥åï¼Œ<code>é‡å¯</code> Jenkins ï¼š</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jenkins</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span></span></code></pre></div><p>é‡å¯ Jenkins åï¼Œ<code>å†æ¬¡æ‰§è¡Œè„šæœ¬</code>ã€‚æ­¤æ—¶æ‰§è¡ŒæˆåŠŸï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ebb74deda4d04246922c556f74963413~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" alt="image.png" loading="lazy"></p><h3 id="ç»“æŸè¯­" tabindex="-1">ç»“æŸè¯­ â€‹</h3><p>åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„åŸºç¡€ç»„ä»¶ â€”â€” <code>docker</code> å’Œ <code>Jenkins</code> å°±å®‰è£…å®Œæ¯•äº†ã€‚ä¸è¿‡ï¼Œè¿™åªæ˜¯æŒç»­æ„å»ºçš„ç¬¬ä¸€æ­¥ã€‚åœ¨ä¸‹ä¸€ç« ï¼Œæˆ‘ä»¬ä¼šåœ¨æœåŠ¡å™¨ä¸Šå®‰è£… <code>Node</code> ç¯å¢ƒï¼Œå¹¶é›†æˆ <code>Git</code> ä»£ç åº“å®ç°å¯¹ä»£ç çš„é•œåƒæ„å»ºã€‚</p><p>å¦‚æœä½ æœ‰ä»€ä¹ˆç–‘é—®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºæå‡º ğŸ‘</p>`,90),p=[d];function t(c,o,k,h,l,r){return i(),e("div",null,p)}const m=s(n,[["render",t]]);export{y as __pageData,m as default};
