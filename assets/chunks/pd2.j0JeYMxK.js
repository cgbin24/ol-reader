import{a as l,x as N,o as S,i as m,j as f,D as t,X as b,Y as D,p as w,C as j,E as W,F as E}from"./@vue.Br72Imo5.js";import{a as I,b as V,c as h}from"./pdfjs-dist.D1DTk0ec.js";import{_ as B}from"../app.D_DTQrLX.js";const R=n=>(W("data-v-ea5a228e"),n=n(),E(),n),T={class:"pdfPreview"},$={class:"page-tool"},F={class:"page-tool-item"},G={key:0,class:"loading"},O=R(()=>t("div",{class:"loading-content"},[t("div",{class:"loading-icon"}),t("div",{class:"loading-text"},"Loading...")],-1)),q=[O],z={__name:"pd2",props:{src:{type:String,required:!0}},setup(n){I.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${V}/pdf.worker.min.mjs`;const p=n,s=l(null),a=N({source:p.src,pageNum:1,scale:1,numPages:1}),x=l(!0),d=l(null),r=l(!1);S(async()=>{o("init GlobalWorkerOptions"),r.value=!0,setTimeout(()=>{k()},1e3)});const P=()=>{a.pageNum>1&&(a.pageNum-=1,_())},y=()=>{a.pageNum<a.numPages&&(a.pageNum+=1,_())},k=async()=>{try{if(s.value){o("init");const e=await h(p.src).promise;o("init getDocument"),a.numPages=e.numPages,await v()}}catch(e){console.error("Error initializing PDF viewer:",e),o(e)}finally{r.value=!1}},v=async()=>{o("renderPage");try{if(s.value){const u=await(await h(p.src).promise).getPage(a.pageNum),c=u.getViewport({scale:a.scale});console.log("viewport:",c);const g=s.value.getContext("2d");if(g){o("renderPage context");const i=window.devicePixelRatio||1;s.value.width=c.width*i,s.value.height=c.height*i,s.value.style.width=`${d.value.style.width}px`,s.value.style.height=`${d.value.style.height}px`,g.setTransform(i,0,0,i,0,0);const C={canvasContext:g,viewport:c};await u.render(C).promise,r.value=!1,o("renderPage success")}}}catch(e){console.error("Error rendering page:",e)}},_=async()=>{await v()},o=e=>{alert(e),console.log(e)};return(e,u)=>(m(),f("div",T,[t("div",{class:"pdfWrap",ref_key:"pWrapRef",ref:d},[t("canvas",{ref_key:"canvas",ref:s,class:"pdfCanvas"},null,512)],512),b(t("div",$,[t("div",{class:"page-tool-item",onClick:P},"pre"),t("div",{class:"page-tool-item",onClick:y},"next"),t("div",F,w(a.pageNum)+" / "+w(a.numPages),1)],512),[[D,x.value]]),r.value?(m(),f("div",G,q)):j("",!0)]))}},X=B(z,[["__scopeId","data-v-ea5a228e"]]);export{X as P};
