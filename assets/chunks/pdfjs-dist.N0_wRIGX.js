var Or=Object.defineProperty;var bn=we=>{throw TypeError(we)};var Nr=(we,xe,Me)=>xe in we?Or(we,xe,{enumerable:!0,configurable:!0,writable:!0,value:Me}):we[xe]=Me;var he=(we,xe,Me)=>Nr(we,typeof xe!="symbol"?xe+"":xe,Me),vi=(we,xe,Me)=>xe.has(we)||bn("Cannot "+Me);var t=(we,xe,Me)=>(vi(we,xe,"read from private field"),Me?Me.call(we):xe.get(we)),w=(we,xe,Me)=>xe.has(we)?bn("Cannot add the same private member more than once"):xe instanceof WeakSet?xe.add(we):xe.set(we,Me),_=(we,xe,Me,us)=>(vi(we,xe,"write to private field"),us?us.call(we,Me):xe.set(we,Me),Me),A=(we,xe,Me)=>(vi(we,xe,"access private method"),Me);var Je=(we,xe,Me,us)=>({set _(zs){_(we,xe,zs,Me)},get _(){return t(we,xe,us)}});let Qe,An,vn,yn,Br=(async()=>{let we,xe,Me;we="modulepreload",xe=function(se){return"/"+se},Me={},Qe=function(se,Vt,dt){let d=Promise.resolve();if(Vt&&Vt.length>0){document.getElementsByTagName("link");const J=document.querySelector("meta[property=csp-nonce]"),N=(J==null?void 0:J.nonce)||(J==null?void 0:J.getAttribute("nonce"));d=Promise.all(Vt.map(Y=>{if(Y=xe(Y),Y in Me)return;Me[Y]=!0;const pt=Y.endsWith(".css"),H=pt?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${Y}"]${H}`))return;const I=document.createElement("link");if(I.rel=pt?"stylesheet":we,pt||(I.as="script",I.crossOrigin=""),I.href=Y,N&&I.setAttribute("nonce",N),document.head.appendChild(I),pt)return new Promise((k,j)=>{I.addEventListener("load",k),I.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${Y}`)))})}))}return d.then(()=>se()).catch(J=>{const N=new Event("vite:preloadError",{cancelable:!0});if(N.payload=J,window.dispatchEvent(N),!N.defaultPrevented)throw J})};var us={976:(se,Vt,dt)=>{var le,ee,ce,yi,bt,ls,_n,wn,s,a,h,l,g,u,p,M,e,i,o,m,T,$,W,tt,ft,it,En,$s,_i,wi,Ht,lt,ut,C,X,Q,vt,Ei,Pt,Bt,te,de,xn,xi;dt.d(Vt,{AnnotationLayer:()=>Ut,FreeTextAnnotationElement:()=>ot,InkAnnotationElement:()=>Jt,StampAnnotationElement:()=>ue});var d=dt(292),J=dt(419),N=dt(792);function Y($t){return Math.floor(Math.max(0,Math.min(1,$t))*255).toString(16).padStart(2,"0")}function pt($t){return Math.max(0,Math.min(255,255*$t))}class H{static CMYK_G([v,f,E,z]){return["G",1-Math.min(1,.3*v+.59*E+.11*f+z)]}static G_CMYK([v]){return["CMYK",0,0,0,1-v]}static G_RGB([v]){return["RGB",v,v,v]}static G_rgb([v]){return v=pt(v),[v,v,v]}static G_HTML([v]){const f=Y(v);return`#${f}${f}${f}`}static RGB_G([v,f,E]){return["G",.3*v+.59*f+.11*E]}static RGB_rgb(v){return v.map(pt)}static RGB_HTML(v){return`#${v.map(Y).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([v,f,E,z]){return["RGB",1-Math.min(1,v+z),1-Math.min(1,E+z),1-Math.min(1,f+z)]}static CMYK_rgb([v,f,E,z]){return[pt(1-Math.min(1,v+z)),pt(1-Math.min(1,E+z)),pt(1-Math.min(1,f+z))]}static CMYK_HTML(v){const f=this.CMYK_RGB(v).slice(1);return this.RGB_HTML(f)}static RGB_CMYK([v,f,E]){const z=1-v,q=1-f,mt=1-E,yt=Math.min(z,q,mt);return["CMYK",z,q,mt,yt]}}var I=dt(284);const k=1e3,j=9,x=new WeakSet;function y($t){return{width:$t[2]-$t[0],height:$t[3]-$t[1]}}class F{static create(v){switch(v.data.annotationType){case d.AnnotationType.LINK:return new Z(v);case d.AnnotationType.TEXT:return new U(v);case d.AnnotationType.WIDGET:switch(v.data.fieldType){case"Tx":return new P(v);case"Btn":return v.data.radioButton?new L(v):v.data.checkBox?new R(v):new ht(v);case"Ch":return new st(v);case"Sig":return new B(v)}return new K(v);case d.AnnotationType.POPUP:return new At(v);case d.AnnotationType.FREETEXT:return new ot(v);case d.AnnotationType.LINE:return new nt(v);case d.AnnotationType.SQUARE:return new Mt(v);case d.AnnotationType.CIRCLE:return new Dt(v);case d.AnnotationType.POLYLINE:return new Lt(v);case d.AnnotationType.CARET:return new ae(v);case d.AnnotationType.INK:return new Jt(v);case d.AnnotationType.POLYGON:return new Xt(v);case d.AnnotationType.HIGHLIGHT:return new ne(v);case d.AnnotationType.UNDERLINE:return new oe(v);case d.AnnotationType.SQUIGGLY:return new Rt(v);case d.AnnotationType.STRIKEOUT:return new Qt(v);case d.AnnotationType.STAMP:return new ue(v);case d.AnnotationType.FILEATTACHMENT:return new be(v);default:return new D(v)}}}const Ot=class Ot{constructor(v,{isRenderable:f=!1,ignoreBorder:E=!1,createQuadrilaterals:z=!1}={}){w(this,ce);w(this,le,null);w(this,ee,!1);this.isRenderable=f,this.data=v.data,this.layer=v.layer,this.linkService=v.linkService,this.downloadManager=v.downloadManager,this.imageResourcesPath=v.imageResourcesPath,this.renderForms=v.renderForms,this.svgFactory=v.svgFactory,this.annotationStorage=v.annotationStorage,this.enableScripting=v.enableScripting,this.hasJSActions=v.hasJSActions,this._fieldObjects=v.fieldObjects,this.parent=v.parent,f&&(this.container=this._createContainer(E)),z&&this._createQuadrilaterals()}static _hasPopupData({titleObj:v,contentsObj:f,richText:E}){return!!(v!=null&&v.str||f!=null&&f.str||E!=null&&E.str)}get hasPopupData(){return Ot._hasPopupData(this.data)}updateEdited(v){if(!this.container)return;t(this,le)||_(this,le,{rect:this.data.rect.slice(0)});const{rect:f}=v;f&&A(this,ce,yi).call(this,f)}resetEdited(){t(this,le)&&(A(this,ce,yi).call(this,t(this,le).rect),_(this,le,null))}_createContainer(v){const{data:f,parent:{page:E,viewport:z}}=this,q=document.createElement("section");q.setAttribute("data-annotation-id",f.id),this instanceof K||(q.tabIndex=k);const{style:mt}=q;if(mt.zIndex=this.parent.zIndex++,f.popupRef&&q.setAttribute("aria-haspopup","dialog"),f.alternativeText&&(q.title=f.alternativeText),f.noRotate&&q.classList.add("norotate"),!f.rect||this instanceof At){const{rotation:Et}=f;return!f.hasOwnCanvas&&Et!==0&&this.setRotation(Et,q),q}const{width:yt,height:zt}=y(f.rect);if(!v&&f.borderStyle.width>0){mt.borderWidth=`${f.borderStyle.width}px`;const Et=f.borderStyle.horizontalCornerRadius,It=f.borderStyle.verticalCornerRadius;if(Et>0||It>0){const Yt=`calc(${Et}px * var(--scale-factor)) / calc(${It}px * var(--scale-factor))`;mt.borderRadius=Yt}else if(this instanceof L){const Yt=`calc(${yt}px * var(--scale-factor)) / calc(${zt}px * var(--scale-factor))`;mt.borderRadius=Yt}switch(f.borderStyle.style){case d.AnnotationBorderStyleType.SOLID:mt.borderStyle="solid";break;case d.AnnotationBorderStyleType.DASHED:mt.borderStyle="dashed";break;case d.AnnotationBorderStyleType.BEVELED:(0,d.warn)("Unimplemented border style: beveled");break;case d.AnnotationBorderStyleType.INSET:(0,d.warn)("Unimplemented border style: inset");break;case d.AnnotationBorderStyleType.UNDERLINE:mt.borderBottomStyle="solid";break}const Kt=f.borderColor||null;Kt?(_(this,ee,!0),mt.borderColor=d.Util.makeHexColor(Kt[0]|0,Kt[1]|0,Kt[2]|0)):mt.borderWidth=0}const Ft=d.Util.normalizeRect([f.rect[0],E.view[3]-f.rect[1]+E.view[1],f.rect[2],E.view[3]-f.rect[3]+E.view[1]]),{pageWidth:c,pageHeight:O,pageX:et,pageY:ct}=z.rawDims;mt.left=`${100*(Ft[0]-et)/c}%`,mt.top=`${100*(Ft[1]-ct)/O}%`;const{rotation:St}=f;return f.hasOwnCanvas||St===0?(mt.width=`${100*yt/c}%`,mt.height=`${100*zt/O}%`):this.setRotation(St,q),q}setRotation(v,f=this.container){if(!this.data.rect)return;const{pageWidth:E,pageHeight:z}=this.parent.viewport.rawDims,{width:q,height:mt}=y(this.data.rect);let yt,zt;v%180===0?(yt=100*q/E,zt=100*mt/z):(yt=100*mt/E,zt=100*q/z),f.style.width=`${yt}%`,f.style.height=`${zt}%`,f.setAttribute("data-main-rotation",(360-v)%360)}get _commonActions(){const v=(f,E,z)=>{const q=z.detail[f],mt=q[0],yt=q.slice(1);z.target.style[E]=H[`${mt}_HTML`](yt),this.annotationStorage.setValue(this.data.id,{[E]:H[`${mt}_rgb`](yt)})};return(0,d.shadow)(this,"_commonActions",{display:f=>{const{display:E}=f.detail,z=E%2===1;this.container.style.visibility=z?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:z,noPrint:E===1||E===2})},print:f=>{this.annotationStorage.setValue(this.data.id,{noPrint:!f.detail.print})},hidden:f=>{const{hidden:E}=f.detail;this.container.style.visibility=E?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:E,noView:E})},focus:f=>{setTimeout(()=>f.target.focus({preventScroll:!1}),0)},userName:f=>{f.target.title=f.detail.userName},readonly:f=>{f.target.disabled=f.detail.readonly},required:f=>{this._setRequired(f.target,f.detail.required)},bgColor:f=>{v("bgColor","backgroundColor",f)},fillColor:f=>{v("fillColor","backgroundColor",f)},fgColor:f=>{v("fgColor","color",f)},textColor:f=>{v("textColor","color",f)},borderColor:f=>{v("borderColor","borderColor",f)},strokeColor:f=>{v("strokeColor","borderColor",f)},rotation:f=>{const E=f.detail.rotation;this.setRotation(E),this.annotationStorage.setValue(this.data.id,{rotation:E})}})}_dispatchEventFromSandbox(v,f){var z;const E=this._commonActions;for(const q of Object.keys(f.detail))(z=v[q]||E[q])==null||z(f)}_setDefaultPropertiesFromJS(v){if(!this.enableScripting)return;const f=this.annotationStorage.getRawValue(this.data.id);if(!f)return;const E=this._commonActions;for(const[z,q]of Object.entries(f)){const mt=E[z];if(mt){const yt={detail:{[z]:q},target:v};mt(yt),delete f[z]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:v}=this.data;if(!v)return;const[f,E,z,q]=this.data.rect;if(v.length===1){const[,{x:Et,y:It},{x:Kt,y:Yt}]=v[0];if(z===Et&&q===It&&f===Kt&&E===Yt)return}const{style:mt}=this.container;let yt;if(t(this,ee)){const{borderColor:Et,borderWidth:It}=mt;mt.borderWidth=0,yt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Et}" stroke-width="${It}">`],this.container.classList.add("hasBorder")}const zt=z-f,Ft=q-E,{svgFactory:c}=this,O=c.createElement("svg");O.classList.add("quadrilateralsContainer"),O.setAttribute("width",0),O.setAttribute("height",0);const et=c.createElement("defs");O.append(et);const ct=c.createElement("clipPath"),St=`clippath_${this.data.id}`;ct.setAttribute("id",St),ct.setAttribute("clipPathUnits","objectBoundingBox"),et.append(ct);for(const[,{x:Et,y:It},{x:Kt,y:Yt}]of v){const fe=c.createElement("rect"),Te=(Kt-f)/zt,Re=(q-It)/Ft,Ue=(Et-Kt)/zt,Ie=(It-Yt)/Ft;fe.setAttribute("x",Te),fe.setAttribute("y",Re),fe.setAttribute("width",Ue),fe.setAttribute("height",Ie),ct.append(fe),yt==null||yt.push(`<rect vector-effect="non-scaling-stroke" x="${Te}" y="${Re}" width="${Ue}" height="${Ie}"/>`)}t(this,ee)&&(yt.push("</g></svg>')"),mt.backgroundImage=yt.join("")),this.container.append(O),this.container.style.clipPath=`url(#${St})`}_createPopup(){const{container:v,data:f}=this;v.setAttribute("aria-haspopup","dialog");const E=new At({data:{color:f.color,titleObj:f.titleObj,modificationDate:f.modificationDate,contentsObj:f.contentsObj,richText:f.richText,parentRect:f.rect,borderStyle:0,id:`popup_${f.id}`,rotation:f.rotation},parent:this.parent,elements:[this]});this.parent.div.append(E.render())}render(){(0,d.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(v,f=null){const E=[];if(this._fieldObjects){const z=this._fieldObjects[v];if(z)for(const{page:q,id:mt,exportValues:yt}of z){if(q===-1||mt===f)continue;const zt=typeof yt=="string"?yt:null,Ft=document.querySelector(`[data-element-id="${mt}"]`);if(Ft&&!x.has(Ft)){(0,d.warn)(`_getElementsByName - element not allowed: ${mt}`);continue}E.push({id:mt,exportValue:zt,domElement:Ft})}return E}for(const z of document.getElementsByName(v)){const{exportValue:q}=z,mt=z.getAttribute("data-element-id");mt!==f&&x.has(z)&&E.push({id:mt,exportValue:q,domElement:z})}return E}show(){var v;this.container&&(this.container.hidden=!1),(v=this.popup)==null||v.maybeShow()}hide(){var v;this.container&&(this.container.hidden=!0),(v=this.popup)==null||v.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const v=this.getElementsToTriggerPopup();if(Array.isArray(v))for(const f of v)f.classList.add("highlightArea");else v.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:v,data:{id:f}}=this;this.container.addEventListener("dblclick",()=>{var E;(E=this.linkService.eventBus)==null||E.dispatch("switchannotationeditormode",{source:this,mode:v,editId:f})})}};le=new WeakMap,ee=new WeakMap,ce=new WeakSet,yi=function(v){const{container:{style:f},data:{rect:E,rotation:z},parent:{viewport:{rawDims:{pageWidth:q,pageHeight:mt,pageX:yt,pageY:zt}}}}=this;E==null||E.splice(0,4,...v);const{width:Ft,height:c}=y(v);f.left=`${100*(v[0]-yt)/q}%`,f.top=`${100*(mt-v[3]+zt)/mt}%`,z===0?(f.width=`${100*Ft/q}%`,f.height=`${100*c/mt}%`):this.setRotation(z)};let D=Ot;class Z extends D{constructor(f,E=null){super(f,{isRenderable:!0,ignoreBorder:!!(E!=null&&E.ignoreBorder),createQuadrilaterals:!0});w(this,bt);this.isTooltipOnly=f.data.isTooltipOnly}render(){const{data:f,linkService:E}=this,z=document.createElement("a");z.setAttribute("data-element-id",f.id);let q=!1;return f.url?(E.addLinkAttributes(z,f.url,f.newWindow),q=!0):f.action?(this._bindNamedAction(z,f.action),q=!0):f.attachment?(A(this,bt,_n).call(this,z,f.attachment,f.attachmentDest),q=!0):f.setOCGState?(A(this,bt,wn).call(this,z,f.setOCGState),q=!0):f.dest?(this._bindLink(z,f.dest),q=!0):(f.actions&&(f.actions.Action||f.actions["Mouse Up"]||f.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(z,f),q=!0),f.resetForm?(this._bindResetFormAction(z,f.resetForm),q=!0):this.isTooltipOnly&&!q&&(this._bindLink(z,""),q=!0)),this.container.classList.add("linkAnnotation"),q&&this.container.append(z),this.container}_bindLink(f,E){f.href=this.linkService.getDestinationHash(E),f.onclick=()=>(E&&this.linkService.goToDestination(E),!1),(E||E==="")&&A(this,bt,ls).call(this)}_bindNamedAction(f,E){f.href=this.linkService.getAnchorUrl(""),f.onclick=()=>(this.linkService.executeNamedAction(E),!1),A(this,bt,ls).call(this)}_bindJSAction(f,E){f.href=this.linkService.getAnchorUrl("");const z=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const q of Object.keys(E.actions)){const mt=z.get(q);mt&&(f[mt]=()=>{var yt;return(yt=this.linkService.eventBus)==null||yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:E.id,name:q}}),!1})}f.onclick||(f.onclick=()=>!1),A(this,bt,ls).call(this)}_bindResetFormAction(f,E){const z=f.onclick;if(z||(f.href=this.linkService.getAnchorUrl("")),A(this,bt,ls).call(this),!this._fieldObjects){(0,d.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),z||(f.onclick=()=>!1);return}f.onclick=()=>{var O;z==null||z();const{fields:q,refs:mt,include:yt}=E,zt=[];if(q.length!==0||mt.length!==0){const et=new Set(mt);for(const ct of q){const St=this._fieldObjects[ct]||[];for(const{id:Et}of St)et.add(Et)}for(const ct of Object.values(this._fieldObjects))for(const St of ct)et.has(St.id)===yt&&zt.push(St)}else for(const et of Object.values(this._fieldObjects))zt.push(...et);const Ft=this.annotationStorage,c=[];for(const et of zt){const{id:ct}=et;switch(c.push(ct),et.type){case"text":{const Et=et.defaultValue||"";Ft.setValue(ct,{value:Et});break}case"checkbox":case"radiobutton":{const Et=et.defaultValue===et.exportValues;Ft.setValue(ct,{value:Et});break}case"combobox":case"listbox":{const Et=et.defaultValue||"";Ft.setValue(ct,{value:Et});break}default:continue}const St=document.querySelector(`[data-element-id="${ct}"]`);if(St){if(!x.has(St)){(0,d.warn)(`_bindResetFormAction - element not allowed: ${ct}`);continue}}else continue;St.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}})),!1}}}bt=new WeakSet,ls=function(){this.container.setAttribute("data-internal-link","")},_n=function(f,E,z=null){f.href=this.linkService.getAnchorUrl(""),f.onclick=()=>{var q;return(q=this.downloadManager)==null||q.openOrDownloadData(E.content,E.filename,z),!1},A(this,bt,ls).call(this)},wn=function(f,E){f.href=this.linkService.getAnchorUrl(""),f.onclick=()=>(this.linkService.executeSetOCGState(E),!1),A(this,bt,ls).call(this)};class U extends D{constructor(v){super(v,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const v=document.createElement("img");return v.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",v.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),v.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(v),this.container}}class K extends D{render(){return this.container}showElementAndHideCanvas(v){var f;this.data.hasOwnCanvas&&(((f=v.previousSibling)==null?void 0:f.nodeName)==="CANVAS"&&(v.previousSibling.hidden=!0),v.hidden=!1)}_getKeyModifier(v){return d.FeatureTest.platform.isMac?v.metaKey:v.ctrlKey}_setEventListener(v,f,E,z,q){E.includes("mouse")?v.addEventListener(E,mt=>{var yt;(yt=this.linkService.eventBus)==null||yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:z,value:q(mt),shift:mt.shiftKey,modifier:this._getKeyModifier(mt)}})}):v.addEventListener(E,mt=>{var yt;if(E==="blur"){if(!f.focused||!mt.relatedTarget)return;f.focused=!1}else if(E==="focus"){if(f.focused)return;f.focused=!0}q&&((yt=this.linkService.eventBus)==null||yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:z,value:q(mt)}}))})}_setEventListeners(v,f,E,z){var q,mt,yt;for(const[zt,Ft]of E)(Ft==="Action"||(q=this.data.actions)!=null&&q[Ft])&&((Ft==="Focus"||Ft==="Blur")&&(f||(f={focused:!1})),this._setEventListener(v,f,zt,Ft,z),Ft==="Focus"&&!((mt=this.data.actions)!=null&&mt.Blur)?this._setEventListener(v,f,"blur","Blur",null):Ft==="Blur"&&!((yt=this.data.actions)!=null&&yt.Focus)&&this._setEventListener(v,f,"focus","Focus",null))}_setBackgroundColor(v){const f=this.data.backgroundColor||null;v.style.backgroundColor=f===null?"transparent":d.Util.makeHexColor(f[0],f[1],f[2])}_setTextStyle(v){const f=["left","center","right"],{fontColor:E}=this.data.defaultAppearanceData,z=this.data.defaultAppearanceData.fontSize||j,q=v.style;let mt;const yt=2,zt=Ft=>Math.round(10*Ft)/10;if(this.data.multiLine){const Ft=Math.abs(this.data.rect[3]-this.data.rect[1]-yt),c=Math.round(Ft/(d.LINE_FACTOR*z))||1,O=Ft/c;mt=Math.min(z,zt(O/d.LINE_FACTOR))}else{const Ft=Math.abs(this.data.rect[3]-this.data.rect[1]-yt);mt=Math.min(z,zt(Ft/d.LINE_FACTOR))}q.fontSize=`calc(${mt}px * var(--scale-factor))`,q.color=d.Util.makeHexColor(E[0],E[1],E[2]),this.data.textAlignment!==null&&(q.textAlign=f[this.data.textAlignment])}_setRequired(v,f){f?v.setAttribute("required",!0):v.removeAttribute("required"),v.setAttribute("aria-required",f)}}class P extends K{constructor(v){const f=v.renderForms||v.data.hasOwnCanvas||!v.data.hasAppearance&&!!v.data.fieldValue;super(v,{isRenderable:f})}setPropertyOnSiblings(v,f,E,z){const q=this.annotationStorage;for(const mt of this._getElementsByName(v.name,v.id))mt.domElement&&(mt.domElement[f]=E),q.setValue(mt.id,{[z]:E})}render(){var z,q;const v=this.annotationStorage,f=this.data.id;this.container.classList.add("textWidgetAnnotation");let E=null;if(this.renderForms){const mt=v.getValue(f,{value:this.data.fieldValue});let yt=mt.value||"";const zt=v.getValue(f,{charLimit:this.data.maxLen}).charLimit;zt&&yt.length>zt&&(yt=yt.slice(0,zt));let Ft=mt.formattedValue||((z=this.data.textContent)==null?void 0:z.join(`
`))||null;Ft&&this.data.comb&&(Ft=Ft.replaceAll(/\s+/g,""));const c={userValue:yt,formattedValue:Ft,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(E=document.createElement("textarea"),E.textContent=Ft??yt,this.data.doNotScroll&&(E.style.overflowY="hidden")):(E=document.createElement("input"),E.type="text",E.setAttribute("value",Ft??yt),this.data.doNotScroll&&(E.style.overflowX="hidden")),this.data.hasOwnCanvas&&(E.hidden=!0),x.add(E),E.setAttribute("data-element-id",f),E.disabled=this.data.readOnly,E.name=this.data.fieldName,E.tabIndex=k,this._setRequired(E,this.data.required),zt&&(E.maxLength=zt),E.addEventListener("input",et=>{v.setValue(f,{value:et.target.value}),this.setPropertyOnSiblings(E,"value",et.target.value,"value"),c.formattedValue=null}),E.addEventListener("resetform",et=>{const ct=this.data.defaultFieldValue??"";E.value=c.userValue=ct,c.formattedValue=null});let O=et=>{const{formattedValue:ct}=c;ct!=null&&(et.target.value=ct),et.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){E.addEventListener("focus",ct=>{var Et;if(c.focused)return;const{target:St}=ct;c.userValue&&(St.value=c.userValue),c.lastCommittedValue=St.value,c.commitKey=1,(Et=this.data.actions)!=null&&Et.Focus||(c.focused=!0)}),E.addEventListener("updatefromsandbox",ct=>{this.showElementAndHideCanvas(ct.target);const St={value(Et){c.userValue=Et.detail.value??"",v.setValue(f,{value:c.userValue.toString()}),Et.target.value=c.userValue},formattedValue(Et){const{formattedValue:It}=Et.detail;c.formattedValue=It,It!=null&&Et.target!==document.activeElement&&(Et.target.value=It),v.setValue(f,{formattedValue:It})},selRange(Et){Et.target.setSelectionRange(...Et.detail.selRange)},charLimit:Et=>{var fe;const{charLimit:It}=Et.detail,{target:Kt}=Et;if(It===0){Kt.removeAttribute("maxLength");return}Kt.setAttribute("maxLength",It);let Yt=c.userValue;!Yt||Yt.length<=It||(Yt=Yt.slice(0,It),Kt.value=c.userValue=Yt,v.setValue(f,{value:Yt}),(fe=this.linkService.eventBus)==null||fe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:Yt,willCommit:!0,commitKey:1,selStart:Kt.selectionStart,selEnd:Kt.selectionEnd}}))}};this._dispatchEventFromSandbox(St,ct)}),E.addEventListener("keydown",ct=>{var It;c.commitKey=1;let St=-1;if(ct.key==="Escape"?St=0:ct.key==="Enter"&&!this.data.multiLine?St=2:ct.key==="Tab"&&(c.commitKey=3),St===-1)return;const{value:Et}=ct.target;c.lastCommittedValue!==Et&&(c.lastCommittedValue=Et,c.userValue=Et,(It=this.linkService.eventBus)==null||It.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:Et,willCommit:!0,commitKey:St,selStart:ct.target.selectionStart,selEnd:ct.target.selectionEnd}}))});const et=O;O=null,E.addEventListener("blur",ct=>{var Et,It;if(!c.focused||!ct.relatedTarget)return;(Et=this.data.actions)!=null&&Et.Blur||(c.focused=!1);const{value:St}=ct.target;c.userValue=St,c.lastCommittedValue!==St&&((It=this.linkService.eventBus)==null||It.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:St,willCommit:!0,commitKey:c.commitKey,selStart:ct.target.selectionStart,selEnd:ct.target.selectionEnd}})),et(ct)}),(q=this.data.actions)!=null&&q.Keystroke&&E.addEventListener("beforeinput",ct=>{var Re;c.lastCommittedValue=null;const{data:St,target:Et}=ct,{value:It,selectionStart:Kt,selectionEnd:Yt}=Et;let fe=Kt,Te=Yt;switch(ct.inputType){case"deleteWordBackward":{const Ue=It.substring(0,Kt).match(/\w*[^\w]*$/);Ue&&(fe-=Ue[0].length);break}case"deleteWordForward":{const Ue=It.substring(Kt).match(/^[^\w]*\w*/);Ue&&(Te+=Ue[0].length);break}case"deleteContentBackward":Kt===Yt&&(fe-=1);break;case"deleteContentForward":Kt===Yt&&(Te+=1);break}ct.preventDefault(),(Re=this.linkService.eventBus)==null||Re.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:It,change:St||"",willCommit:!1,selStart:fe,selEnd:Te}})}),this._setEventListeners(E,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ct=>ct.target.value)}if(O&&E.addEventListener("blur",O),this.data.comb){const et=(this.data.rect[2]-this.data.rect[0])/zt;E.classList.add("comb"),E.style.letterSpacing=`calc(${et}px * var(--scale-factor) - 1ch)`}}else E=document.createElement("div"),E.textContent=this.data.fieldValue,E.style.verticalAlign="middle",E.style.display="table-cell",this.data.hasOwnCanvas&&(E.hidden=!0);return this._setTextStyle(E),this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class B extends K{constructor(v){super(v,{isRenderable:!!v.data.hasOwnCanvas})}}class R extends K{constructor(v){super(v,{isRenderable:v.renderForms})}render(){const v=this.annotationStorage,f=this.data,E=f.id;let z=v.getValue(E,{value:f.exportValue===f.fieldValue}).value;typeof z=="string"&&(z=z!=="Off",v.setValue(E,{value:z})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const q=document.createElement("input");return x.add(q),q.setAttribute("data-element-id",E),q.disabled=f.readOnly,this._setRequired(q,this.data.required),q.type="checkbox",q.name=f.fieldName,z&&q.setAttribute("checked",!0),q.setAttribute("exportValue",f.exportValue),q.tabIndex=k,q.addEventListener("change",mt=>{const{name:yt,checked:zt}=mt.target;for(const Ft of this._getElementsByName(yt,E)){const c=zt&&Ft.exportValue===f.exportValue;Ft.domElement&&(Ft.domElement.checked=c),v.setValue(Ft.id,{value:c})}v.setValue(E,{value:zt})}),q.addEventListener("resetform",mt=>{const yt=f.defaultFieldValue||"Off";mt.target.checked=yt===f.exportValue}),this.enableScripting&&this.hasJSActions&&(q.addEventListener("updatefromsandbox",mt=>{const yt={value(zt){zt.target.checked=zt.detail.value!=="Off",v.setValue(E,{value:zt.target.checked})}};this._dispatchEventFromSandbox(yt,mt)}),this._setEventListeners(q,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],mt=>mt.target.checked)),this._setBackgroundColor(q),this._setDefaultPropertiesFromJS(q),this.container.append(q),this.container}}class L extends K{constructor(v){super(v,{isRenderable:v.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const v=this.annotationStorage,f=this.data,E=f.id;let z=v.getValue(E,{value:f.fieldValue===f.buttonValue}).value;if(typeof z=="string"&&(z=z!==f.buttonValue,v.setValue(E,{value:z})),z)for(const mt of this._getElementsByName(f.fieldName,E))v.setValue(mt.id,{value:!1});const q=document.createElement("input");if(x.add(q),q.setAttribute("data-element-id",E),q.disabled=f.readOnly,this._setRequired(q,this.data.required),q.type="radio",q.name=f.fieldName,z&&q.setAttribute("checked",!0),q.tabIndex=k,q.addEventListener("change",mt=>{const{name:yt,checked:zt}=mt.target;for(const Ft of this._getElementsByName(yt,E))v.setValue(Ft.id,{value:!1});v.setValue(E,{value:zt})}),q.addEventListener("resetform",mt=>{const yt=f.defaultFieldValue;mt.target.checked=yt!=null&&yt===f.buttonValue}),this.enableScripting&&this.hasJSActions){const mt=f.buttonValue;q.addEventListener("updatefromsandbox",yt=>{const zt={value:Ft=>{const c=mt===Ft.detail.value;for(const O of this._getElementsByName(Ft.target.name)){const et=c&&O.id===E;O.domElement&&(O.domElement.checked=et),v.setValue(O.id,{value:et})}}};this._dispatchEventFromSandbox(zt,yt)}),this._setEventListeners(q,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],yt=>yt.target.checked)}return this._setBackgroundColor(q),this._setDefaultPropertiesFromJS(q),this.container.append(q),this.container}}class ht extends Z{constructor(v){super(v,{ignoreBorder:v.data.hasAppearance})}render(){const v=super.render();v.classList.add("buttonWidgetAnnotation","pushButton");const f=v.lastChild;return this.enableScripting&&this.hasJSActions&&f&&(this._setDefaultPropertiesFromJS(f),f.addEventListener("updatefromsandbox",E=>{this._dispatchEventFromSandbox({},E)})),v}}class st extends K{constructor(v){super(v,{isRenderable:v.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const v=this.annotationStorage,f=this.data.id,E=v.getValue(f,{value:this.data.fieldValue}),z=document.createElement("select");x.add(z),z.setAttribute("data-element-id",f),z.disabled=this.data.readOnly,this._setRequired(z,this.data.required),z.name=this.data.fieldName,z.tabIndex=k;let q=this.data.combo&&this.data.options.length>0;this.data.combo||(z.size=this.data.options.length,this.data.multiSelect&&(z.multiple=!0)),z.addEventListener("resetform",c=>{const O=this.data.defaultFieldValue;for(const et of z.options)et.selected=et.value===O});for(const c of this.data.options){const O=document.createElement("option");O.textContent=c.displayValue,O.value=c.exportValue,E.value.includes(c.exportValue)&&(O.setAttribute("selected",!0),q=!1),z.append(O)}let mt=null;if(q){const c=document.createElement("option");c.value=" ",c.setAttribute("hidden",!0),c.setAttribute("selected",!0),z.prepend(c),mt=()=>{c.remove(),z.removeEventListener("input",mt),mt=null},z.addEventListener("input",mt)}const yt=c=>{const O=c?"value":"textContent",{options:et,multiple:ct}=z;return ct?Array.prototype.filter.call(et,St=>St.selected).map(St=>St[O]):et.selectedIndex===-1?null:et[et.selectedIndex][O]};let zt=yt(!1);const Ft=c=>{const O=c.target.options;return Array.prototype.map.call(O,et=>({displayValue:et.textContent,exportValue:et.value}))};return this.enableScripting&&this.hasJSActions?(z.addEventListener("updatefromsandbox",c=>{const O={value(et){mt==null||mt();const ct=et.detail.value,St=new Set(Array.isArray(ct)?ct:[ct]);for(const Et of z.options)Et.selected=St.has(Et.value);v.setValue(f,{value:yt(!0)}),zt=yt(!1)},multipleSelection(et){z.multiple=!0},remove(et){const ct=z.options,St=et.detail.remove;ct[St].selected=!1,z.remove(St),ct.length>0&&Array.prototype.findIndex.call(ct,Et=>Et.selected)===-1&&(ct[0].selected=!0),v.setValue(f,{value:yt(!0),items:Ft(et)}),zt=yt(!1)},clear(et){for(;z.length!==0;)z.remove(0);v.setValue(f,{value:null,items:[]}),zt=yt(!1)},insert(et){const{index:ct,displayValue:St,exportValue:Et}=et.detail.insert,It=z.children[ct],Kt=document.createElement("option");Kt.textContent=St,Kt.value=Et,It?It.before(Kt):z.append(Kt),v.setValue(f,{value:yt(!0),items:Ft(et)}),zt=yt(!1)},items(et){const{items:ct}=et.detail;for(;z.length!==0;)z.remove(0);for(const St of ct){const{displayValue:Et,exportValue:It}=St,Kt=document.createElement("option");Kt.textContent=Et,Kt.value=It,z.append(Kt)}z.options.length>0&&(z.options[0].selected=!0),v.setValue(f,{value:yt(!0),items:Ft(et)}),zt=yt(!1)},indices(et){const ct=new Set(et.detail.indices);for(const St of et.target.options)St.selected=ct.has(St.index);v.setValue(f,{value:yt(!0)}),zt=yt(!1)},editable(et){et.target.disabled=!et.detail.editable}};this._dispatchEventFromSandbox(O,c)}),z.addEventListener("input",c=>{var ct;const O=yt(!0),et=yt(!1);v.setValue(f,{value:O}),c.preventDefault(),(ct=this.linkService.eventBus)==null||ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:zt,change:et,changeEx:O,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(z,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],c=>c.target.value)):z.addEventListener("input",function(c){v.setValue(f,{value:yt(!0)})}),this.data.combo&&this._setTextStyle(z),this._setBackgroundColor(z),this._setDefaultPropertiesFromJS(z),this.container.append(z),this.container}}class At extends D{constructor(v){const{data:f,elements:E}=v;super(v,{isRenderable:D._hasPopupData(f)}),this.elements=E}render(){this.container.classList.add("popupAnnotation");const v=new Tt({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),f=[];for(const E of this.elements)E.popup=v,f.push(E.data.id),E.addHighlightArea();return this.container.setAttribute("aria-controls",f.map(E=>`${d.AnnotationPrefix}${E}`).join(",")),this.container}}class Tt{constructor({container:v,color:f,elements:E,titleObj:z,modificationDate:q,contentsObj:mt,richText:yt,parent:zt,rect:Ft,parentRect:c,open:O}){w(this,it);w(this,s,A(this,it,En).bind(this));w(this,a,A(this,it,wi).bind(this));w(this,h,A(this,it,_i).bind(this));w(this,l,A(this,it,$s).bind(this));w(this,g,null);w(this,u,null);w(this,p,null);w(this,M,null);w(this,e,null);w(this,i,null);w(this,o,null);w(this,m,!1);w(this,T,null);w(this,$,null);w(this,W,null);w(this,tt,null);w(this,ft,!1);var et;_(this,u,v),_(this,tt,z),_(this,p,mt),_(this,W,yt),_(this,i,zt),_(this,g,f),_(this,$,Ft),_(this,o,c),_(this,e,E),_(this,M,J.PDFDateString.toDateObject(q)),this.trigger=E.flatMap(ct=>ct.getElementsToTriggerPopup());for(const ct of this.trigger)ct.addEventListener("click",t(this,l)),ct.addEventListener("mouseenter",t(this,h)),ct.addEventListener("mouseleave",t(this,a)),ct.classList.add("popupTriggerArea");for(const ct of E)(et=ct.container)==null||et.addEventListener("keydown",t(this,s));t(this,u).hidden=!0,O&&A(this,it,$s).call(this)}render(){if(t(this,T))return;const{page:{view:v},viewport:{rawDims:{pageWidth:f,pageHeight:E,pageX:z,pageY:q}}}=t(this,i),mt=_(this,T,document.createElement("div"));if(mt.className="popup",t(this,g)){const Yt=mt.style.outlineColor=d.Util.makeHexColor(...t(this,g));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?mt.style.backgroundColor=`color-mix(in srgb, ${Yt} 30%, white)`:mt.style.backgroundColor=d.Util.makeHexColor(...t(this,g).map(fe=>Math.floor(.7*(255-fe)+fe)))}const yt=document.createElement("span");yt.className="header";const zt=document.createElement("h1");if(yt.append(zt),{dir:zt.dir,str:zt.textContent}=t(this,tt),mt.append(yt),t(this,M)){const Yt=document.createElement("span");Yt.classList.add("popupDate"),Yt.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),Yt.setAttribute("data-l10n-args",JSON.stringify({date:t(this,M).toLocaleDateString(),time:t(this,M).toLocaleTimeString()})),yt.append(Yt)}const Ft=t(this,p),c=t(this,W);if(c!=null&&c.str&&(!(Ft!=null&&Ft.str)||Ft.str===c.str))I.XfaLayer.render({xfaHtml:c.html,intent:"richText",div:mt}),mt.lastChild.classList.add("richText","popupContent");else{const Yt=this._formatContents(Ft);mt.append(Yt)}let O=!!t(this,o),et=O?t(this,o):t(this,$);for(const Yt of t(this,e))if(!et||d.Util.intersect(Yt.data.rect,et)!==null){et=Yt.data.rect,O=!0;break}const ct=d.Util.normalizeRect([et[0],v[3]-et[1]+v[1],et[2],v[3]-et[3]+v[1]]),St=O?et[2]-et[0]+5:0,Et=ct[0]+St,It=ct[1],{style:Kt}=t(this,u);Kt.left=`${100*(Et-z)/f}%`,Kt.top=`${100*(It-q)/E}%`,t(this,u).append(mt)}_formatContents({str:v,dir:f}){const E=document.createElement("p");E.classList.add("popupContent"),E.dir=f;const z=v.split(/(?:\r\n?|\n)/);for(let q=0,mt=z.length;q<mt;++q){const yt=z[q];E.append(document.createTextNode(yt)),q<mt-1&&E.append(document.createElement("br"))}return E}forceHide(){_(this,ft,this.isVisible),t(this,ft)&&(t(this,u).hidden=!0)}maybeShow(){t(this,ft)&&(_(this,ft,!1),t(this,u).hidden=!1)}get isVisible(){return t(this,u).hidden===!1}}s=new WeakMap,a=new WeakMap,h=new WeakMap,l=new WeakMap,g=new WeakMap,u=new WeakMap,p=new WeakMap,M=new WeakMap,e=new WeakMap,i=new WeakMap,o=new WeakMap,m=new WeakMap,T=new WeakMap,$=new WeakMap,W=new WeakMap,tt=new WeakMap,ft=new WeakMap,it=new WeakSet,En=function(v){v.altKey||v.shiftKey||v.ctrlKey||v.metaKey||(v.key==="Enter"||v.key==="Escape"&&t(this,m))&&A(this,it,$s).call(this)},$s=function(){_(this,m,!t(this,m)),t(this,m)?(A(this,it,_i).call(this),t(this,u).addEventListener("click",t(this,l)),t(this,u).addEventListener("keydown",t(this,s))):(A(this,it,wi).call(this),t(this,u).removeEventListener("click",t(this,l)),t(this,u).removeEventListener("keydown",t(this,s)))},_i=function(){t(this,T)||this.render(),this.isVisible?t(this,m)&&t(this,u).classList.add("focused"):(t(this,u).hidden=!1,t(this,u).style.zIndex=parseInt(t(this,u).style.zIndex)+1e3)},wi=function(){t(this,u).classList.remove("focused"),!(t(this,m)||!this.isVisible)&&(t(this,u).hidden=!0,t(this,u).style.zIndex=parseInt(t(this,u).style.zIndex)-1e3)};class ot extends D{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0}),this.textContent=v.data.textContent,this.textPosition=v.data.textPosition,this.annotationEditorType=d.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const v=document.createElement("div");v.classList.add("annotationTextContent"),v.setAttribute("role","comment");for(const f of this.textContent){const E=document.createElement("span");E.textContent=f,v.append(E)}this.container.append(v)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class nt extends D{constructor(f){super(f,{isRenderable:!0,ignoreBorder:!0});w(this,Ht,null)}render(){this.container.classList.add("lineAnnotation");const f=this.data,{width:E,height:z}=y(f.rect),q=this.svgFactory.create(E,z,!0),mt=_(this,Ht,this.svgFactory.createElement("svg:line"));return mt.setAttribute("x1",f.rect[2]-f.lineCoordinates[0]),mt.setAttribute("y1",f.rect[3]-f.lineCoordinates[1]),mt.setAttribute("x2",f.rect[2]-f.lineCoordinates[2]),mt.setAttribute("y2",f.rect[3]-f.lineCoordinates[3]),mt.setAttribute("stroke-width",f.borderStyle.width||1),mt.setAttribute("stroke","transparent"),mt.setAttribute("fill","transparent"),q.append(mt),this.container.append(q),!f.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Ht)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ht=new WeakMap;class Mt extends D{constructor(f){super(f,{isRenderable:!0,ignoreBorder:!0});w(this,lt,null)}render(){this.container.classList.add("squareAnnotation");const f=this.data,{width:E,height:z}=y(f.rect),q=this.svgFactory.create(E,z,!0),mt=f.borderStyle.width,yt=_(this,lt,this.svgFactory.createElement("svg:rect"));return yt.setAttribute("x",mt/2),yt.setAttribute("y",mt/2),yt.setAttribute("width",E-mt),yt.setAttribute("height",z-mt),yt.setAttribute("stroke-width",mt||1),yt.setAttribute("stroke","transparent"),yt.setAttribute("fill","transparent"),q.append(yt),this.container.append(q),!f.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,lt)}addHighlightArea(){this.container.classList.add("highlightArea")}}lt=new WeakMap;class Dt extends D{constructor(f){super(f,{isRenderable:!0,ignoreBorder:!0});w(this,ut,null)}render(){this.container.classList.add("circleAnnotation");const f=this.data,{width:E,height:z}=y(f.rect),q=this.svgFactory.create(E,z,!0),mt=f.borderStyle.width,yt=_(this,ut,this.svgFactory.createElement("svg:ellipse"));return yt.setAttribute("cx",E/2),yt.setAttribute("cy",z/2),yt.setAttribute("rx",E/2-mt/2),yt.setAttribute("ry",z/2-mt/2),yt.setAttribute("stroke-width",mt||1),yt.setAttribute("stroke","transparent"),yt.setAttribute("fill","transparent"),q.append(yt),this.container.append(q),!f.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,ut)}addHighlightArea(){this.container.classList.add("highlightArea")}}ut=new WeakMap;class Lt extends D{constructor(f){super(f,{isRenderable:!0,ignoreBorder:!0});w(this,C,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const f=this.data,{width:E,height:z}=y(f.rect),q=this.svgFactory.create(E,z,!0);let mt=[];for(const zt of f.vertices){const Ft=zt.x-f.rect[0],c=f.rect[3]-zt.y;mt.push(Ft+","+c)}mt=mt.join(" ");const yt=_(this,C,this.svgFactory.createElement(this.svgElementName));return yt.setAttribute("points",mt),yt.setAttribute("stroke-width",f.borderStyle.width||1),yt.setAttribute("stroke","transparent"),yt.setAttribute("fill","transparent"),q.append(yt),this.container.append(q),!f.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,C)}addHighlightArea(){this.container.classList.add("highlightArea")}}C=new WeakMap;class Xt extends Lt{constructor(v){super(v),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ae extends D{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Jt extends D{constructor(f){super(f,{isRenderable:!0,ignoreBorder:!0});w(this,X,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=d.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const f=this.data,{width:E,height:z}=y(f.rect),q=this.svgFactory.create(E,z,!0);for(const mt of f.inkLists){let yt=[];for(const Ft of mt){const c=Ft.x-f.rect[0],O=f.rect[3]-Ft.y;yt.push(`${c},${O}`)}yt=yt.join(" ");const zt=this.svgFactory.createElement(this.svgElementName);t(this,X).push(zt),zt.setAttribute("points",yt),zt.setAttribute("stroke-width",f.borderStyle.width||1),zt.setAttribute("stroke","transparent"),zt.setAttribute("fill","transparent"),!f.popupRef&&this.hasPopupData&&this._createPopup(),q.append(zt)}return this.container.append(q),this.container}getElementsToTriggerPopup(){return t(this,X)}addHighlightArea(){this.container.classList.add("highlightArea")}}X=new WeakMap;class ne extends D{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class oe extends D{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Rt extends D{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Qt extends D{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class ue extends D{constructor(v){super(v,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class be extends D{constructor(f){var q;super(f,{isRenderable:!0});w(this,vt);w(this,Q,null);const{filename:E,content:z}=this.data.file;this.filename=(0,J.getFilenameFromUrl)(E,!0),this.content=z,(q=this.linkService.eventBus)==null||q.dispatch("fileattachmentannotation",{source:this,filename:E,content:z})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:f,data:E}=this;let z;E.hasAppearance||E.fillAlpha===0?z=document.createElement("div"):(z=document.createElement("img"),z.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(E.name)?"paperclip":"pushpin"}.svg`,E.fillAlpha&&E.fillAlpha<1&&(z.style=`filter: opacity(${Math.round(E.fillAlpha*100)}%);`)),z.addEventListener("dblclick",A(this,vt,Ei).bind(this)),_(this,Q,z);const{isMac:q}=d.FeatureTest.platform;return f.addEventListener("keydown",mt=>{mt.key==="Enter"&&(q?mt.metaKey:mt.ctrlKey)&&A(this,vt,Ei).call(this)}),!E.popupRef&&this.hasPopupData?this._createPopup():z.classList.add("popupTriggerArea"),f.append(z),f}getElementsToTriggerPopup(){return t(this,Q)}addHighlightArea(){this.container.classList.add("highlightArea")}}Q=new WeakMap,vt=new WeakSet,Ei=function(){var f;(f=this.downloadManager)==null||f.openOrDownloadData(this.content,this.filename)};class Ut{constructor({div:v,accessibilityManager:f,annotationCanvasMap:E,annotationEditorUIManager:z,page:q,viewport:mt}){w(this,de);w(this,Pt,null);w(this,Bt,null);w(this,te,new Map);this.div=v,_(this,Pt,f),_(this,Bt,E),this.page=q,this.viewport=mt,this.zIndex=0,this._annotationEditorUIManager=z}async render(v){var mt;const{annotations:f}=v,E=this.div;(0,J.setLayerDimensions)(E,this.viewport);const z=new Map,q={data:null,layer:E,linkService:v.linkService,downloadManager:v.downloadManager,imageResourcesPath:v.imageResourcesPath||"",renderForms:v.renderForms!==!1,svgFactory:new J.DOMSVGFactory,annotationStorage:v.annotationStorage||new N.AnnotationStorage,enableScripting:v.enableScripting===!0,hasJSActions:v.hasJSActions,fieldObjects:v.fieldObjects,parent:this,elements:null};for(const yt of f){if(yt.noHTML)continue;const zt=yt.annotationType===d.AnnotationType.POPUP;if(zt){const O=z.get(yt.id);if(!O)continue;q.elements=O}else{const{width:O,height:et}=y(yt.rect);if(O<=0||et<=0)continue}q.data=yt;const Ft=F.create(q);if(!Ft.isRenderable)continue;if(!zt&&yt.popupRef){const O=z.get(yt.popupRef);O?O.push(Ft):z.set(yt.popupRef,[Ft])}const c=Ft.render();yt.hidden&&(c.style.visibility="hidden"),A(this,de,xn).call(this,c,yt.id),Ft.annotationEditorType>0&&(t(this,te).set(Ft.data.id,Ft),(mt=this._annotationEditorUIManager)==null||mt.renderAnnotationElement(Ft))}A(this,de,xi).call(this)}update({viewport:v}){const f=this.div;this.viewport=v,(0,J.setLayerDimensions)(f,{rotation:v.rotation}),A(this,de,xi).call(this),f.hidden=!1}getEditableAnnotations(){return Array.from(t(this,te).values())}getEditableAnnotation(v){return t(this,te).get(v)}}Pt=new WeakMap,Bt=new WeakMap,te=new WeakMap,de=new WeakSet,xn=function(v,f){var z;const E=v.firstChild||v;E.id=`${d.AnnotationPrefix}${f}`,this.div.append(v),(z=t(this,Pt))==null||z.moveElementInDOM(this.div,v,E,!1)},xi=function(){if(!t(this,Bt))return;const v=this.div;for(const[f,E]of t(this,Bt)){const z=v.querySelector(`[data-annotation-id="${f}"]`);if(!z)continue;E.className="annotationContent";const{firstChild:q}=z;q?q.nodeName==="CANVAS"?q.replaceWith(E):q.classList.contains("annotationContent")?q.after(E):q.before(E):z.append(E)}t(this,Bt).clear()}},792:(se,Vt,dt)=>{var I,k,j,Sn,y;dt.d(Vt,{AnnotationStorage:()=>pt,PrintAnnotationStorage:()=>H,SerializableEmpty:()=>Y});var d=dt(292),J=dt(310),N=dt(651);const Y=Object.freeze({map:null,hash:"",transfer:void 0});class pt{constructor(){w(this,j);w(this,I,!1);w(this,k,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(D,Z){const U=t(this,k).get(D);return U===void 0?Z:Object.assign(Z,U)}getRawValue(D){return t(this,k).get(D)}remove(D){if(t(this,k).delete(D),t(this,k).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const Z of t(this,k).values())if(Z instanceof J.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(D,Z){const U=t(this,k).get(D);let K=!1;if(U!==void 0)for(const[P,B]of Object.entries(Z))U[P]!==B&&(K=!0,U[P]=B);else K=!0,t(this,k).set(D,Z);K&&A(this,j,Sn).call(this),Z instanceof J.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(Z.constructor._type)}has(D){return t(this,k).has(D)}getAll(){return t(this,k).size>0?(0,d.objectFromMap)(t(this,k)):null}setAll(D){for(const[Z,U]of Object.entries(D))this.setValue(Z,U)}get size(){return t(this,k).size}resetModified(){t(this,I)&&(_(this,I,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new H(this)}get serializable(){if(t(this,k).size===0)return Y;const D=new Map,Z=new N.MurmurHash3_64,U=[],K=Object.create(null);let P=!1;for(const[B,R]of t(this,k)){const L=R instanceof J.AnnotationEditor?R.serialize(!1,K):R;L&&(D.set(B,L),Z.update(`${B}:${JSON.stringify(L)}`),P||(P=!!L.bitmap))}if(P)for(const B of D.values())B.bitmap&&U.push(B.bitmap);return D.size>0?{map:D,hash:Z.hexdigest(),transfer:U}:Y}get editorStats(){let D=null;const Z=new Map;for(const U of t(this,k).values()){if(!(U instanceof J.AnnotationEditor))continue;const K=U.telemetryFinalData;if(!K)continue;const{type:P}=K;Z.has(P)||Z.set(P,Object.getPrototypeOf(U).constructor),D||(D=Object.create(null));const B=D[P]||(D[P]=new Map);for(const[R,L]of Object.entries(K)){if(R==="type")continue;let ht=B.get(R);ht||(ht=new Map,B.set(R,ht));const st=ht.get(L)??0;ht.set(L,st+1)}}for(const[U,K]of Z)D[U]=K.computeTelemetryFinalData(D[U]);return D}}I=new WeakMap,k=new WeakMap,j=new WeakSet,Sn=function(){t(this,I)||(_(this,I,!0),typeof this.onSetModified=="function"&&this.onSetModified())};class H extends pt{constructor(Z){super();w(this,y);const{map:U,hash:K,transfer:P}=Z.serializable,B=structuredClone(U,P?{transfer:P}:null);_(this,y,{map:B,hash:K,transfer:P})}get print(){(0,d.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,y)}}y=new WeakMap},831:(se,Vt,dt)=>{dt.a(se,async(d,J)=>{var L,ht,st,At,bs,Xs,nt,Mt,Dt,Lt,Xt,Ks,Jt,ne,oe,Rt,Qt,ue,Rs,Ut,le,Si,ce,Zt;try{let Ot=function(ut){if(typeof ut=="string"||ut instanceof URL?ut={url:ut}:(ut instanceof ArrayBuffer||ArrayBuffer.isView(ut))&&(ut={data:ut}),typeof ut!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!ut.url&&!ut.data&&!ut.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const C=new M,{docId:X}=C,Q=ut.url?bt(ut.url):null,vt=ut.data?gt(ut.data):null,xt=ut.httpHeaders||null,Pt=ut.withCredentials===!0,Bt=ut.password??null,te=ut.range instanceof e?ut.range:null,de=Number.isInteger(ut.rangeChunkSize)&&ut.rangeChunkSize>0?ut.rangeChunkSize:n;let Ae=ut.worker instanceof $?ut.worker:null;const _e=ut.verbosity,$t=typeof ut.docBaseUrl=="string"&&!(0,pt.isDataScheme)(ut.docBaseUrl)?ut.docBaseUrl:null,v=typeof ut.cMapUrl=="string"?ut.cMapUrl:null,f=ut.cMapPacked!==!1,E=ut.CMapReaderFactory||l,z=typeof ut.standardFontDataUrl=="string"?ut.standardFontDataUrl:null,q=ut.StandardFontDataFactory||u,mt=ut.stopAtErrors!==!0,yt=Number.isInteger(ut.maxImageSize)&&ut.maxImageSize>-1?ut.maxImageSize:-1,zt=ut.isEvalSupported!==!1,Ft=typeof ut.isOffscreenCanvasSupported=="boolean"?ut.isOffscreenCanvasSupported:!N.isNodeJS,c=Number.isInteger(ut.canvasMaxAreaInBytes)?ut.canvasMaxAreaInBytes:-1,O=typeof ut.disableFontFace=="boolean"?ut.disableFontFace:N.isNodeJS,et=ut.fontExtraProperties===!0,ct=ut.enableXfa===!0,St=ut.ownerDocument||globalThis.document,Et=ut.disableRange===!0,It=ut.disableStream===!0,Kt=ut.disableAutoFetch===!0,Yt=ut.pdfBug===!0,fe=te?te.length:ut.length??NaN,Te=typeof ut.useSystemFonts=="boolean"?ut.useSystemFonts:!N.isNodeJS&&!O,Re=typeof ut.useWorkerFetch=="boolean"?ut.useWorkerFetch:E===pt.DOMCMapReaderFactory&&q===pt.DOMStandardFontDataFactory&&v&&z&&(0,pt.isValidFetchUrl)(v,document.baseURI)&&(0,pt.isValidFetchUrl)(z,document.baseURI),Ue=ut.canvasFactory||new h({ownerDocument:St}),Ie=ut.filterFactory||new g({docId:X,ownerDocument:St}),js=null;(0,N.setVerbosityLevel)(_e);const fi={canvasFactory:Ue,filterFactory:Ie};if(Re||(fi.cMapReaderFactory=new E({baseUrl:v,isCompressed:f}),fi.standardFontDataFactory=new q({baseUrl:z})),!Ae){const Es={verbosity:_e,port:x.GlobalWorkerOptions.workerPort};Ae=Es.port?$.fromPort(Es):new $(Es),C._worker=Ae}const Dr={docId:X,apiVersion:"4.2.67",data:vt,password:Bt,disableAutoFetch:Kt,rangeChunkSize:de,length:fe,docBaseUrl:$t,enableXfa:ct,evaluatorOptions:{maxImageSize:yt,disableFontFace:O,ignoreErrors:mt,isEvalSupported:zt,isOffscreenCanvasSupported:Ft,canvasMaxAreaInBytes:c,fontExtraProperties:et,useSystemFonts:Te,cMapUrl:Re?v:null,standardFontDataUrl:Re?z:null}},Ir={ignoreErrors:mt,disableFontFace:O,fontExtraProperties:et,enableXfa:ct,ownerDocument:St,disableAutoFetch:Kt,pdfBug:Yt,styleElement:js};return Ae.promise.then(function(){if(C.destroyed)throw new Error("Loading aborted");const Es=p(Ae,Dr),Fr=new Promise(function(mi){let Ee;te?Ee=new Z.PDFDataTransportStream(te,{disableRange:Et,disableStream:It}):vt||(Ee=(Se=>N.isNodeJS?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&(0,pt.isValidFetchUrl)(Se.url)?new U.PDFFetchStream(Se):new P.PDFNodeStream(Se):(0,pt.isValidFetchUrl)(Se.url)?new U.PDFFetchStream(Se):new K.PDFNetworkStream(Se))({url:Q,length:fe,httpHeaders:xt,withCredentials:Pt,rangeChunkSize:de,disableRange:Et,disableStream:It})),mi(Ee)});return Promise.all([Es,Fr]).then(function([mi,Ee]){if(C.destroyed)throw new Error("Loading aborted");const Se=new y.MessageHandler(X,mi,Ae.port),Le=new W(Se,C,Ee,Ir,fi);C._transport=Le,Se.send("Ready",null)})}).catch(C._capability.reject),C},bt=function(ut){if(ut instanceof URL)return ut.href;try{return new URL(ut,window.location).href}catch{if(N.isNodeJS&&typeof ut=="string")return ut}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")},gt=function(ut){if(N.isNodeJS&&typeof Buffer<"u"&&ut instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(ut instanceof Uint8Array&&ut.byteLength===ut.buffer.byteLength)return ut;if(typeof ut=="string")return(0,N.stringToBytes)(ut);if(ut instanceof ArrayBuffer||ArrayBuffer.isView(ut)||typeof ut=="object"&&!isNaN(ut==null?void 0:ut.length))return new Uint8Array(ut);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")},S=function(ut){return typeof ut=="object"&&Number.isInteger(ut==null?void 0:ut.num)&&ut.num>=0&&Number.isInteger(ut==null?void 0:ut.gen)&&ut.gen>=0};dt.d(Vt,{PDFDataRangeTransport:()=>e,PDFWorker:()=>$,build:()=>Gt,getDocument:()=>Ot,version:()=>Nt});var N=dt(292),Y=dt(792),pt=dt(419),H=dt(10),I=dt(573),k=dt(923),j=dt(814),x=dt(164),y=dt(178),F=dt(62),D=dt(626),Z=dt(585),U=dt(94),K=dt(457),P=dt(786),B=dt(50),R=d([I,P]);[I,P]=R.then?(await R)():R;const n=65536,s=100,a=5e3,h=N.isNodeJS?I.NodeCanvasFactory:pt.DOMCanvasFactory,l=N.isNodeJS?I.NodeCMapReaderFactory:pt.DOMCMapReaderFactory,g=N.isNodeJS?I.NodeFilterFactory:pt.DOMFilterFactory,u=N.isNodeJS?I.NodeStandardFontDataFactory:pt.DOMStandardFontDataFactory;async function p(ut,C){if(ut.destroyed)throw new Error("Worker was destroyed");const X=await ut.messageHandler.sendWithPromise("GetDocRequest",C,C.data?[C.data.buffer]:null);if(ut.destroyed)throw new Error("Worker was destroyed");return X}const Wt=class Wt{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Je(Wt,L)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var C,X,Q;this.destroyed=!0;try{(C=this._worker)!=null&&C.port&&(this._worker._pendingDestroy=!0),await((X=this._transport)==null?void 0:X.destroy())}catch(vt){throw(Q=this._worker)!=null&&Q.port&&delete this._worker._pendingDestroy,vt}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};L=new WeakMap,w(Wt,L,0);let M=Wt;class e{constructor(C,X,Q=!1,vt=null){this.length=C,this.initialData=X,this.progressiveDone=Q,this.contentDispositionFilename=vt,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(C){this._rangeListeners.push(C)}addProgressListener(C){this._progressListeners.push(C)}addProgressiveReadListener(C){this._progressiveReadListeners.push(C)}addProgressiveDoneListener(C){this._progressiveDoneListeners.push(C)}onDataRange(C,X){for(const Q of this._rangeListeners)Q(C,X)}onDataProgress(C,X){this._readyCapability.promise.then(()=>{for(const Q of this._progressListeners)Q(C,X)})}onDataProgressiveRead(C){this._readyCapability.promise.then(()=>{for(const X of this._progressiveReadListeners)X(C)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const C of this._progressiveDoneListeners)C()})}transportReady(){this._readyCapability.resolve()}requestDataRange(C,X){(0,N.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class i{constructor(C,X){this._pdfInfo=C,this._transport=X}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,N.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(C){return this._transport.getPage(C)}getPageIndex(C){return this._transport.getPageIndex(C)}getDestinations(){return this._transport.getDestinations()}getDestination(C){return this._transport.getDestination(C)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:C="display"}={}){const{renderingIntent:X}=this._transport.getRenderingIntent(C);return this._transport.getOptionalContentConfig(X)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(C=!1){return this._transport.startCleanup(C||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(C){return this._transport.cachedPageNumber(C)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class o{constructor(C,X,Q,vt=!1){w(this,At);w(this,ht,null);w(this,st,!1);this._pageIndex=C,this._pageInfo=X,this._transport=Q,this._stats=vt?new pt.StatTimer:null,this._pdfBug=vt,this.commonObjs=Q.commonObjs,this.objs=new ft,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:C,rotation:X=this.rotate,offsetX:Q=0,offsetY:vt=0,dontFlip:xt=!1}={}){return new pt.PageViewport({viewBox:this.view,scale:C,rotation:X,offsetX:Q,offsetY:vt,dontFlip:xt})}getAnnotations({intent:C="display"}={}){const{renderingIntent:X}=this._transport.getRenderingIntent(C);return this._transport.getAnnotations(this._pageIndex,X)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,N.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var C;return((C=this._transport._htmlForXfa)==null?void 0:C.children[this._pageIndex])||null}render({canvasContext:C,viewport:X,intent:Q="display",annotationMode:vt=N.AnnotationMode.ENABLE,transform:xt=null,background:Pt=null,optionalContentConfigPromise:Bt=null,annotationCanvasMap:te=null,pageColors:de=null,printAnnotationStorage:Ae=null}){var yt,zt;(yt=this._stats)==null||yt.time("Overall");const _e=this._transport.getRenderingIntent(Q,vt,Ae),{renderingIntent:$t,cacheKey:v}=_e;_(this,st,!1),A(this,At,Xs).call(this),Bt||(Bt=this._transport.getOptionalContentConfig($t));let f=this._intentStates.get(v);f||(f=Object.create(null),this._intentStates.set(v,f)),f.streamReaderCancelTimeout&&(clearTimeout(f.streamReaderCancelTimeout),f.streamReaderCancelTimeout=null);const E=!!($t&N.RenderingIntentFlag.PRINT);f.displayReadyCapability||(f.displayReadyCapability=Promise.withResolvers(),f.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(zt=this._stats)==null||zt.time("Page Request"),this._pumpOperatorList(_e));const z=Ft=>{var c,O;f.renderTasks.delete(q),(this._maybeCleanupAfterRender||E)&&_(this,st,!0),A(this,At,bs).call(this,!E),Ft?(q.capability.reject(Ft),this._abortOperatorList({intentState:f,reason:Ft instanceof Error?Ft:new Error(Ft)})):q.capability.resolve(),(c=this._stats)==null||c.timeEnd("Rendering"),(O=this._stats)==null||O.timeEnd("Overall")},q=new wt({callback:z,params:{canvasContext:C,viewport:X,transform:xt,background:Pt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:te,operatorList:f.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!E,pdfBug:this._pdfBug,pageColors:de});(f.renderTasks||(f.renderTasks=new Set)).add(q);const mt=q.task;return Promise.all([f.displayReadyCapability.promise,Bt]).then(([Ft,c])=>{var O;if(this.destroyed){z();return}if((O=this._stats)==null||O.time("Rendering"),!(c.renderingIntent&$t))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");q.initializeGraphics({transparency:Ft,optionalContentConfig:c}),q.operatorListChanged()}).catch(z),mt}getOperatorList({intent:C="display",annotationMode:X=N.AnnotationMode.ENABLE,printAnnotationStorage:Q=null}={}){var te;function vt(){Pt.operatorList.lastChunk&&(Pt.opListReadCapability.resolve(Pt.operatorList),Pt.renderTasks.delete(Bt))}const xt=this._transport.getRenderingIntent(C,X,Q,!0);let Pt=this._intentStates.get(xt.cacheKey);Pt||(Pt=Object.create(null),this._intentStates.set(xt.cacheKey,Pt));let Bt;return Pt.opListReadCapability||(Bt=Object.create(null),Bt.operatorListChanged=vt,Pt.opListReadCapability=Promise.withResolvers(),(Pt.renderTasks||(Pt.renderTasks=new Set)).add(Bt),Pt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(te=this._stats)==null||te.time("Page Request"),this._pumpOperatorList(xt)),Pt.opListReadCapability.promise}streamTextContent({includeMarkedContent:C=!1,disableNormalization:X=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:C===!0,disableNormalization:X===!0},{highWaterMark:100,size(Q){return Q.items.length}})}getTextContent(C={}){if(this._transport._htmlForXfa)return this.getXfa().then(Q=>B.XfaText.textContent(Q));const X=this.streamTextContent(C);return new Promise(function(Q,vt){function xt(){Pt.read().then(function({value:te,done:de}){if(de){Q(Bt);return}Object.assign(Bt.styles,te.styles),Bt.items.push(...te.items),xt()},vt)}const Pt=X.getReader(),Bt={items:[],styles:Object.create(null)};xt()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const C=[];for(const X of this._intentStates.values())if(this._abortOperatorList({intentState:X,reason:new Error("Page was destroyed."),force:!0}),!X.opListReadCapability)for(const Q of X.renderTasks)C.push(Q.completed),Q.cancel();return this.objs.clear(),_(this,st,!1),A(this,At,Xs).call(this),Promise.all(C)}cleanup(C=!1){_(this,st,!0);const X=A(this,At,bs).call(this,!1);return C&&X&&this._stats&&(this._stats=new pt.StatTimer),X}_startRenderPage(C,X){var vt,xt;const Q=this._intentStates.get(X);Q&&((vt=this._stats)==null||vt.timeEnd("Page Request"),(xt=Q.displayReadyCapability)==null||xt.resolve(C))}_renderPageChunk(C,X){for(let Q=0,vt=C.length;Q<vt;Q++)X.operatorList.fnArray.push(C.fnArray[Q]),X.operatorList.argsArray.push(C.argsArray[Q]);X.operatorList.lastChunk=C.lastChunk,X.operatorList.separateAnnots=C.separateAnnots;for(const Q of X.renderTasks)Q.operatorListChanged();C.lastChunk&&A(this,At,bs).call(this,!0)}_pumpOperatorList({renderingIntent:C,cacheKey:X,annotationStorageSerializable:Q}){const{map:vt,transfer:xt}=Q,Pt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:C,cacheKey:X,annotationStorage:vt},xt).getReader(),Bt=this._intentStates.get(X);Bt.streamReader=Pt;const te=()=>{Pt.read().then(({value:de,done:Ae})=>{if(Ae){Bt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(de,Bt),te())},de=>{if(Bt.streamReader=null,!this._transport.destroyed){if(Bt.operatorList){Bt.operatorList.lastChunk=!0;for(const Ae of Bt.renderTasks)Ae.operatorListChanged();A(this,At,bs).call(this,!0)}if(Bt.displayReadyCapability)Bt.displayReadyCapability.reject(de);else if(Bt.opListReadCapability)Bt.opListReadCapability.reject(de);else throw de}})};te()}_abortOperatorList({intentState:C,reason:X,force:Q=!1}){if(C.streamReader){if(C.streamReaderCancelTimeout&&(clearTimeout(C.streamReaderCancelTimeout),C.streamReaderCancelTimeout=null),!Q){if(C.renderTasks.size>0)return;if(X instanceof pt.RenderingCancelledException){let vt=s;X.extraDelay>0&&X.extraDelay<1e3&&(vt+=X.extraDelay),C.streamReaderCancelTimeout=setTimeout(()=>{C.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:C,reason:X,force:!0})},vt);return}}if(C.streamReader.cancel(new N.AbortException(X.message)).catch(()=>{}),C.streamReader=null,!this._transport.destroyed){for(const[vt,xt]of this._intentStates)if(xt===C){this._intentStates.delete(vt);break}this.cleanup()}}}get stats(){return this._stats}}ht=new WeakMap,st=new WeakMap,At=new WeakSet,bs=function(C=!1){if(A(this,At,Xs).call(this),!t(this,st)||this.destroyed)return!1;if(C)return _(this,ht,setTimeout(()=>{_(this,ht,null),A(this,At,bs).call(this,!1)},a)),!1;for(const{renderTasks:X,operatorList:Q}of this._intentStates.values())if(X.size>0||!Q.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),_(this,st,!1),!0},Xs=function(){t(this,ht)&&(clearTimeout(t(this,ht)),_(this,ht,null))};class m{constructor(){w(this,nt,new Set);w(this,Mt,Promise.resolve())}postMessage(C,X){const Q={data:structuredClone(C,X?{transfer:X}:null)};t(this,Mt).then(()=>{for(const vt of t(this,nt))vt.call(this,Q)})}addEventListener(C,X){t(this,nt).add(X)}removeEventListener(C,X){t(this,nt).delete(X)}terminate(){t(this,nt).clear()}}nt=new WeakMap,Mt=new WeakMap;const T={isWorkerDisabled:!1,fakeWorkerId:0};N.isNodeJS&&(T.isWorkerDisabled=!0,(Dt=x.GlobalWorkerOptions).workerSrc||(Dt.workerSrc="./pdf.worker.mjs")),T.isSameOrigin=function(ut,C){let X;try{if(X=new URL(ut),!X.origin||X.origin==="null")return!1}catch{return!1}const Q=new URL(C,X);return X.origin===Q.origin},T.createCDNWrapper=function(ut){const C=`await import("${ut}");`;return URL.createObjectURL(new Blob([C],{type:"text/javascript"}))};const Ht=class Ht{constructor({name:C=null,port:X=null,verbosity:Q=(0,N.getVerbosityLevel)()}={}){var vt;if(this.name=C,this.destroyed=!1,this.verbosity=Q,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,X){if((vt=t(Ht,Lt))!=null&&vt.has(X))throw new Error("Cannot use more than one PDFWorker per port.");(t(Ht,Lt)||_(Ht,Lt,new WeakMap)).set(X,this),this._initializeFromPort(X);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(C){this._port=C,this._messageHandler=new y.MessageHandler("main","worker",C),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!T.isWorkerDisabled&&!t(Ht,Xt,Ks)){let{workerSrc:C}=Ht;try{T.isSameOrigin(window.location.href,C)||(C=T.createCDNWrapper(new URL(C,window.location).href));const X=new Worker(C,{type:"module"}),Q=new y.MessageHandler("main","worker",X),vt=()=>{X.removeEventListener("error",xt),Q.destroy(),X.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},xt=()=>{this._webWorker||vt()};X.addEventListener("error",xt),Q.on("test",Bt=>{if(X.removeEventListener("error",xt),this.destroyed){vt();return}Bt?(this._messageHandler=Q,this._port=X,this._webWorker=X,this._readyCapability.resolve(),Q.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),Q.destroy(),X.terminate())}),Q.on("ready",Bt=>{if(X.removeEventListener("error",xt),this.destroyed){vt();return}try{Pt()}catch{this._setupFakeWorker()}});const Pt=()=>{const Bt=new Uint8Array;Q.send("test",Bt,[Bt.buffer])};Pt();return}catch{(0,N.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){T.isWorkerDisabled||((0,N.warn)("Setting up fake worker."),T.isWorkerDisabled=!0),Ht._setupFakeWorkerGlobal.then(C=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const X=new m;this._port=X;const Q=`fake${T.fakeWorkerId++}`,vt=new y.MessageHandler(Q+"_worker",Q,X);C.setup(vt,X);const xt=new y.MessageHandler(Q,Q+"_worker",X);this._messageHandler=xt,this._readyCapability.resolve(),xt.send("configure",{verbosity:this.verbosity})}).catch(C=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${C.message}".`))})}destroy(){var C;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(C=t(Ht,Lt))==null||C.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(C){var Q;if(!(C!=null&&C.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const X=(Q=t(this,Lt))==null?void 0:Q.get(C.port);if(X){if(X._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return X}return new Ht(C)}static get workerSrc(){if(x.GlobalWorkerOptions.workerSrc)return x.GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){const C=async()=>t(this,Xt,Ks)?t(this,Xt,Ks):(await import(this.workerSrc).then(async X=>(await X.__tla,X))).WorkerMessageHandler;return(0,N.shadow)(this,"_setupFakeWorkerGlobal",C())}};Lt=new WeakMap,Xt=new WeakSet,Ks=function(){var C;try{return((C=globalThis.pdfjsWorker)==null?void 0:C.WorkerMessageHandler)||null}catch{return null}},w(Ht,Xt),w(Ht,Lt);let $=Ht;class W{constructor(C,X,Q,vt,xt){w(this,ue);w(this,Jt,new Map);w(this,ne,new Map);w(this,oe,new Map);w(this,Rt,new Map);w(this,Qt,null);this.messageHandler=C,this.loadingTask=X,this.commonObjs=new ft,this.fontLoader=new H.FontLoader({ownerDocument:vt.ownerDocument,styleElement:vt.styleElement}),this._params=vt,this.canvasFactory=xt.canvasFactory,this.filterFactory=xt.filterFactory,this.cMapReaderFactory=xt.cMapReaderFactory,this.standardFontDataFactory=xt.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=Q,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return(0,N.shadow)(this,"annotationStorage",new Y.AnnotationStorage)}getRenderingIntent(C,X=N.AnnotationMode.ENABLE,Q=null,vt=!1){let xt=N.RenderingIntentFlag.DISPLAY,Pt=Y.SerializableEmpty;switch(C){case"any":xt=N.RenderingIntentFlag.ANY;break;case"display":break;case"print":xt=N.RenderingIntentFlag.PRINT;break;default:(0,N.warn)(`getRenderingIntent - invalid intent: ${C}`)}switch(X){case N.AnnotationMode.DISABLE:xt+=N.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case N.AnnotationMode.ENABLE:break;case N.AnnotationMode.ENABLE_FORMS:xt+=N.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case N.AnnotationMode.ENABLE_STORAGE:xt+=N.RenderingIntentFlag.ANNOTATIONS_STORAGE,Pt=(xt&N.RenderingIntentFlag.PRINT&&Q instanceof Y.PrintAnnotationStorage?Q:this.annotationStorage).serializable;break;default:(0,N.warn)(`getRenderingIntent - invalid annotationMode: ${X}`)}return vt&&(xt+=N.RenderingIntentFlag.OPLIST),{renderingIntent:xt,cacheKey:`${xt}_${Pt.hash}`,annotationStorageSerializable:Pt}}destroy(){var Q;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(Q=t(this,Qt))==null||Q.reject(new Error("Worker was destroyed during onPassword callback"));const C=[];for(const vt of t(this,ne).values())C.push(vt._destroy());t(this,ne).clear(),t(this,oe).clear(),t(this,Rt).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const X=this.messageHandler.sendWithPromise("Terminate",null);return C.push(X),Promise.all(C).then(()=>{var vt;this.commonObjs.clear(),this.fontLoader.clear(),t(this,Jt).clear(),this.filterFactory.destroy(),(0,j.cleanupTextLayer)(),(vt=this._networkStream)==null||vt.cancelAllRequests(new N.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:C,loadingTask:X}=this;C.on("GetReader",(Q,vt)=>{(0,N.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=xt=>{this._lastProgress={loaded:xt.loaded,total:xt.total}},vt.onPull=()=>{this._fullReader.read().then(function({value:xt,done:Pt}){if(Pt){vt.close();return}(0,N.assert)(xt instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),vt.enqueue(new Uint8Array(xt),1,[xt])}).catch(xt=>{vt.error(xt)})},vt.onCancel=xt=>{this._fullReader.cancel(xt),vt.ready.catch(Pt=>{if(!this.destroyed)throw Pt})}}),C.on("ReaderHeadersReady",Q=>{const vt=Promise.withResolvers(),xt=this._fullReader;return xt.headersReady.then(()=>{var Pt;(!xt.isStreamingSupported||!xt.isRangeSupported)&&(this._lastProgress&&((Pt=X.onProgress)==null||Pt.call(X,this._lastProgress)),xt.onProgress=Bt=>{var te;(te=X.onProgress)==null||te.call(X,{loaded:Bt.loaded,total:Bt.total})}),vt.resolve({isStreamingSupported:xt.isStreamingSupported,isRangeSupported:xt.isRangeSupported,contentLength:xt.contentLength})},vt.reject),vt.promise}),C.on("GetRangeReader",(Q,vt)=>{(0,N.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const xt=this._networkStream.getRangeReader(Q.begin,Q.end);if(!xt){vt.close();return}vt.onPull=()=>{xt.read().then(function({value:Pt,done:Bt}){if(Bt){vt.close();return}(0,N.assert)(Pt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),vt.enqueue(new Uint8Array(Pt),1,[Pt])}).catch(Pt=>{vt.error(Pt)})},vt.onCancel=Pt=>{xt.cancel(Pt),vt.ready.catch(Bt=>{if(!this.destroyed)throw Bt})}}),C.on("GetDoc",({pdfInfo:Q})=>{this._numPages=Q.numPages,this._htmlForXfa=Q.htmlForXfa,delete Q.htmlForXfa,X._capability.resolve(new i(Q,this))}),C.on("DocException",function(Q){let vt;switch(Q.name){case"PasswordException":vt=new N.PasswordException(Q.message,Q.code);break;case"InvalidPDFException":vt=new N.InvalidPDFException(Q.message);break;case"MissingPDFException":vt=new N.MissingPDFException(Q.message);break;case"UnexpectedResponseException":vt=new N.UnexpectedResponseException(Q.message,Q.status);break;case"UnknownErrorException":vt=new N.UnknownErrorException(Q.message,Q.details);break;default:(0,N.unreachable)("DocException - expected a valid Error.")}X._capability.reject(vt)}),C.on("PasswordRequest",Q=>{if(_(this,Qt,Promise.withResolvers()),X.onPassword){const vt=xt=>{xt instanceof Error?t(this,Qt).reject(xt):t(this,Qt).resolve({password:xt})};try{X.onPassword(vt,Q.code)}catch(xt){t(this,Qt).reject(xt)}}else t(this,Qt).reject(new N.PasswordException(Q.message,Q.code));return t(this,Qt).promise}),C.on("DataLoaded",Q=>{var vt;(vt=X.onProgress)==null||vt.call(X,{loaded:Q.length,total:Q.length}),this.downloadInfoCapability.resolve(Q)}),C.on("StartRenderPage",Q=>{this.destroyed||t(this,ne).get(Q.pageIndex)._startRenderPage(Q.transparency,Q.cacheKey)}),C.on("commonobj",([Q,vt,xt])=>{var Pt;if(this.destroyed||this.commonObjs.has(Q))return null;switch(vt){case"Font":const Bt=this._params;if("error"in xt){const _e=xt.error;(0,N.warn)(`Error during font loading: ${_e}`),this.commonObjs.resolve(Q,_e);break}const te=Bt.pdfBug&&((Pt=globalThis.FontInspector)!=null&&Pt.enabled)?(_e,$t)=>globalThis.FontInspector.fontAdded(_e,$t):null,de=new H.FontFaceObject(xt,{disableFontFace:Bt.disableFontFace,ignoreErrors:Bt.ignoreErrors,inspectFont:te});this.fontLoader.bind(de).catch(()=>C.sendWithPromise("FontFallback",{id:Q})).finally(()=>{!Bt.fontExtraProperties&&de.data&&(de.data=null),this.commonObjs.resolve(Q,de)});break;case"CopyLocalImage":const{imageRef:Ae}=xt;(0,N.assert)(Ae,"The imageRef must be defined.");for(const _e of t(this,ne).values())for(const[,$t]of _e.objs)if($t.ref===Ae)return $t.dataLen?(this.commonObjs.resolve(Q,structuredClone($t)),$t.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(Q,xt);break;default:throw new Error(`Got unknown common object type ${vt}`)}return null}),C.on("obj",([Q,vt,xt,Pt])=>{var te;if(this.destroyed)return;const Bt=t(this,ne).get(vt);if(!Bt.objs.has(Q)){if(Bt._intentStates.size===0){(te=Pt==null?void 0:Pt.bitmap)==null||te.close();return}switch(xt){case"Image":Bt.objs.resolve(Q,Pt),(Pt==null?void 0:Pt.dataLen)>N.MAX_IMAGE_SIZE_TO_CACHE&&(Bt._maybeCleanupAfterRender=!0);break;case"Pattern":Bt.objs.resolve(Q,Pt);break;default:throw new Error(`Got unknown object type ${xt}`)}}}),C.on("DocProgress",Q=>{var vt;this.destroyed||((vt=X.onProgress)==null||vt.call(X,{loaded:Q.loaded,total:Q.total}))}),C.on("FetchBuiltInCMap",Q=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(Q):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),C.on("FetchStandardFontData",Q=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(Q):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var Q;this.annotationStorage.size<=0&&(0,N.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:C,transfer:X}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:C,filename:((Q=this._fullReader)==null?void 0:Q.filename)??null},X).finally(()=>{this.annotationStorage.resetModified()})}getPage(C){if(!Number.isInteger(C)||C<=0||C>this._numPages)return Promise.reject(new Error("Invalid page request."));const X=C-1,Q=t(this,oe).get(X);if(Q)return Q;const vt=this.messageHandler.sendWithPromise("GetPage",{pageIndex:X}).then(xt=>{if(this.destroyed)throw new Error("Transport destroyed");xt.refStr&&t(this,Rt).set(xt.refStr,C);const Pt=new o(X,xt,this,this._params.pdfBug);return t(this,ne).set(X,Pt),Pt});return t(this,oe).set(X,vt),vt}getPageIndex(C){return S(C)?this.messageHandler.sendWithPromise("GetPageIndex",{num:C.num,gen:C.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(C,X){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:C,intent:X})}getFieldObjects(){return A(this,ue,Rs).call(this,"GetFieldObjects")}hasJSActions(){return A(this,ue,Rs).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(C){return typeof C!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:C})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return A(this,ue,Rs).call(this,"GetDocJSActions")}getPageJSActions(C){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:C})}getStructTree(C){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:C})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(C){return A(this,ue,Rs).call(this,"GetOptionalContentConfig").then(X=>new D.OptionalContentConfig(X,C))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const C="GetMetadata",X=t(this,Jt).get(C);if(X)return X;const Q=this.messageHandler.sendWithPromise(C,null).then(vt=>{var xt,Pt;return{info:vt[0],metadata:vt[1]?new F.Metadata(vt[1]):null,contentDispositionFilename:((xt=this._fullReader)==null?void 0:xt.filename)??null,contentLength:((Pt=this._fullReader)==null?void 0:Pt.contentLength)??null}});return t(this,Jt).set(C,Q),Q}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(C=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const X of t(this,ne).values())if(!X.cleanup())throw new Error(`startCleanup: Page ${X.pageNumber} is currently rendering.`);this.commonObjs.clear(),C||this.fontLoader.clear(),t(this,Jt).clear(),this.filterFactory.destroy(!0),(0,j.cleanupTextLayer)()}}cachedPageNumber(C){if(!S(C))return null;const X=C.gen===0?`${C.num}R`:`${C.num}R${C.gen}`;return t(this,Rt).get(X)??null}get loadingParams(){const{disableAutoFetch:C,enableXfa:X}=this._params;return(0,N.shadow)(this,"loadingParams",{disableAutoFetch:C,enableXfa:X})}}Jt=new WeakMap,ne=new WeakMap,oe=new WeakMap,Rt=new WeakMap,Qt=new WeakMap,ue=new WeakSet,Rs=function(C,X=null){const Q=t(this,Jt).get(C);if(Q)return Q;const vt=this.messageHandler.sendWithPromise(C,X);return t(this,Jt).set(C,vt),vt};const tt=Symbol("INITIAL_DATA");class ft{constructor(){w(this,le);w(this,Ut,Object.create(null))}get(C,X=null){if(X){const vt=A(this,le,Si).call(this,C);return vt.promise.then(()=>X(vt.data)),null}const Q=t(this,Ut)[C];if(!Q||Q.data===tt)throw new Error(`Requesting object that isn't resolved yet ${C}.`);return Q.data}has(C){const X=t(this,Ut)[C];return!!X&&X.data!==tt}resolve(C,X=null){const Q=A(this,le,Si).call(this,C);Q.data=X,Q.resolve()}clear(){var C;for(const X in t(this,Ut)){const{data:Q}=t(this,Ut)[X];(C=Q==null?void 0:Q.bitmap)==null||C.close()}_(this,Ut,Object.create(null))}*[Symbol.iterator](){for(const C in t(this,Ut)){const{data:X}=t(this,Ut)[C];X!==tt&&(yield[C,X])}}}Ut=new WeakMap,le=new WeakSet,Si=function(C){var X;return(X=t(this,Ut))[C]||(X[C]={...Promise.withResolvers(),data:tt})};class it{constructor(C){w(this,ce,null);_(this,ce,C),this.onContinue=null}get promise(){return t(this,ce).capability.promise}cancel(C=0){t(this,ce).cancel(null,C)}get separateAnnots(){const{separateAnnots:C}=t(this,ce).operatorList;if(!C)return!1;const{annotationCanvasMap:X}=t(this,ce);return C.form||C.canvas&&(X==null?void 0:X.size)>0}}ce=new WeakMap;const lt=class lt{constructor({callback:C,params:X,objs:Q,commonObjs:vt,annotationCanvasMap:xt,operatorList:Pt,pageIndex:Bt,canvasFactory:te,filterFactory:de,useRequestAnimationFrame:Ae=!1,pdfBug:_e=!1,pageColors:$t=null}){this.callback=C,this.params=X,this.objs=Q,this.commonObjs=vt,this.annotationCanvasMap=xt,this.operatorListIdx=null,this.operatorList=Pt,this._pageIndex=Bt,this.canvasFactory=te,this.filterFactory=de,this._pdfBug=_e,this.pageColors=$t,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Ae===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new it(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=X.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:C=!1,optionalContentConfig:X}){var Bt,te;if(this.cancelled)return;if(this._canvas){if(t(lt,Zt).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(lt,Zt).add(this._canvas)}this._pdfBug&&((Bt=globalThis.StepperManager)!=null&&Bt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:Q,viewport:vt,transform:xt,background:Pt}=this.params;this.gfx=new k.CanvasGraphics(Q,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:X},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:xt,viewport:vt,transparency:C,background:Pt}),this.operatorListIdx=0,this.graphicsReady=!0,(te=this.graphicsReadyCallback)==null||te.call(this)}cancel(C=null,X=0){var Q;this.running=!1,this.cancelled=!0,(Q=this.gfx)==null||Q.endDrawing(),t(lt,Zt).delete(this._canvas),this.callback(C||new pt.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,X))}operatorListChanged(){var C;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(C=this.stepper)==null||C.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(lt,Zt).delete(this._canvas),this.callback())))}};Zt=new WeakMap,w(lt,Zt,new WeakSet);let wt=lt;const Nt="4.2.67",Gt="49b388101";J()}catch(Ot){J(Ot)}})},583:(se,Vt,dt)=>{dt.d(Vt,{BaseCMapReaderFactory:()=>Y,BaseCanvasFactory:()=>N,BaseFilterFactory:()=>J,BaseSVGFactory:()=>H,BaseStandardFontDataFactory:()=>pt});var d=dt(292);class J{constructor(){this.constructor===J&&(0,d.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(k){return"none"}addHCMFilter(k,j){return"none"}addHighlightHCMFilter(k,j,x,y,F){return"none"}destroy(k=!1){}}class N{constructor(){this.constructor===N&&(0,d.unreachable)("Cannot initialize BaseCanvasFactory.")}create(k,j){if(k<=0||j<=0)throw new Error("Invalid canvas size");const x=this._createCanvas(k,j);return{canvas:x,context:x.getContext("2d")}}reset(k,j,x){if(!k.canvas)throw new Error("Canvas is not specified");if(j<=0||x<=0)throw new Error("Invalid canvas size");k.canvas.width=j,k.canvas.height=x}destroy(k){if(!k.canvas)throw new Error("Canvas is not specified");k.canvas.width=0,k.canvas.height=0,k.canvas=null,k.context=null}_createCanvas(k,j){(0,d.unreachable)("Abstract method `_createCanvas` called.")}}class Y{constructor({baseUrl:k=null,isCompressed:j=!0}){this.constructor===Y&&(0,d.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=k,this.isCompressed=j}async fetch({name:k}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!k)throw new Error("CMap name must be specified.");const j=this.baseUrl+k+(this.isCompressed?".bcmap":""),x=this.isCompressed?d.CMapCompressionType.BINARY:d.CMapCompressionType.NONE;return this._fetchData(j,x).catch(y=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${j}`)})}_fetchData(k,j){(0,d.unreachable)("Abstract method `_fetchData` called.")}}class pt{constructor({baseUrl:k=null}){this.constructor===pt&&(0,d.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=k}async fetch({filename:k}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!k)throw new Error("Font filename must be specified.");const j=`${this.baseUrl}${k}`;return this._fetchData(j).catch(x=>{throw new Error(`Unable to load font data at: ${j}`)})}_fetchData(k){(0,d.unreachable)("Abstract method `_fetchData` called.")}}class H{constructor(){this.constructor===H&&(0,d.unreachable)("Cannot initialize BaseSVGFactory.")}create(k,j,x=!1){if(k<=0||j<=0)throw new Error("Invalid SVG dimensions");const y=this._createSVG("svg:svg");return y.setAttribute("version","1.1"),x||(y.setAttribute("width",`${k}px`),y.setAttribute("height",`${j}px`)),y.setAttribute("preserveAspectRatio","none"),y.setAttribute("viewBox",`0 0 ${k} ${j}`),y}createElement(k){if(typeof k!="string")throw new Error("Invalid SVG element type");return this._createSVG(k)}_createSVG(k){(0,d.unreachable)("Abstract method `_createSVG` called.")}}},923:(se,Vt,dt)=>{var Zt,Ci,Ti;dt.d(Vt,{CanvasGraphics:()=>ee});var d=dt(292),J=dt(419);const N={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Y(S,n){if(!n)return;const s=n[2]-n[0],a=n[3]-n[1],h=new Path2D;h.rect(n[0],n[1],s,a),S.clip(h)}class pt{constructor(){this.constructor===pt&&(0,d.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,d.unreachable)("Abstract method `getPattern` called.")}}class H extends pt{constructor(n){super(),this._type=n[1],this._bbox=n[2],this._colorStops=n[3],this._p0=n[4],this._p1=n[5],this._r0=n[6],this._r1=n[7],this.matrix=null}_createGradient(n){let s;this._type==="axial"?s=n.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(s=n.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const a of this._colorStops)s.addColorStop(a[0],a[1]);return s}getPattern(n,s,a,h){let l;if(h===N.STROKE||h===N.FILL){const g=s.current.getClippedPathBoundingBox(h,(0,J.getCurrentTransform)(n))||[0,0,0,0],u=Math.ceil(g[2]-g[0])||1,p=Math.ceil(g[3]-g[1])||1,M=s.cachedCanvases.getCanvas("pattern",u,p,!0),e=M.context;e.clearRect(0,0,e.canvas.width,e.canvas.height),e.beginPath(),e.rect(0,0,e.canvas.width,e.canvas.height),e.translate(-g[0],-g[1]),a=d.Util.transform(a,[1,0,0,1,g[0],g[1]]),e.transform(...s.baseTransform),this.matrix&&e.transform(...this.matrix),Y(e,this._bbox),e.fillStyle=this._createGradient(e),e.fill(),l=n.createPattern(M.canvas,"no-repeat");const i=new DOMMatrix(a);l.setTransform(i)}else Y(n,this._bbox),l=this._createGradient(n);return l}}function I(S,n,s,a,h,l,g,u){const p=n.coords,M=n.colors,e=S.data,i=S.width*4;let o;p[s+1]>p[a+1]&&(o=s,s=a,a=o,o=l,l=g,g=o),p[a+1]>p[h+1]&&(o=a,a=h,h=o,o=g,g=u,u=o),p[s+1]>p[a+1]&&(o=s,s=a,a=o,o=l,l=g,g=o);const m=(p[s]+n.offsetX)*n.scaleX,T=(p[s+1]+n.offsetY)*n.scaleY,$=(p[a]+n.offsetX)*n.scaleX,W=(p[a+1]+n.offsetY)*n.scaleY,tt=(p[h]+n.offsetX)*n.scaleX,ft=(p[h+1]+n.offsetY)*n.scaleY;if(T>=ft)return;const it=M[l],wt=M[l+1],Nt=M[l+2],Gt=M[g],Wt=M[g+1],Ht=M[g+2],lt=M[u],ut=M[u+1],C=M[u+2],X=Math.round(T),Q=Math.round(ft);let vt,xt,Pt,Bt,te,de,Ae,_e;for(let $t=X;$t<=Q;$t++){if($t<W){const q=$t<T?0:(T-$t)/(T-W);vt=m-(m-$)*q,xt=it-(it-Gt)*q,Pt=wt-(wt-Wt)*q,Bt=Nt-(Nt-Ht)*q}else{let q;$t>ft?q=1:W===ft?q=0:q=(W-$t)/(W-ft),vt=$-($-tt)*q,xt=Gt-(Gt-lt)*q,Pt=Wt-(Wt-ut)*q,Bt=Ht-(Ht-C)*q}let v;$t<T?v=0:$t>ft?v=1:v=(T-$t)/(T-ft),te=m-(m-tt)*v,de=it-(it-lt)*v,Ae=wt-(wt-ut)*v,_e=Nt-(Nt-C)*v;const f=Math.round(Math.min(vt,te)),E=Math.round(Math.max(vt,te));let z=i*$t+f*4;for(let q=f;q<=E;q++)v=(vt-q)/(vt-te),v<0?v=0:v>1&&(v=1),e[z++]=xt-(xt-de)*v|0,e[z++]=Pt-(Pt-Ae)*v|0,e[z++]=Bt-(Bt-_e)*v|0,e[z++]=255}}function k(S,n,s){const a=n.coords,h=n.colors;let l,g;switch(n.type){case"lattice":const u=n.verticesPerRow,p=Math.floor(a.length/u)-1,M=u-1;for(l=0;l<p;l++){let e=l*u;for(let i=0;i<M;i++,e++)I(S,s,a[e],a[e+1],a[e+u],h[e],h[e+1],h[e+u]),I(S,s,a[e+u+1],a[e+1],a[e+u],h[e+u+1],h[e+1],h[e+u])}break;case"triangles":for(l=0,g=a.length;l<g;l+=3)I(S,s,a[l],a[l+1],a[l+2],h[l],h[l+1],h[l+2]);break;default:throw new Error("illegal figure")}}class j extends pt{constructor(n){super(),this._coords=n[2],this._colors=n[3],this._figures=n[4],this._bounds=n[5],this._bbox=n[7],this._background=n[8],this.matrix=null}_createMeshCanvas(n,s,a){const h=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),g=Math.ceil(this._bounds[2])-h,u=Math.ceil(this._bounds[3])-l,p=Math.min(Math.ceil(Math.abs(g*n[0]*1.1)),3e3),M=Math.min(Math.ceil(Math.abs(u*n[1]*1.1)),3e3),e=g/p,i=u/M,o={coords:this._coords,colors:this._colors,offsetX:-h,offsetY:-l,scaleX:1/e,scaleY:1/i},m=p+2*2,T=M+2*2,$=a.getCanvas("mesh",m,T,!1),W=$.context,tt=W.createImageData(p,M);if(s){const ft=tt.data;for(let it=0,wt=ft.length;it<wt;it+=4)ft[it]=s[0],ft[it+1]=s[1],ft[it+2]=s[2],ft[it+3]=255}for(const ft of this._figures)k(tt,ft,o);return W.putImageData(tt,2,2),{canvas:$.canvas,offsetX:h-2*e,offsetY:l-2*i,scaleX:e,scaleY:i}}getPattern(n,s,a,h){Y(n,this._bbox);let l;if(h===N.SHADING)l=d.Util.singularValueDecompose2dScale((0,J.getCurrentTransform)(n));else if(l=d.Util.singularValueDecompose2dScale(s.baseTransform),this.matrix){const u=d.Util.singularValueDecompose2dScale(this.matrix);l=[l[0]*u[0],l[1]*u[1]]}const g=this._createMeshCanvas(l,h===N.SHADING?null:this._background,s.cachedCanvases);return h!==N.SHADING&&(n.setTransform(...s.baseTransform),this.matrix&&n.transform(...this.matrix)),n.translate(g.offsetX,g.offsetY),n.scale(g.scaleX,g.scaleY),n.createPattern(g.canvas,"no-repeat")}}class x extends pt{getPattern(){return"hotpink"}}function y(S){switch(S[0]){case"RadialAxial":return new H(S);case"Mesh":return new j(S);case"Dummy":return new x}throw new Error(`Unknown IR type: ${S[0]}`)}const F={COLORED:1,UNCOLORED:2},ce=class ce{constructor(n,s,a,h,l){this.operatorList=n[2],this.matrix=n[3]||[1,0,0,1,0,0],this.bbox=n[4],this.xstep=n[5],this.ystep=n[6],this.paintType=n[7],this.tilingType=n[8],this.color=s,this.ctx=a,this.canvasGraphicsFactory=h,this.baseTransform=l}createPatternCanvas(n){const s=this.operatorList,a=this.bbox,h=this.xstep,l=this.ystep,g=this.paintType,u=this.tilingType,p=this.color,M=this.canvasGraphicsFactory;(0,d.info)("TilingType: "+u);const e=a[0],i=a[1],o=a[2],m=a[3],T=d.Util.singularValueDecompose2dScale(this.matrix),$=d.Util.singularValueDecompose2dScale(this.baseTransform),W=[T[0]*$[0],T[1]*$[1]],tt=this.getSizeAndScale(h,this.ctx.canvas.width,W[0]),ft=this.getSizeAndScale(l,this.ctx.canvas.height,W[1]),it=n.cachedCanvases.getCanvas("pattern",tt.size,ft.size,!0),wt=it.context,Nt=M.createCanvasGraphics(wt);Nt.groupLevel=n.groupLevel,this.setFillAndStrokeStyleToContext(Nt,g,p);let Gt=e,Wt=i,Ht=o,lt=m;return e<0&&(Gt=0,Ht+=Math.abs(e)),i<0&&(Wt=0,lt+=Math.abs(i)),wt.translate(-(tt.scale*Gt),-(ft.scale*Wt)),Nt.transform(tt.scale,0,0,ft.scale,0,0),wt.save(),this.clipBbox(Nt,Gt,Wt,Ht,lt),Nt.baseTransform=(0,J.getCurrentTransform)(Nt.ctx),Nt.executeOperatorList(s),Nt.endDrawing(),{canvas:it.canvas,scaleX:tt.scale,scaleY:ft.scale,offsetX:Gt,offsetY:Wt}}getSizeAndScale(n,s,a){n=Math.abs(n);const h=Math.max(ce.MAX_PATTERN_SIZE,s);let l=Math.ceil(n*a);return l>=h?l=h:a=l/n,{scale:a,size:l}}clipBbox(n,s,a,h,l){const g=h-s,u=l-a;n.ctx.rect(s,a,g,u),n.current.updateRectMinMax((0,J.getCurrentTransform)(n.ctx),[s,a,h,l]),n.clip(),n.endPath()}setFillAndStrokeStyleToContext(n,s,a){const h=n.ctx,l=n.current;switch(s){case F.COLORED:const g=this.ctx;h.fillStyle=g.fillStyle,h.strokeStyle=g.strokeStyle,l.fillColor=g.fillStyle,l.strokeColor=g.strokeStyle;break;case F.UNCOLORED:const u=d.Util.makeHexColor(a[0],a[1],a[2]);h.fillStyle=u,h.strokeStyle=u,l.fillColor=u,l.strokeColor=u;break;default:throw new d.FormatError(`Unsupported paint type: ${s}`)}}getPattern(n,s,a,h){let l=a;h!==N.SHADING&&(l=d.Util.transform(l,s.baseTransform),this.matrix&&(l=d.Util.transform(l,this.matrix)));const g=this.createPatternCanvas(s);let u=new DOMMatrix(l);u=u.translate(g.offsetX,g.offsetY),u=u.scale(1/g.scaleX,1/g.scaleY);const p=n.createPattern(g.canvas,"repeat");return p.setTransform(u),p}};he(ce,"MAX_PATTERN_SIZE",3e3);let D=ce;function Z({src:S,srcPos:n=0,dest:s,width:a,height:h,nonBlackColor:l=4294967295,inverseDecode:g=!1}){const u=d.FeatureTest.isLittleEndian?4278190080:255,[p,M]=g?[l,u]:[u,l],e=a>>3,i=a&7,o=S.length;s=new Uint32Array(s.buffer);let m=0;for(let T=0;T<h;T++){for(const W=n+e;n<W;n++){const tt=n<o?S[n]:255;s[m++]=tt&128?M:p,s[m++]=tt&64?M:p,s[m++]=tt&32?M:p,s[m++]=tt&16?M:p,s[m++]=tt&8?M:p,s[m++]=tt&4?M:p,s[m++]=tt&2?M:p,s[m++]=tt&1?M:p}if(i===0)continue;const $=n<o?S[n++]:255;for(let W=0;W<i;W++)s[m++]=$&1<<7-W?M:p}return{srcPos:n,destPos:m}}const U=16,K=100,P=4096,B=15,R=10,L=1e3,ht=16;function st(S,n){if(S._removeMirroring)throw new Error("Context is already forwarding operations.");S.__originalSave=S.save,S.__originalRestore=S.restore,S.__originalRotate=S.rotate,S.__originalScale=S.scale,S.__originalTranslate=S.translate,S.__originalTransform=S.transform,S.__originalSetTransform=S.setTransform,S.__originalResetTransform=S.resetTransform,S.__originalClip=S.clip,S.__originalMoveTo=S.moveTo,S.__originalLineTo=S.lineTo,S.__originalBezierCurveTo=S.bezierCurveTo,S.__originalRect=S.rect,S.__originalClosePath=S.closePath,S.__originalBeginPath=S.beginPath,S._removeMirroring=()=>{S.save=S.__originalSave,S.restore=S.__originalRestore,S.rotate=S.__originalRotate,S.scale=S.__originalScale,S.translate=S.__originalTranslate,S.transform=S.__originalTransform,S.setTransform=S.__originalSetTransform,S.resetTransform=S.__originalResetTransform,S.clip=S.__originalClip,S.moveTo=S.__originalMoveTo,S.lineTo=S.__originalLineTo,S.bezierCurveTo=S.__originalBezierCurveTo,S.rect=S.__originalRect,S.closePath=S.__originalClosePath,S.beginPath=S.__originalBeginPath,delete S._removeMirroring},S.save=function(){n.save(),this.__originalSave()},S.restore=function(){n.restore(),this.__originalRestore()},S.translate=function(s,a){n.translate(s,a),this.__originalTranslate(s,a)},S.scale=function(s,a){n.scale(s,a),this.__originalScale(s,a)},S.transform=function(s,a,h,l,g,u){n.transform(s,a,h,l,g,u),this.__originalTransform(s,a,h,l,g,u)},S.setTransform=function(s,a,h,l,g,u){n.setTransform(s,a,h,l,g,u),this.__originalSetTransform(s,a,h,l,g,u)},S.resetTransform=function(){n.resetTransform(),this.__originalResetTransform()},S.rotate=function(s){n.rotate(s),this.__originalRotate(s)},S.clip=function(s){n.clip(s),this.__originalClip(s)},S.moveTo=function(s,a){n.moveTo(s,a),this.__originalMoveTo(s,a)},S.lineTo=function(s,a){n.lineTo(s,a),this.__originalLineTo(s,a)},S.bezierCurveTo=function(s,a,h,l,g,u){n.bezierCurveTo(s,a,h,l,g,u),this.__originalBezierCurveTo(s,a,h,l,g,u)},S.rect=function(s,a,h,l){n.rect(s,a,h,l),this.__originalRect(s,a,h,l)},S.closePath=function(){n.closePath(),this.__originalClosePath()},S.beginPath=function(){n.beginPath(),this.__originalBeginPath()}}class At{constructor(n){this.canvasFactory=n,this.cache=Object.create(null)}getCanvas(n,s,a){let h;return this.cache[n]!==void 0?(h=this.cache[n],this.canvasFactory.reset(h,s,a)):(h=this.canvasFactory.create(s,a),this.cache[n]=h),h}delete(n){delete this.cache[n]}clear(){for(const n in this.cache){const s=this.cache[n];this.canvasFactory.destroy(s),delete this.cache[n]}}}function Tt(S,n,s,a,h,l,g,u,p,M){const[e,i,o,m,T,$]=(0,J.getCurrentTransform)(S);if(i===0&&o===0){const ft=g*e+T,it=Math.round(ft),wt=u*m+$,Nt=Math.round(wt),Gt=(g+p)*e+T,Wt=Math.abs(Math.round(Gt)-it)||1,Ht=(u+M)*m+$,lt=Math.abs(Math.round(Ht)-Nt)||1;return S.setTransform(Math.sign(e),0,0,Math.sign(m),it,Nt),S.drawImage(n,s,a,h,l,0,0,Wt,lt),S.setTransform(e,i,o,m,T,$),[Wt,lt]}if(e===0&&m===0){const ft=u*o+T,it=Math.round(ft),wt=g*i+$,Nt=Math.round(wt),Gt=(u+M)*o+T,Wt=Math.abs(Math.round(Gt)-it)||1,Ht=(g+p)*i+$,lt=Math.abs(Math.round(Ht)-Nt)||1;return S.setTransform(0,Math.sign(i),Math.sign(o),0,it,Nt),S.drawImage(n,s,a,h,l,0,0,lt,Wt),S.setTransform(e,i,o,m,T,$),[lt,Wt]}S.drawImage(n,s,a,h,l,g,u,p,M);const W=Math.hypot(e,i),tt=Math.hypot(o,m);return[W*p,tt*M]}function ot(S){const{width:n,height:s}=S;if(n>L||s>L)return null;const a=1e3,h=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),l=n+1;let g=new Uint8Array(l*(s+1)),u,p,M;const e=n+7&-8;let i=new Uint8Array(e*s),o=0;for(const W of S.data){let tt=128;for(;tt>0;)i[o++]=W&tt?0:255,tt>>=1}let m=0;for(o=0,i[o]!==0&&(g[0]=1,++m),p=1;p<n;p++)i[o]!==i[o+1]&&(g[p]=i[o]?2:1,++m),o++;for(i[o]!==0&&(g[p]=2,++m),u=1;u<s;u++){o=u*e,M=u*l,i[o-e]!==i[o]&&(g[M]=i[o]?1:8,++m);let W=(i[o]?4:0)+(i[o-e]?8:0);for(p=1;p<n;p++)W=(W>>2)+(i[o+1]?4:0)+(i[o-e+1]?8:0),h[W]&&(g[M+p]=h[W],++m),o++;if(i[o-e]!==i[o]&&(g[M+p]=i[o]?2:4,++m),m>a)return null}for(o=e*(s-1),M=u*l,i[o]!==0&&(g[M]=8,++m),p=1;p<n;p++)i[o]!==i[o+1]&&(g[M+p]=i[o]?4:8,++m),o++;if(i[o]!==0&&(g[M+p]=4,++m),m>a)return null;const T=new Int32Array([0,l,-1,0,-l,0,0,0,1]),$=new Path2D;for(u=0;m&&u<=s;u++){let W=u*l;const tt=W+n;for(;W<tt&&!g[W];)W++;if(W===tt)continue;$.moveTo(W%l,u);const ft=W;let it=g[W];do{const wt=T[it];do W+=wt;while(!g[W]);const Nt=g[W];Nt!==5&&Nt!==10?(it=Nt,g[W]=0):(it=Nt&51*it>>4,g[W]&=it>>2|it<<2),$.lineTo(W%l,W/l|0),g[W]||--m}while(ft!==W);--u}return i=null,g=null,function(W){W.save(),W.scale(1/n,-1/s),W.translate(0,-s),W.fill($),W.beginPath(),W.restore()}}class nt{constructor(n,s){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=d.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=d.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=d.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,n,s])}clone(){const n=Object.create(this);return n.clipBox=this.clipBox.slice(),n}setCurrentPoint(n,s){this.x=n,this.y=s}updatePathMinMax(n,s,a){[s,a]=d.Util.applyTransform([s,a],n),this.minX=Math.min(this.minX,s),this.minY=Math.min(this.minY,a),this.maxX=Math.max(this.maxX,s),this.maxY=Math.max(this.maxY,a)}updateRectMinMax(n,s){const a=d.Util.applyTransform(s,n),h=d.Util.applyTransform(s.slice(2),n),l=d.Util.applyTransform([s[0],s[3]],n),g=d.Util.applyTransform([s[2],s[1]],n);this.minX=Math.min(this.minX,a[0],h[0],l[0],g[0]),this.minY=Math.min(this.minY,a[1],h[1],l[1],g[1]),this.maxX=Math.max(this.maxX,a[0],h[0],l[0],g[0]),this.maxY=Math.max(this.maxY,a[1],h[1],l[1],g[1])}updateScalingPathMinMax(n,s){d.Util.scaleMinMax(n,s),this.minX=Math.min(this.minX,s[0]),this.minY=Math.min(this.minY,s[1]),this.maxX=Math.max(this.maxX,s[2]),this.maxY=Math.max(this.maxY,s[3])}updateCurvePathMinMax(n,s,a,h,l,g,u,p,M,e){const i=d.Util.bezierBoundingBox(s,a,h,l,g,u,p,M,e);e||this.updateRectMinMax(n,i)}getPathBoundingBox(n=N.FILL,s=null){const a=[this.minX,this.minY,this.maxX,this.maxY];if(n===N.STROKE){s||(0,d.unreachable)("Stroke bounding box must include transform.");const h=d.Util.singularValueDecompose2dScale(s),l=h[0]*this.lineWidth/2,g=h[1]*this.lineWidth/2;a[0]-=l,a[1]-=g,a[2]+=l,a[3]+=g}return a}updateClipFromPath(){const n=d.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(n||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(n){this.clipBox=n,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(n=N.FILL,s=null){return d.Util.intersect(this.clipBox,this.getPathBoundingBox(n,s))}}function Mt(S,n){if(typeof ImageData<"u"&&n instanceof ImageData){S.putImageData(n,0,0);return}const s=n.height,a=n.width,h=s%ht,l=(s-h)/ht,g=h===0?l:l+1,u=S.createImageData(a,ht);let p=0,M;const e=n.data,i=u.data;let o,m,T,$;if(n.kind===d.ImageKind.GRAYSCALE_1BPP){const W=e.byteLength,tt=new Uint32Array(i.buffer,0,i.byteLength>>2),ft=tt.length,it=a+7>>3,wt=4294967295,Nt=d.FeatureTest.isLittleEndian?4278190080:255;for(o=0;o<g;o++){for(T=o<l?ht:h,M=0,m=0;m<T;m++){const Gt=W-p;let Wt=0;const Ht=Gt>it?a:Gt*8-7,lt=Ht&-8;let ut=0,C=0;for(;Wt<lt;Wt+=8)C=e[p++],tt[M++]=C&128?wt:Nt,tt[M++]=C&64?wt:Nt,tt[M++]=C&32?wt:Nt,tt[M++]=C&16?wt:Nt,tt[M++]=C&8?wt:Nt,tt[M++]=C&4?wt:Nt,tt[M++]=C&2?wt:Nt,tt[M++]=C&1?wt:Nt;for(;Wt<Ht;Wt++)ut===0&&(C=e[p++],ut=128),tt[M++]=C&ut?wt:Nt,ut>>=1}for(;M<ft;)tt[M++]=0;S.putImageData(u,0,o*ht)}}else if(n.kind===d.ImageKind.RGBA_32BPP){for(m=0,$=a*ht*4,o=0;o<l;o++)i.set(e.subarray(p,p+$)),p+=$,S.putImageData(u,0,m),m+=ht;o<g&&($=a*h*4,i.set(e.subarray(p,p+$)),S.putImageData(u,0,m))}else if(n.kind===d.ImageKind.RGB_24BPP)for(T=ht,$=a*T,o=0;o<g;o++){for(o>=l&&(T=h,$=a*T),M=0,m=$;m--;)i[M++]=e[p++],i[M++]=e[p++],i[M++]=e[p++],i[M++]=255;S.putImageData(u,0,o*ht)}else throw new Error(`bad image kind: ${n.kind}`)}function Dt(S,n){if(n.bitmap){S.drawImage(n.bitmap,0,0);return}const s=n.height,a=n.width,h=s%ht,l=(s-h)/ht,g=h===0?l:l+1,u=S.createImageData(a,ht);let p=0;const M=n.data,e=u.data;for(let i=0;i<g;i++){const o=i<l?ht:h;({srcPos:p}=Z({src:M,srcPos:p,dest:e,width:a,height:o,nonBlackColor:0})),S.putImageData(u,0,i*ht)}}function Lt(S,n){const s=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const a of s)S[a]!==void 0&&(n[a]=S[a]);S.setLineDash!==void 0&&(n.setLineDash(S.getLineDash()),n.lineDashOffset=S.lineDashOffset)}function Xt(S){if(S.strokeStyle=S.fillStyle="#000000",S.fillRule="nonzero",S.globalAlpha=1,S.lineWidth=1,S.lineCap="butt",S.lineJoin="miter",S.miterLimit=10,S.globalCompositeOperation="source-over",S.font="10px sans-serif",S.setLineDash!==void 0&&(S.setLineDash([]),S.lineDashOffset=0),!d.isNodeJS){const{filter:n}=S;n!=="none"&&n!==""&&(S.filter="none")}}function ae(S,n,s,a){const h=S.length;for(let l=3;l<h;l+=4){const g=S[l];if(g===0)S[l-3]=n,S[l-2]=s,S[l-1]=a;else if(g<255){const u=255-g;S[l-3]=S[l-3]*g+n*u>>8,S[l-2]=S[l-2]*g+s*u>>8,S[l-1]=S[l-1]*g+a*u>>8}}}function Jt(S,n,s){const a=S.length,h=1/255;for(let l=3;l<a;l+=4){const g=s?s[S[l]]:S[l];n[l]=n[l]*g*h|0}}function ne(S,n,s){const a=S.length;for(let h=3;h<a;h+=4){const l=S[h-3]*77+S[h-2]*152+S[h-1]*28;n[h]=s?n[h]*s[l>>8]>>8:n[h]*l>>16}}function oe(S,n,s,a,h,l,g,u,p,M,e){const i=!!l,o=i?l[0]:0,m=i?l[1]:0,T=i?l[2]:0,$=h==="Luminosity"?ne:Jt,W=Math.min(a,Math.ceil(1048576/s));for(let tt=0;tt<a;tt+=W){const ft=Math.min(W,a-tt),it=S.getImageData(u-M,tt+(p-e),s,ft),wt=n.getImageData(u,tt+p,s,ft);i&&ae(it.data,o,m,T),$(it.data,wt.data,g),n.putImageData(wt,u,tt+p)}}function Rt(S,n,s,a){const h=a[0],l=a[1],g=a[2]-h,u=a[3]-l;g===0||u===0||(oe(n.context,s,g,u,n.subtype,n.backdrop,n.transferMap,h,l,n.offsetX,n.offsetY),S.save(),S.globalAlpha=1,S.globalCompositeOperation="source-over",S.setTransform(1,0,0,1,0,0),S.drawImage(s.canvas,0,0),S.restore())}function Qt(S,n){if(n)return!0;const s=d.Util.singularValueDecompose2dScale(S);s[0]=Math.fround(s[0]),s[1]=Math.fround(s[1]);const a=Math.fround((globalThis.devicePixelRatio||1)*J.PixelsPerInch.PDF_TO_CSS_UNITS);return s[0]<=a&&s[1]<=a}const ue=["butt","round","square"],be=["miter","round","bevel"],Ut={},le={},gt=class gt{constructor(n,s,a,h,l,{optionalContentConfig:g,markedContentStack:u=null},p,M){w(this,Zt);this.ctx=n,this.current=new nt(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=s,this.objs=a,this.canvasFactory=h,this.filterFactory=l,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=g,this.cachedCanvases=new At(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=p,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=M,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(n,s=null){return typeof n=="string"?n.startsWith("g_")?this.commonObjs.get(n):this.objs.get(n):s}beginDrawing({transform:n,viewport:s,transparency:a=!1,background:h=null}){const l=this.ctx.canvas.width,g=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=h||"#ffffff",this.ctx.fillRect(0,0,l,g),this.ctx.fillStyle=u,a){const p=this.cachedCanvases.getCanvas("transparent",l,g);this.compositeCtx=this.ctx,this.transparentCanvas=p.canvas,this.ctx=p.context,this.ctx.save(),this.ctx.transform(...(0,J.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Xt(this.ctx),n&&(this.ctx.transform(...n),this.outputScaleX=n[0],this.outputScaleY=n[0]),this.ctx.transform(...s.transform),this.viewportScale=s.scale,this.baseTransform=(0,J.getCurrentTransform)(this.ctx)}executeOperatorList(n,s,a,h){const l=n.argsArray,g=n.fnArray;let u=s||0;const p=l.length;if(p===u)return u;const M=p-u>R&&typeof a=="function",e=M?Date.now()+B:0;let i=0;const o=this.commonObjs,m=this.objs;let T;for(;;){if(h!==void 0&&u===h.nextBreakPoint)return h.breakIt(u,a),u;if(T=g[u],T!==d.OPS.dependency)this[T].apply(this,l[u]);else for(const $ of l[u]){const W=$.startsWith("g_")?o:m;if(!W.has($))return W.get($,a),u}if(u++,u===p)return u;if(M&&++i>R){if(Date.now()>e)return a(),u;i=0}}}endDrawing(){A(this,Zt,Ci).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const n of this._cachedBitmapsMap.values()){for(const s of n.values())typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement&&(s.width=s.height=0);n.clear()}this._cachedBitmapsMap.clear(),A(this,Zt,Ti).call(this)}_scaleImage(n,s){const a=n.width,h=n.height;let l=Math.max(Math.hypot(s[0],s[1]),1),g=Math.max(Math.hypot(s[2],s[3]),1),u=a,p=h,M="prescale1",e,i;for(;l>2&&u>1||g>2&&p>1;){let o=u,m=p;l>2&&u>1&&(o=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/o),g>2&&p>1&&(m=p>=16384?Math.floor(p/2)-1||1:Math.ceil(p)/2,g/=p/m),e=this.cachedCanvases.getCanvas(M,o,m),i=e.context,i.clearRect(0,0,o,m),i.drawImage(n,0,0,u,p,0,0,o,m),n=e.canvas,u=o,p=m,M=M==="prescale1"?"prescale2":"prescale1"}return{img:n,paintWidth:u,paintHeight:p}}_createMaskCanvas(n){const s=this.ctx,{width:a,height:h}=n,l=this.current.fillColor,g=this.current.patternFill,u=(0,J.getCurrentTransform)(s);let p,M,e,i;if((n.bitmap||n.data)&&n.count>1){const Ht=n.bitmap||n.data.buffer;M=JSON.stringify(g?u:[u.slice(0,4),l]),p=this._cachedBitmapsMap.get(Ht),p||(p=new Map,this._cachedBitmapsMap.set(Ht,p));const lt=p.get(M);if(lt&&!g){const ut=Math.round(Math.min(u[0],u[2])+u[4]),C=Math.round(Math.min(u[1],u[3])+u[5]);return{canvas:lt,offsetX:ut,offsetY:C}}e=lt}e||(i=this.cachedCanvases.getCanvas("maskCanvas",a,h),Dt(i.context,n));let o=d.Util.transform(u,[1/a,0,0,-1/h,0,0]);o=d.Util.transform(o,[1,0,0,1,0,-h]);const[m,T,$,W]=d.Util.getAxialAlignedBoundingBox([0,0,a,h],o),tt=Math.round($-m)||1,ft=Math.round(W-T)||1,it=this.cachedCanvases.getCanvas("fillCanvas",tt,ft),wt=it.context,Nt=m,Gt=T;wt.translate(-Nt,-Gt),wt.transform(...o),e||(e=this._scaleImage(i.canvas,(0,J.getCurrentTransformInverse)(wt)),e=e.img,p&&g&&p.set(M,e)),wt.imageSmoothingEnabled=Qt((0,J.getCurrentTransform)(wt),n.interpolate),Tt(wt,e,0,0,e.width,e.height,0,0,a,h),wt.globalCompositeOperation="source-in";const Wt=d.Util.transform((0,J.getCurrentTransformInverse)(wt),[1,0,0,1,-Nt,-Gt]);return wt.fillStyle=g?l.getPattern(s,this,Wt,N.FILL):l,wt.fillRect(0,0,a,h),p&&!g&&(this.cachedCanvases.delete("fillCanvas"),p.set(M,it.canvas)),{canvas:it.canvas,offsetX:Math.round(Nt),offsetY:Math.round(Gt)}}setLineWidth(n){n!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=n,this.ctx.lineWidth=n}setLineCap(n){this.ctx.lineCap=ue[n]}setLineJoin(n){this.ctx.lineJoin=be[n]}setMiterLimit(n){this.ctx.miterLimit=n}setDash(n,s){const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(n),a.lineDashOffset=s)}setRenderingIntent(n){}setFlatness(n){}setGState(n){for(const[s,a]of n)switch(s){case"LW":this.setLineWidth(a);break;case"LC":this.setLineCap(a);break;case"LJ":this.setLineJoin(a);break;case"ML":this.setMiterLimit(a);break;case"D":this.setDash(a[0],a[1]);break;case"RI":this.setRenderingIntent(a);break;case"FL":this.setFlatness(a);break;case"Font":this.setFont(a[0],a[1]);break;case"CA":this.current.strokeAlpha=a;break;case"ca":this.current.fillAlpha=a,this.ctx.globalAlpha=a;break;case"BM":this.ctx.globalCompositeOperation=a;break;case"SMask":this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const n=this.inSMaskMode;this.current.activeSMask&&!n?this.beginSMaskMode():!this.current.activeSMask&&n&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const n=this.ctx.canvas.width,s=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,h=this.cachedCanvases.getCanvas(a,n,s);this.suspendedCtx=this.ctx,this.ctx=h.context;const l=this.ctx;l.setTransform(...(0,J.getCurrentTransform)(this.suspendedCtx)),Lt(this.suspendedCtx,l),st(l,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Lt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(n){if(!this.current.activeSMask)return;n?(n[0]=Math.floor(n[0]),n[1]=Math.floor(n[1]),n[2]=Math.ceil(n[2]),n[3]=Math.ceil(n[3])):n=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const s=this.current.activeSMask,a=this.suspendedCtx;Rt(a,s,this.ctx,n),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Lt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const n=this.current;this.stateStack.push(n),this.current=n.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Lt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(n,s,a,h,l,g){this.ctx.transform(n,s,a,h,l,g),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(n,s,a){const h=this.ctx,l=this.current;let g=l.x,u=l.y,p,M;const e=(0,J.getCurrentTransform)(h),i=e[0]===0&&e[3]===0||e[1]===0&&e[2]===0,o=i?a.slice(0):null;for(let m=0,T=0,$=n.length;m<$;m++)switch(n[m]|0){case d.OPS.rectangle:g=s[T++],u=s[T++];const W=s[T++],tt=s[T++],ft=g+W,it=u+tt;h.moveTo(g,u),W===0||tt===0?h.lineTo(ft,it):(h.lineTo(ft,u),h.lineTo(ft,it),h.lineTo(g,it)),i||l.updateRectMinMax(e,[g,u,ft,it]),h.closePath();break;case d.OPS.moveTo:g=s[T++],u=s[T++],h.moveTo(g,u),i||l.updatePathMinMax(e,g,u);break;case d.OPS.lineTo:g=s[T++],u=s[T++],h.lineTo(g,u),i||l.updatePathMinMax(e,g,u);break;case d.OPS.curveTo:p=g,M=u,g=s[T+4],u=s[T+5],h.bezierCurveTo(s[T],s[T+1],s[T+2],s[T+3],g,u),l.updateCurvePathMinMax(e,p,M,s[T],s[T+1],s[T+2],s[T+3],g,u,o),T+=6;break;case d.OPS.curveTo2:p=g,M=u,h.bezierCurveTo(g,u,s[T],s[T+1],s[T+2],s[T+3]),l.updateCurvePathMinMax(e,p,M,g,u,s[T],s[T+1],s[T+2],s[T+3],o),g=s[T+2],u=s[T+3],T+=4;break;case d.OPS.curveTo3:p=g,M=u,g=s[T+2],u=s[T+3],h.bezierCurveTo(s[T],s[T+1],g,u,g,u),l.updateCurvePathMinMax(e,p,M,s[T],s[T+1],g,u,g,u,o),T+=4;break;case d.OPS.closePath:h.closePath();break}i&&l.updateScalingPathMinMax(e,o),l.setCurrentPoint(g,u)}closePath(){this.ctx.closePath()}stroke(n=!0){const s=this.ctx,a=this.current.strokeColor;s.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof a=="object"&&(a!=null&&a.getPattern)?(s.save(),s.strokeStyle=a.getPattern(s,this,(0,J.getCurrentTransformInverse)(s),N.STROKE),this.rescaleAndStroke(!1),s.restore()):this.rescaleAndStroke(!0)),n&&this.consumePath(this.current.getClippedPathBoundingBox()),s.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(n=!0){const s=this.ctx,a=this.current.fillColor,h=this.current.patternFill;let l=!1;h&&(s.save(),s.fillStyle=a.getPattern(s,this,(0,J.getCurrentTransformInverse)(s),N.FILL),l=!0);const g=this.current.getClippedPathBoundingBox();this.contentVisible&&g!==null&&(this.pendingEOFill?(s.fill("evenodd"),this.pendingEOFill=!1):s.fill()),l&&s.restore(),n&&this.consumePath(g)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Ut}eoClip(){this.pendingClip=le}beginText(){this.current.textMatrix=d.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const n=this.pendingTextPaths,s=this.ctx;if(n===void 0){s.beginPath();return}s.save(),s.beginPath();for(const a of n)s.setTransform(...a.transform),s.translate(a.x,a.y),a.addToPath(s,a.fontSize);s.restore(),s.clip(),s.beginPath(),delete this.pendingTextPaths}setCharSpacing(n){this.current.charSpacing=n}setWordSpacing(n){this.current.wordSpacing=n}setHScale(n){this.current.textHScale=n/100}setLeading(n){this.current.leading=-n}setFont(n,s){var e;const a=this.commonObjs.get(n),h=this.current;if(!a)throw new Error(`Can't find font for ${n}`);if(h.fontMatrix=a.fontMatrix||d.FONT_IDENTITY_MATRIX,(h.fontMatrix[0]===0||h.fontMatrix[3]===0)&&(0,d.warn)("Invalid font matrix for font "+n),s<0?(s=-s,h.fontDirection=-1):h.fontDirection=1,this.current.font=a,this.current.fontSize=s,a.isType3Font)return;const l=a.loadedName||"sans-serif",g=((e=a.systemFontInfo)==null?void 0:e.css)||`"${l}", ${a.fallbackName}`;let u="normal";a.black?u="900":a.bold&&(u="bold");const p=a.italic?"italic":"normal";let M=s;s<U?M=U:s>K&&(M=K),this.current.fontSizeScale=s/M,this.ctx.font=`${p} ${u} ${M}px ${g}`}setTextRenderingMode(n){this.current.textRenderingMode=n}setTextRise(n){this.current.textRise=n}moveText(n,s){this.current.x=this.current.lineX+=n,this.current.y=this.current.lineY+=s}setLeadingMoveText(n,s){this.setLeading(-s),this.moveText(n,s)}setTextMatrix(n,s,a,h,l,g){this.current.textMatrix=[n,s,a,h,l,g],this.current.textMatrixScale=Math.hypot(n,s),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(n,s,a,h){const l=this.ctx,g=this.current,u=g.font,p=g.textRenderingMode,M=g.fontSize/g.fontSizeScale,e=p&d.TextRenderingMode.FILL_STROKE_MASK,i=!!(p&d.TextRenderingMode.ADD_TO_PATH_FLAG),o=g.patternFill&&!u.missingFile;let m;(u.disableFontFace||i||o)&&(m=u.getPathGenerator(this.commonObjs,n)),u.disableFontFace||o?(l.save(),l.translate(s,a),l.beginPath(),m(l,M),h&&l.setTransform(...h),(e===d.TextRenderingMode.FILL||e===d.TextRenderingMode.FILL_STROKE)&&l.fill(),(e===d.TextRenderingMode.STROKE||e===d.TextRenderingMode.FILL_STROKE)&&l.stroke(),l.restore()):((e===d.TextRenderingMode.FILL||e===d.TextRenderingMode.FILL_STROKE)&&l.fillText(n,s,a),(e===d.TextRenderingMode.STROKE||e===d.TextRenderingMode.FILL_STROKE)&&l.strokeText(n,s,a)),i&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,J.getCurrentTransform)(l),x:s,y:a,fontSize:M,addToPath:m})}get isFontSubpixelAAEnabled(){const{context:n}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);n.scale(1.5,1),n.fillText("I",0,10);const s=n.getImageData(0,0,10,10).data;let a=!1;for(let h=3;h<s.length;h+=4)if(s[h]>0&&s[h]<255){a=!0;break}return(0,d.shadow)(this,"isFontSubpixelAAEnabled",a)}showText(n){const s=this.current,a=s.font;if(a.isType3Font)return this.showType3Text(n);const h=s.fontSize;if(h===0)return;const l=this.ctx,g=s.fontSizeScale,u=s.charSpacing,p=s.wordSpacing,M=s.fontDirection,e=s.textHScale*M,i=n.length,o=a.vertical,m=o?1:-1,T=a.defaultVMetrics,$=h*s.fontMatrix[0],W=s.textRenderingMode===d.TextRenderingMode.FILL&&!a.disableFontFace&&!s.patternFill;l.save(),l.transform(...s.textMatrix),l.translate(s.x,s.y+s.textRise),M>0?l.scale(e,-1):l.scale(e,1);let tt;if(s.patternFill){l.save();const Gt=s.fillColor.getPattern(l,this,(0,J.getCurrentTransformInverse)(l),N.FILL);tt=(0,J.getCurrentTransform)(l),l.restore(),l.fillStyle=Gt}let ft=s.lineWidth;const it=s.textMatrixScale;if(it===0||ft===0){const Gt=s.textRenderingMode&d.TextRenderingMode.FILL_STROKE_MASK;(Gt===d.TextRenderingMode.STROKE||Gt===d.TextRenderingMode.FILL_STROKE)&&(ft=this.getSinglePixelWidth())}else ft/=it;if(g!==1&&(l.scale(g,g),ft/=g),l.lineWidth=ft,a.isInvalidPDFjsFont){const Gt=[];let Wt=0;for(const Ht of n)Gt.push(Ht.unicode),Wt+=Ht.width;l.fillText(Gt.join(""),0,0),s.x+=Wt*$*e,l.restore(),this.compose();return}let wt=0,Nt;for(Nt=0;Nt<i;++Nt){const Gt=n[Nt];if(typeof Gt=="number"){wt+=m*Gt*h/1e3;continue}let Wt=!1;const Ht=(Gt.isSpace?p:0)+u,lt=Gt.fontChar,ut=Gt.accent;let C,X,Q=Gt.width;if(o){const xt=Gt.vmetric||T,Pt=-(Gt.vmetric?xt[1]:Q*.5)*$,Bt=xt[2]*$;Q=xt?-xt[0]:Q,C=Pt/g,X=(wt+Bt)/g}else C=wt/g,X=0;if(a.remeasure&&Q>0){const xt=l.measureText(lt).width*1e3/h*g;if(Q<xt&&this.isFontSubpixelAAEnabled){const Pt=Q/xt;Wt=!0,l.save(),l.scale(Pt,1),C/=Pt}else Q!==xt&&(C+=(Q-xt)/2e3*h/g)}if(this.contentVisible&&(Gt.isInFont||a.missingFile)){if(W&&!ut)l.fillText(lt,C,X);else if(this.paintChar(lt,C,X,tt),ut){const xt=C+h*ut.offset.x/g,Pt=X-h*ut.offset.y/g;this.paintChar(ut.fontChar,xt,Pt,tt)}}const vt=o?Q*$-Ht*M:Q*$+Ht*M;wt+=vt,Wt&&l.restore()}o?s.y-=wt:s.x+=wt*e,l.restore(),this.compose()}showType3Text(n){const s=this.ctx,a=this.current,h=a.font,l=a.fontSize,g=a.fontDirection,u=h.vertical?1:-1,p=a.charSpacing,M=a.wordSpacing,e=a.textHScale*g,i=a.fontMatrix||d.FONT_IDENTITY_MATRIX,o=n.length,m=a.textRenderingMode===d.TextRenderingMode.INVISIBLE;let T,$,W,tt;if(!(m||l===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),s.transform(...a.textMatrix),s.translate(a.x,a.y),s.scale(e,g),T=0;T<o;++T){if($=n[T],typeof $=="number"){tt=u*$*l/1e3,this.ctx.translate(tt,0),a.x+=tt*e;continue}const ft=($.isSpace?M:0)+p,it=h.charProcOperatorList[$.operatorListId];if(!it){(0,d.warn)(`Type3 character "${$.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=$,this.save(),s.scale(l,l),s.transform(...i),this.executeOperatorList(it),this.restore()),W=d.Util.applyTransform([$.width,0],i)[0]*l+ft,s.translate(W,0),a.x+=W*e}s.restore(),this.processingType3=null}}setCharWidth(n,s){}setCharWidthAndBounds(n,s,a,h,l,g){this.ctx.rect(a,h,l-a,g-h),this.ctx.clip(),this.endPath()}getColorN_Pattern(n){let s;if(n[0]==="TilingPattern"){const a=n[1],h=this.baseTransform||(0,J.getCurrentTransform)(this.ctx),l={createCanvasGraphics:g=>new gt(g,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};s=new D(n,a,this.ctx,l,h)}else s=this._getPattern(n[1],n[2]);return s}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(n,s,a){const h=d.Util.makeHexColor(n,s,a);this.ctx.strokeStyle=h,this.current.strokeColor=h}setFillRGBColor(n,s,a){const h=d.Util.makeHexColor(n,s,a);this.ctx.fillStyle=h,this.current.fillColor=h,this.current.patternFill=!1}_getPattern(n,s=null){let a;return this.cachedPatterns.has(n)?a=this.cachedPatterns.get(n):(a=y(this.getObject(n)),this.cachedPatterns.set(n,a)),s&&(a.matrix=s),a}shadingFill(n){if(!this.contentVisible)return;const s=this.ctx;this.save();const a=this._getPattern(n);s.fillStyle=a.getPattern(s,this,(0,J.getCurrentTransformInverse)(s),N.SHADING);const h=(0,J.getCurrentTransformInverse)(s);if(h){const{width:l,height:g}=s.canvas,[u,p,M,e]=d.Util.getAxialAlignedBoundingBox([0,0,l,g],h);this.ctx.fillRect(u,p,M-u,e-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,d.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,d.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(n,s){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(n)&&n.length===6&&this.transform(...n),this.baseTransform=(0,J.getCurrentTransform)(this.ctx),s)){const a=s[2]-s[0],h=s[3]-s[1];this.ctx.rect(s[0],s[1],a,h),this.current.updateRectMinMax((0,J.getCurrentTransform)(this.ctx),s),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(n){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;n.isolated||(0,d.info)("TODO: Support non-isolated groups."),n.knockout&&(0,d.warn)("Knockout groups not supported.");const a=(0,J.getCurrentTransform)(s);if(n.matrix&&s.transform(...n.matrix),!n.bbox)throw new Error("Bounding box is required.");let h=d.Util.getAxialAlignedBoundingBox(n.bbox,(0,J.getCurrentTransform)(s));const l=[0,0,s.canvas.width,s.canvas.height];h=d.Util.intersect(h,l)||[0,0,0,0];const g=Math.floor(h[0]),u=Math.floor(h[1]);let p=Math.max(Math.ceil(h[2])-g,1),M=Math.max(Math.ceil(h[3])-u,1),e=1,i=1;p>P&&(e=p/P,p=P),M>P&&(i=M/P,M=P),this.current.startNewPathAndClipBox([0,0,p,M]);let o="groupAt"+this.groupLevel;n.smask&&(o+="_smask_"+this.smaskCounter++%2);const m=this.cachedCanvases.getCanvas(o,p,M),T=m.context;T.scale(1/e,1/i),T.translate(-g,-u),T.transform(...a),n.smask?this.smaskStack.push({canvas:m.canvas,context:T,offsetX:g,offsetY:u,scaleX:e,scaleY:i,subtype:n.smask.subtype,backdrop:n.smask.backdrop,transferMap:n.smask.transferMap||null,startTransformInverse:null}):(s.setTransform(1,0,0,1,0,0),s.translate(g,u),s.scale(e,i),s.save()),Lt(s,T),this.ctx=T,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(n){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,n.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const h=(0,J.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...h);const l=d.Util.getAxialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],h);this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(n,s,a,h,l){if(A(this,Zt,Ci).call(this),Xt(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(s)&&s.length===4){const g=s[2]-s[0],u=s[3]-s[1];if(l&&this.annotationCanvasMap){a=a.slice(),a[4]-=s[0],a[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=g,s[3]=u;const[p,M]=d.Util.singularValueDecompose2dScale((0,J.getCurrentTransform)(this.ctx)),{viewportScale:e}=this,i=Math.ceil(g*this.outputScaleX*e),o=Math.ceil(u*this.outputScaleY*e);this.annotationCanvas=this.canvasFactory.create(i,o);const{canvas:m,context:T}=this.annotationCanvas;this.annotationCanvasMap.set(n,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=T,this.ctx.save(),this.ctx.setTransform(p,0,0,-M,0,u*M),Xt(this.ctx)}else Xt(this.ctx),this.ctx.rect(s[0],s[1],g,u),this.ctx.clip(),this.endPath()}this.current=new nt(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...a),this.transform(...h)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),A(this,Zt,Ti).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(n){if(!this.contentVisible)return;const s=n.count;n=this.getObject(n.data,n),n.count=s;const a=this.ctx,h=this.processingType3;if(h&&(h.compiled===void 0&&(h.compiled=ot(n)),h.compiled)){h.compiled(a);return}const l=this._createMaskCanvas(n),g=l.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(g,l.offsetX,l.offsetY),a.restore(),this.compose()}paintImageMaskXObjectRepeat(n,s,a=0,h=0,l,g){if(!this.contentVisible)return;n=this.getObject(n.data,n);const u=this.ctx;u.save();const p=(0,J.getCurrentTransform)(u);u.transform(s,a,h,l,0,0);const M=this._createMaskCanvas(n);u.setTransform(1,0,0,1,M.offsetX-p[4],M.offsetY-p[5]);for(let e=0,i=g.length;e<i;e+=2){const o=d.Util.transform(p,[s,a,h,l,g[e],g[e+1]]),[m,T]=d.Util.applyTransform([0,0],o);u.drawImage(M.canvas,m,T)}u.restore(),this.compose()}paintImageMaskXObjectGroup(n){if(!this.contentVisible)return;const s=this.ctx,a=this.current.fillColor,h=this.current.patternFill;for(const l of n){const{data:g,width:u,height:p,transform:M}=l,e=this.cachedCanvases.getCanvas("maskCanvas",u,p),i=e.context;i.save();const o=this.getObject(g,l);Dt(i,o),i.globalCompositeOperation="source-in",i.fillStyle=h?a.getPattern(i,this,(0,J.getCurrentTransformInverse)(s),N.FILL):a,i.fillRect(0,0,u,p),i.restore(),s.save(),s.transform(...M),s.scale(1,-1),Tt(s,e.canvas,0,0,u,p,0,-1,1,1),s.restore()}this.compose()}paintImageXObject(n){if(!this.contentVisible)return;const s=this.getObject(n);if(!s){(0,d.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(s)}paintImageXObjectRepeat(n,s,a,h){if(!this.contentVisible)return;const l=this.getObject(n);if(!l){(0,d.warn)("Dependent image isn't ready yet");return}const g=l.width,u=l.height,p=[];for(let M=0,e=h.length;M<e;M+=2)p.push({transform:[s,0,0,a,h[M],h[M+1]],x:0,y:0,w:g,h:u});this.paintInlineImageXObjectGroup(l,p)}applyTransferMapsToCanvas(n){return this.current.transferMaps!=="none"&&(n.filter=this.current.transferMaps,n.drawImage(n.canvas,0,0),n.filter="none"),n.canvas}applyTransferMapsToBitmap(n){if(this.current.transferMaps==="none")return n.bitmap;const{bitmap:s,width:a,height:h}=n,l=this.cachedCanvases.getCanvas("inlineImage",a,h),g=l.context;return g.filter=this.current.transferMaps,g.drawImage(s,0,0),g.filter="none",l.canvas}paintInlineImageXObject(n){if(!this.contentVisible)return;const s=n.width,a=n.height,h=this.ctx;if(this.save(),!d.isNodeJS){const{filter:u}=h;u!=="none"&&u!==""&&(h.filter="none")}h.scale(1/s,-1/a);let l;if(n.bitmap)l=this.applyTransferMapsToBitmap(n);else if(typeof HTMLElement=="function"&&n instanceof HTMLElement||!n.data)l=n;else{const u=this.cachedCanvases.getCanvas("inlineImage",s,a).context;Mt(u,n),l=this.applyTransferMapsToCanvas(u)}const g=this._scaleImage(l,(0,J.getCurrentTransformInverse)(h));h.imageSmoothingEnabled=Qt((0,J.getCurrentTransform)(h),n.interpolate),Tt(h,g.img,0,0,g.paintWidth,g.paintHeight,0,-a,s,a),this.compose(),this.restore()}paintInlineImageXObjectGroup(n,s){if(!this.contentVisible)return;const a=this.ctx;let h;if(n.bitmap)h=n.bitmap;else{const l=n.width,g=n.height,u=this.cachedCanvases.getCanvas("inlineImage",l,g).context;Mt(u,n),h=this.applyTransferMapsToCanvas(u)}for(const l of s)a.save(),a.transform(...l.transform),a.scale(1,-1),Tt(a,h,l.x,l.y,l.w,l.h,0,-1,1,1),a.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(n){}markPointProps(n,s){}beginMarkedContent(n){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(n,s){n==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(n){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const a=this.ctx;this.pendingClip&&(s||(this.pendingClip===le?a.clip("evenodd"):a.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),a.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const n=(0,J.getCurrentTransform)(this.ctx);if(n[1]===0&&n[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(n[0]),Math.abs(n[3]));else{const s=Math.abs(n[0]*n[3]-n[2]*n[1]),a=Math.hypot(n[0],n[2]),h=Math.hypot(n[1],n[3]);this._cachedGetSinglePixelWidth=Math.max(a,h)/s}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:n}=this.current,{a:s,b:a,c:h,d:l}=this.ctx.getTransform();let g,u;if(a===0&&h===0){const p=Math.abs(s),M=Math.abs(l);if(p===M)if(n===0)g=u=1/p;else{const e=p*n;g=u=e<1?1/e:1}else if(n===0)g=1/p,u=1/M;else{const e=p*n,i=M*n;g=e<1?1/e:1,u=i<1?1/i:1}}else{const p=Math.abs(s*l-a*h),M=Math.hypot(s,a),e=Math.hypot(h,l);if(n===0)g=e/p,u=M/p;else{const i=n*p;g=e>i?e/i:1,u=M>i?M/i:1}}this._cachedScaleForStroking[0]=g,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(n){const{ctx:s}=this,{lineWidth:a}=this.current,[h,l]=this.getScaleForStroking();if(s.lineWidth=a||1,h===1&&l===1){s.stroke();return}const g=s.getLineDash();if(n&&s.save(),s.scale(h,l),g.length>0){const u=Math.max(h,l);s.setLineDash(g.map(p=>p/u)),s.lineDashOffset/=u}s.stroke(),n&&s.restore()}isContentVisible(){for(let n=this.markedContentStack.length-1;n>=0;n--)if(!this.markedContentStack[n].visible)return!1;return!0}};Zt=new WeakSet,Ci=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Ti=function(){if(this.pageColors){const n=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(n!=="none"){const s=this.ctx.filter;this.ctx.filter=n,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=s}}};let ee=gt;for(const S in d.OPS)ee.prototype[S]!==void 0&&(ee.prototype[d.OPS[S]]=ee.prototype[S])},419:(se,Vt,dt)=>{var Lt,Xt,ae,Jt,ne,oe,Rt,As,vs,ys,Mi,Ys,Js,Ps,ks;dt.d(Vt,{DOMCMapReaderFactory:()=>k,DOMCanvasFactory:()=>H,DOMFilterFactory:()=>pt,DOMSVGFactory:()=>x,DOMStandardFontDataFactory:()=>j,PDFDateString:()=>ht,PageViewport:()=>y,PixelsPerInch:()=>Y,RenderingCancelledException:()=>F,StatTimer:()=>P,fetchData:()=>I,getColorValues:()=>Tt,getCurrentTransform:()=>ot,getCurrentTransformInverse:()=>nt,getFilenameFromUrl:()=>U,getPdfFilenameFromUrl:()=>K,getRGB:()=>At,getXfaPageViewport:()=>st,isDataScheme:()=>D,isPdfFile:()=>Z,isValidFetchUrl:()=>B,noContextMenu:()=>R,setLayerDimensions:()=>Mt});var d=dt(583),J=dt(292);const N="http://www.w3.org/2000/svg",Dt=class Dt{};he(Dt,"CSS",96),he(Dt,"PDF",72),he(Dt,"PDF_TO_CSS_UNITS",Dt.CSS/Dt.PDF);let Y=Dt;class pt extends d.BaseFilterFactory{constructor({docId:gt,ownerDocument:S=globalThis.document}={}){super();w(this,Rt);w(this,Lt);w(this,Xt);w(this,ae);w(this,Jt);w(this,ne);w(this,oe,0);_(this,ae,gt),_(this,Jt,S)}addFilter(gt){if(!gt)return"none";let S=t(this,Rt,As).get(gt);if(S)return S;let n,s,a,h;if(gt.length===1){const p=gt[0],M=new Array(256);for(let e=0;e<256;e++)M[e]=p[e]/255;h=n=s=a=M.join(",")}else{const[p,M,e]=gt,i=new Array(256),o=new Array(256),m=new Array(256);for(let T=0;T<256;T++)i[T]=p[T]/255,o[T]=M[T]/255,m[T]=e[T]/255;n=i.join(","),s=o.join(","),a=m.join(","),h=`${n}${s}${a}`}if(S=t(this,Rt,As).get(h),S)return t(this,Rt,As).set(gt,S),S;const l=`g_${t(this,ae)}_transfer_map_${Je(this,oe)._++}`,g=`url(#${l})`;t(this,Rt,As).set(gt,g),t(this,Rt,As).set(h,g);const u=A(this,Rt,Ys).call(this,l);return A(this,Rt,Ps).call(this,n,s,a,u),g}addHCMFilter(gt,S){var i;const n=`${gt}-${S}`,s="base";let a=t(this,Rt,vs).get(s);if((a==null?void 0:a.key)===n||(a?((i=a.filter)==null||i.remove(),a.key=n,a.url="none",a.filter=null):(a={key:n,url:"none",filter:null},t(this,Rt,vs).set(s,a)),!gt||!S))return a.url;const h=A(this,Rt,ks).call(this,gt);gt=J.Util.makeHexColor(...h);const l=A(this,Rt,ks).call(this,S);if(S=J.Util.makeHexColor(...l),t(this,Rt,ys).style.color="",gt==="#000000"&&S==="#ffffff"||gt===S)return a.url;const g=new Array(256);for(let o=0;o<=255;o++){const m=o/255;g[o]=m<=.03928?m/12.92:((m+.055)/1.055)**2.4}const u=g.join(","),p=`g_${t(this,ae)}_hcm_filter`,M=a.filter=A(this,Rt,Ys).call(this,p);A(this,Rt,Ps).call(this,u,u,u,M),A(this,Rt,Mi).call(this,M);const e=(o,m)=>{const T=h[o]/255,$=l[o]/255,W=new Array(m+1);for(let tt=0;tt<=m;tt++)W[tt]=T+tt/m*($-T);return W.join(",")};return A(this,Rt,Ps).call(this,e(0,5),e(1,5),e(2,5),M),a.url=`url(#${p})`,a.url}addHighlightHCMFilter(gt,S,n,s,a){var $;const h=`${S}-${n}-${s}-${a}`;let l=t(this,Rt,vs).get(gt);if((l==null?void 0:l.key)===h||(l?(($=l.filter)==null||$.remove(),l.key=h,l.url="none",l.filter=null):(l={key:h,url:"none",filter:null},t(this,Rt,vs).set(gt,l)),!S||!n))return l.url;const[g,u]=[S,n].map(A(this,Rt,ks).bind(this));let p=Math.round(.2126*g[0]+.7152*g[1]+.0722*g[2]),M=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[e,i]=[s,a].map(A(this,Rt,ks).bind(this));M<p&&([p,M,e,i]=[M,p,i,e]),t(this,Rt,ys).style.color="";const o=(W,tt,ft)=>{const it=new Array(256),wt=(M-p)/ft,Nt=W/255,Gt=(tt-W)/(255*ft);let Wt=0;for(let Ht=0;Ht<=ft;Ht++){const lt=Math.round(p+Ht*wt),ut=Nt+Ht*Gt;for(let C=Wt;C<=lt;C++)it[C]=ut;Wt=lt+1}for(let Ht=Wt;Ht<256;Ht++)it[Ht]=it[Wt-1];return it.join(",")},m=`g_${t(this,ae)}_hcm_${gt}_filter`,T=l.filter=A(this,Rt,Ys).call(this,m);return A(this,Rt,Mi).call(this,T),A(this,Rt,Ps).call(this,o(e[0],i[0],5),o(e[1],i[1],5),o(e[2],i[2],5),T),l.url=`url(#${m})`,l.url}destroy(gt=!1){gt&&t(this,Rt,vs).size!==0||(t(this,Xt)&&(t(this,Xt).parentNode.parentNode.remove(),_(this,Xt,null)),t(this,Lt)&&(t(this,Lt).clear(),_(this,Lt,null)),_(this,oe,0))}}Lt=new WeakMap,Xt=new WeakMap,ae=new WeakMap,Jt=new WeakMap,ne=new WeakMap,oe=new WeakMap,Rt=new WeakSet,As=function(){return t(this,Lt)||_(this,Lt,new Map)},vs=function(){return t(this,ne)||_(this,ne,new Map)},ys=function(){if(!t(this,Xt)){const gt=t(this,Jt).createElement("div"),{style:S}=gt;S.visibility="hidden",S.contain="strict",S.width=S.height=0,S.position="absolute",S.top=S.left=0,S.zIndex=-1;const n=t(this,Jt).createElementNS(N,"svg");n.setAttribute("width",0),n.setAttribute("height",0),_(this,Xt,t(this,Jt).createElementNS(N,"defs")),gt.append(n),n.append(t(this,Xt)),t(this,Jt).body.append(gt)}return t(this,Xt)},Mi=function(gt){const S=t(this,Jt).createElementNS(N,"feColorMatrix");S.setAttribute("type","matrix"),S.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),gt.append(S)},Ys=function(gt){const S=t(this,Jt).createElementNS(N,"filter");return S.setAttribute("color-interpolation-filters","sRGB"),S.setAttribute("id",gt),t(this,Rt,ys).append(S),S},Js=function(gt,S,n){const s=t(this,Jt).createElementNS(N,S);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),gt.append(s)},Ps=function(gt,S,n,s){const a=t(this,Jt).createElementNS(N,"feComponentTransfer");s.append(a),A(this,Rt,Js).call(this,a,"feFuncR",gt),A(this,Rt,Js).call(this,a,"feFuncG",S),A(this,Rt,Js).call(this,a,"feFuncB",n)},ks=function(gt){return t(this,Rt,ys).style.color=gt,At(getComputedStyle(t(this,Rt,ys)).getPropertyValue("color"))};class H extends d.BaseCanvasFactory{constructor({ownerDocument:bt=globalThis.document}={}){super(),this._document=bt}_createCanvas(bt,gt){const S=this._document.createElement("canvas");return S.width=bt,S.height=gt,S}}async function I(Ot,bt="text"){if(B(Ot,document.baseURI)){const gt=await fetch(Ot);if(!gt.ok)throw new Error(gt.statusText);switch(bt){case"arraybuffer":return gt.arrayBuffer();case"blob":return gt.blob();case"json":return gt.json()}return gt.text()}return new Promise((gt,S)=>{const n=new XMLHttpRequest;n.open("GET",Ot,!0),n.responseType=bt,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(bt){case"arraybuffer":case"blob":case"json":gt(n.response);return}gt(n.responseText);return}S(new Error(n.statusText))}},n.send(null)})}class k extends d.BaseCMapReaderFactory{_fetchData(bt,gt){return I(bt,this.isCompressed?"arraybuffer":"text").then(S=>({cMapData:S instanceof ArrayBuffer?new Uint8Array(S):(0,J.stringToBytes)(S),compressionType:gt}))}}class j extends d.BaseStandardFontDataFactory{_fetchData(bt){return I(bt,"arraybuffer").then(gt=>new Uint8Array(gt))}}class x extends d.BaseSVGFactory{_createSVG(bt){return document.createElementNS(N,bt)}}class y{constructor({viewBox:bt,scale:gt,rotation:S,offsetX:n=0,offsetY:s=0,dontFlip:a=!1}){this.viewBox=bt,this.scale=gt,this.rotation=S,this.offsetX=n,this.offsetY=s;const h=(bt[2]+bt[0])/2,l=(bt[3]+bt[1])/2;let g,u,p,M;switch(S%=360,S<0&&(S+=360),S){case 180:g=-1,u=0,p=0,M=1;break;case 90:g=0,u=1,p=1,M=0;break;case 270:g=0,u=-1,p=-1,M=0;break;case 0:g=1,u=0,p=0,M=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(p=-p,M=-M);let e,i,o,m;g===0?(e=Math.abs(l-bt[1])*gt+n,i=Math.abs(h-bt[0])*gt+s,o=(bt[3]-bt[1])*gt,m=(bt[2]-bt[0])*gt):(e=Math.abs(h-bt[0])*gt+n,i=Math.abs(l-bt[1])*gt+s,o=(bt[2]-bt[0])*gt,m=(bt[3]-bt[1])*gt),this.transform=[g*gt,u*gt,p*gt,M*gt,e-g*gt*h-p*gt*l,i-u*gt*h-M*gt*l],this.width=o,this.height=m}get rawDims(){const{viewBox:bt}=this;return(0,J.shadow)(this,"rawDims",{pageWidth:bt[2]-bt[0],pageHeight:bt[3]-bt[1],pageX:bt[0],pageY:bt[1]})}clone({scale:bt=this.scale,rotation:gt=this.rotation,offsetX:S=this.offsetX,offsetY:n=this.offsetY,dontFlip:s=!1}={}){return new y({viewBox:this.viewBox.slice(),scale:bt,rotation:gt,offsetX:S,offsetY:n,dontFlip:s})}convertToViewportPoint(bt,gt){return J.Util.applyTransform([bt,gt],this.transform)}convertToViewportRectangle(bt){const gt=J.Util.applyTransform([bt[0],bt[1]],this.transform),S=J.Util.applyTransform([bt[2],bt[3]],this.transform);return[gt[0],gt[1],S[0],S[1]]}convertToPdfPoint(bt,gt){return J.Util.applyInverseTransform([bt,gt],this.transform)}}class F extends J.BaseException{constructor(bt,gt=0){super(bt,"RenderingCancelledException"),this.extraDelay=gt}}function D(Ot){const bt=Ot.length;let gt=0;for(;gt<bt&&Ot[gt].trim()==="";)gt++;return Ot.substring(gt,gt+5).toLowerCase()==="data:"}function Z(Ot){return typeof Ot=="string"&&/\.pdf$/i.test(Ot)}function U(Ot,bt=!1){return bt||([Ot]=Ot.split(/[#?]/,1)),Ot.substring(Ot.lastIndexOf("/")+1)}function K(Ot,bt="document.pdf"){if(typeof Ot!="string")return bt;if(D(Ot))return(0,J.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),bt;const gt=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,S=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=gt.exec(Ot);let s=S.exec(n[1])||S.exec(n[2])||S.exec(n[3]);if(s&&(s=s[0],s.includes("%")))try{s=S.exec(decodeURIComponent(s))[0]}catch{}return s||bt}class P{constructor(){he(this,"started",Object.create(null));he(this,"times",[])}time(bt){bt in this.started&&(0,J.warn)(`Timer is already running for ${bt}`),this.started[bt]=Date.now()}timeEnd(bt){bt in this.started||(0,J.warn)(`Timer has not been started for ${bt}`),this.times.push({name:bt,start:this.started[bt],end:Date.now()}),delete this.started[bt]}toString(){const bt=[];let gt=0;for(const{name:S}of this.times)gt=Math.max(S.length,gt);for(const{name:S,start:n,end:s}of this.times)bt.push(`${S.padEnd(gt)} ${s-n}ms
`);return bt.join("")}}function B(Ot,bt){try{const{protocol:gt}=bt?new URL(Ot,bt):new URL(Ot);return gt==="http:"||gt==="https:"}catch{return!1}}function R(Ot){Ot.preventDefault()}let L;class ht{static toDateObject(bt){if(!bt||typeof bt!="string")return null;L||(L=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const gt=L.exec(bt);if(!gt)return null;const S=parseInt(gt[1],10);let n=parseInt(gt[2],10);n=n>=1&&n<=12?n-1:0;let s=parseInt(gt[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(gt[4],10);a=a>=0&&a<=23?a:0;let h=parseInt(gt[5],10);h=h>=0&&h<=59?h:0;let l=parseInt(gt[6],10);l=l>=0&&l<=59?l:0;const g=gt[7]||"Z";let u=parseInt(gt[8],10);u=u>=0&&u<=23?u:0;let p=parseInt(gt[9],10)||0;return p=p>=0&&p<=59?p:0,g==="-"?(a+=u,h+=p):g==="+"&&(a-=u,h-=p),new Date(Date.UTC(S,n,s,a,h,l))}}function st(Ot,{scale:bt=1,rotation:gt=0}){const{width:S,height:n}=Ot.attributes.style,s=[0,0,parseInt(S),parseInt(n)];return new y({viewBox:s,scale:bt,rotation:gt})}function At(Ot){if(Ot.startsWith("#")){const bt=parseInt(Ot.slice(1),16);return[(bt&16711680)>>16,(bt&65280)>>8,bt&255]}return Ot.startsWith("rgb(")?Ot.slice(4,-1).split(",").map(bt=>parseInt(bt)):Ot.startsWith("rgba(")?Ot.slice(5,-1).split(",").map(bt=>parseInt(bt)).slice(0,3):((0,J.warn)(`Not a valid color format: "${Ot}"`),[0,0,0])}function Tt(Ot){const bt=document.createElement("span");bt.style.visibility="hidden",document.body.append(bt);for(const gt of Ot.keys()){bt.style.color=gt;const S=window.getComputedStyle(bt).color;Ot.set(gt,At(S))}bt.remove()}function ot(Ot){const{a:bt,b:gt,c:S,d:n,e:s,f:a}=Ot.getTransform();return[bt,gt,S,n,s,a]}function nt(Ot){const{a:bt,b:gt,c:S,d:n,e:s,f:a}=Ot.getTransform().invertSelf();return[bt,gt,S,n,s,a]}function Mt(Ot,bt,gt=!1,S=!0){if(bt instanceof y){const{pageWidth:n,pageHeight:s}=bt.rawDims,{style:a}=Ot,h=J.FeatureTest.isCSSRoundSupported,l=`var(--scale-factor) * ${n}px`,g=`var(--scale-factor) * ${s}px`,u=h?`round(${l}, 1px)`:`calc(${l})`,p=h?`round(${g}, 1px)`:`calc(${g})`;!gt||bt.rotation%180===0?(a.width=u,a.height=p):(a.width=p,a.height=u)}S&&Ot.setAttribute("data-main-rotation",bt.rotation)}},47:(se,Vt,dt)=>{var Y,pt,H,I,k,Ri,x,Pi,Cn;dt.d(Vt,{DrawLayer:()=>N});var d=dt(419),J=dt(292);const D=class D{constructor({pageIndex:U}){w(this,x);w(this,Y,null);w(this,pt,0);w(this,H,new Map);w(this,I,new Map);this.pageIndex=U}setParent(U){if(!t(this,Y)){_(this,Y,U);return}if(t(this,Y)!==U){if(t(this,H).size>0)for(const K of t(this,H).values())K.remove(),U.append(K);_(this,Y,U)}}static get _svgFactory(){return(0,J.shadow)(this,"_svgFactory",new d.DOMSVGFactory)}highlight(U,K,P,B=!1){const R=Je(this,pt)._++,L=A(this,x,Pi).call(this,U.box);L.classList.add("highlight"),U.free&&L.classList.add("free");const ht=D._svgFactory.createElement("defs");L.append(ht);const st=D._svgFactory.createElement("path");ht.append(st);const At=`path_p${this.pageIndex}_${R}`;st.setAttribute("id",At),st.setAttribute("d",U.toSVGPath()),B&&t(this,I).set(R,st);const Tt=A(this,x,Cn).call(this,ht,At),ot=D._svgFactory.createElement("use");return L.append(ot),L.setAttribute("fill",K),L.setAttribute("fill-opacity",P),ot.setAttribute("href",`#${At}`),t(this,H).set(R,L),{id:R,clipPathId:`url(#${Tt})`}}highlightOutline(U){const K=Je(this,pt)._++,P=A(this,x,Pi).call(this,U.box);P.classList.add("highlightOutline");const B=D._svgFactory.createElement("defs");P.append(B);const R=D._svgFactory.createElement("path");B.append(R);const L=`path_p${this.pageIndex}_${K}`;R.setAttribute("id",L),R.setAttribute("d",U.toSVGPath()),R.setAttribute("vector-effect","non-scaling-stroke");let ht;if(U.free){P.classList.add("free");const Tt=D._svgFactory.createElement("mask");B.append(Tt),ht=`mask_p${this.pageIndex}_${K}`,Tt.setAttribute("id",ht),Tt.setAttribute("maskUnits","objectBoundingBox");const ot=D._svgFactory.createElement("rect");Tt.append(ot),ot.setAttribute("width","1"),ot.setAttribute("height","1"),ot.setAttribute("fill","white");const nt=D._svgFactory.createElement("use");Tt.append(nt),nt.setAttribute("href",`#${L}`),nt.setAttribute("stroke","none"),nt.setAttribute("fill","black"),nt.setAttribute("fill-rule","nonzero"),nt.classList.add("mask")}const st=D._svgFactory.createElement("use");P.append(st),st.setAttribute("href",`#${L}`),ht&&st.setAttribute("mask",`url(#${ht})`);const At=st.cloneNode();return P.append(At),st.classList.add("mainOutline"),At.classList.add("secondaryOutline"),t(this,H).set(K,P),K}finalizeLine(U,K){const P=t(this,I).get(U);t(this,I).delete(U),this.updateBox(U,K.box),P.setAttribute("d",K.toSVGPath())}updateLine(U,K){t(this,H).get(U).firstChild.firstChild.setAttribute("d",K.toSVGPath())}removeFreeHighlight(U){this.remove(U),t(this,I).delete(U)}updatePath(U,K){t(this,I).get(U).setAttribute("d",K.toSVGPath())}updateBox(U,K){var P;A(P=D,k,Ri).call(P,t(this,H).get(U),K)}show(U,K){t(this,H).get(U).classList.toggle("hidden",!K)}rotate(U,K){t(this,H).get(U).setAttribute("data-main-rotation",K)}changeColor(U,K){t(this,H).get(U).setAttribute("fill",K)}changeOpacity(U,K){t(this,H).get(U).setAttribute("fill-opacity",K)}addClass(U,K){t(this,H).get(U).classList.add(K)}removeClass(U,K){t(this,H).get(U).classList.remove(K)}remove(U){t(this,Y)!==null&&(t(this,H).get(U).remove(),t(this,H).delete(U))}destroy(){_(this,Y,null);for(const U of t(this,H).values())U.remove();t(this,H).clear()}};Y=new WeakMap,pt=new WeakMap,H=new WeakMap,I=new WeakMap,k=new WeakSet,Ri=function(U,{x:K=0,y:P=0,width:B=1,height:R=1}={}){const{style:L}=U;L.top=`${100*P}%`,L.left=`${100*K}%`,L.width=`${100*B}%`,L.height=`${100*R}%`},x=new WeakSet,Pi=function(U){var P;const K=D._svgFactory.create(1,1,!0);return t(this,Y).append(K),K.setAttribute("aria-hidden",!0),A(P=D,k,Ri).call(P,K,U),K},Cn=function(U,K){const P=D._svgFactory.createElement("clipPath");U.append(P);const B=`clip_${K}`;P.setAttribute("id",B),P.setAttribute("clipPathUnits","objectBoundingBox");const R=D._svgFactory.createElement("use");return P.append(R),R.setAttribute("href",`#${K}`),R.classList.add("clip"),B},w(D,k);let N=D},731:(se,Vt,dt)=>{var Z,U,K,P,B,R,L,ht,st,At,Tt,Tn,Mn,Rn,Qs,Lt,Zs,ti,Pn,ki,kn,Qt,ue,be,Ut,le,ee,ce,Zt,Ot,bt,gt,S,n,s,a,h,l,g,u,p,Li,Di,Ln,Dn,In,Ii,Ls,W,_s,Fn,ei,Ds,On,Nn,Bn,Un,ut,C,X,Q,vt,xt,Pt,Bt,te,de,Ae,_e,$t,v,f,E,Hn,zn,jn,Gn,Fi,qn,Oi,Vn,Wn,$n,Xn,Kn,cs,Ni,si,ii,ws,Bi,ni,Ie,Yn,Ui,Jn,Qn,Hi,ri,Is,Se,Le,Ze,$e,ts,ps,Ge,as,qe,He,xs,ye,Fs,Os,ai,zi,Zn,tr,ji,oi,er,os,gs,Ve,hs,Xe,Ke,Ye,Be,es,fs,ms,Oe,ie,ss,Fe,sr,Gi,qi,Vi,hi;dt.d(Vt,{AnnotationEditorLayer:()=>D});var d=dt(292),J=dt(310),N=dt(830),Y=dt(976);const pt=/\r\n?|\n/g,Rt=class Rt extends J.AnnotationEditor{constructor(r){super({...r,name:"freeTextEditor"});w(this,Tt);w(this,Z,this.editorDivBlur.bind(this));w(this,U,this.editorDivFocus.bind(this));w(this,K,this.editorDivInput.bind(this));w(this,P,this.editorDivKeydown.bind(this));w(this,B,this.editorDivPaste.bind(this));w(this,R);w(this,L,"");w(this,ht,`${this.id}-editor`);w(this,st);w(this,At,null);_(this,R,r.color||Rt._defaultColor||J.AnnotationEditor._defaultLineColor),_(this,st,r.fontSize||Rt._defaultFontSize)}static get _keyboardManager(){const r=Rt.prototype,b=at=>at.isEmpty(),G=N.AnnotationEditorUIManager.TRANSLATE_SMALL,V=N.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,d.shadow)(this,"_keyboardManager",new N.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],r.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],r.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],r._translateEmpty,{args:[-G,0],checker:b}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],r._translateEmpty,{args:[-V,0],checker:b}],[["ArrowRight","mac+ArrowRight"],r._translateEmpty,{args:[G,0],checker:b}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],r._translateEmpty,{args:[V,0],checker:b}],[["ArrowUp","mac+ArrowUp"],r._translateEmpty,{args:[0,-G],checker:b}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],r._translateEmpty,{args:[0,-V],checker:b}],[["ArrowDown","mac+ArrowDown"],r._translateEmpty,{args:[0,G],checker:b}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],r._translateEmpty,{args:[0,V],checker:b}]]))}static initialize(r,b){J.AnnotationEditor.initialize(r,b,{strings:["pdfjs-free-text-default-content"]});const G=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(G.getPropertyValue("--freetext-padding"))}static updateDefaultParams(r,b){switch(r){case d.AnnotationEditorParamsType.FREETEXT_SIZE:Rt._defaultFontSize=b;break;case d.AnnotationEditorParamsType.FREETEXT_COLOR:Rt._defaultColor=b;break}}updateParams(r,b){switch(r){case d.AnnotationEditorParamsType.FREETEXT_SIZE:A(this,Tt,Tn).call(this,b);break;case d.AnnotationEditorParamsType.FREETEXT_COLOR:A(this,Tt,Mn).call(this,b);break}}static get defaultPropertiesToUpdate(){return[[d.AnnotationEditorParamsType.FREETEXT_SIZE,Rt._defaultFontSize],[d.AnnotationEditorParamsType.FREETEXT_COLOR,Rt._defaultColor||J.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[d.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,st)],[d.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,R)]]}_translateEmpty(r,b){this._uiManager.translateSelectedEditors(r,b,!0)}getInitialTranslation(){const r=this.parentScale;return[-Rt._internalPadding*r,-(Rt._internalPadding+t(this,st))*r]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(d.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,P)),this.editorDiv.addEventListener("focus",t(this,U)),this.editorDiv.addEventListener("blur",t(this,Z)),this.editorDiv.addEventListener("input",t(this,K)),this.editorDiv.addEventListener("paste",t(this,B)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,ht)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,P)),this.editorDiv.removeEventListener("focus",t(this,U)),this.editorDiv.removeEventListener("blur",t(this,Z)),this.editorDiv.removeEventListener("input",t(this,K)),this.editorDiv.removeEventListener("paste",t(this,B)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(r){this._focusEventsAllowed&&(super.focusin(r),r.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var r;this.width||(this.enableEditMode(),this.editorDiv.focus(),(r=this._initialOptions)!=null&&r.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const r=t(this,L),b=_(this,L,A(this,Tt,Rn).call(this).trimEnd());if(r===b)return;const G=V=>{if(_(this,L,V),!V){this.remove();return}A(this,Tt,ti).call(this),this._uiManager.rebuild(this),A(this,Tt,Qs).call(this)};this.addCommands({cmd:()=>{G(b)},undo:()=>{G(r)},mustExec:!1}),A(this,Tt,Qs).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(r){this.enterInEditMode()}keydown(r){r.target===this.div&&r.key==="Enter"&&(this.enterInEditMode(),r.preventDefault())}editorDivKeydown(r){Rt._keyboardManager.exec(this,r)}editorDivFocus(r){this.isEditing=!0}editorDivBlur(r){this.isEditing=!1}editorDivInput(r){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let r,b;this.width&&(r=this.x,b=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,ht)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),J.AnnotationEditor._l10nPromise.get("pdfjs-free-text-default-content").then(V=>{var at;return(at=this.editorDiv)==null?void 0:at.setAttribute("default-content",V)}),this.editorDiv.contentEditable=!0;const{style:G}=this.editorDiv;if(G.fontSize=`calc(${t(this,st)}px * var(--scale-factor))`,G.color=t(this,R),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,N.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[V,at]=this.parentDimensions;if(this.annotationElementId){const{position:Ct}=t(this,At);let[kt,_t]=this.getInitialTranslation();[kt,_t]=this.pageTranslationToScreen(kt,_t);const[qt,jt]=this.pageDimensions,[pe,ge]=this.pageTranslation;let me,ve;switch(this.rotation){case 0:me=r+(Ct[0]-pe)/qt,ve=b+this.height-(Ct[1]-ge)/jt;break;case 90:me=r+(Ct[0]-pe)/qt,ve=b-(Ct[1]-ge)/jt,[kt,_t]=[_t,-kt];break;case 180:me=r-this.width+(Ct[0]-pe)/qt,ve=b-(Ct[1]-ge)/jt,[kt,_t]=[-kt,-_t];break;case 270:me=r+(Ct[0]-pe-this.height*jt)/qt,ve=b+(Ct[1]-ge-this.width*qt)/jt,[kt,_t]=[-_t,kt];break}this.setAt(me*V,ve*at,kt,_t)}else this.setAt(r*V,b*at,this.width*V,this.height*at);A(this,Tt,ti).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(r){var me,ve,De;const b=r.clipboardData||window.clipboardData,{types:G}=b;if(G.length===1&&G[0]==="text/plain")return;r.preventDefault();const V=A(me=Rt,Lt,ki).call(me,b.getData("text")||"").replaceAll(pt,`
`);if(!V)return;const at=window.getSelection();if(!at.rangeCount)return;this.editorDiv.normalize(),at.deleteFromDocument();const Ct=at.getRangeAt(0);if(!V.includes(`
`)){Ct.insertNode(document.createTextNode(V)),this.editorDiv.normalize(),at.collapseToStart();return}const{startContainer:kt,startOffset:_t}=Ct,qt=[],jt=[];if(kt.nodeType===Node.TEXT_NODE){const Ce=kt.parentElement;if(jt.push(kt.nodeValue.slice(_t).replaceAll(pt,"")),Ce!==this.editorDiv){let ke=qt;for(const Pe of this.editorDiv.childNodes){if(Pe===Ce){ke=jt;continue}ke.push(A(ve=Rt,Lt,Zs).call(ve,Pe))}}qt.push(kt.nodeValue.slice(0,_t).replaceAll(pt,""))}else if(kt===this.editorDiv){let Ce=qt,ke=0;for(const Pe of this.editorDiv.childNodes)ke++===_t&&(Ce=jt),Ce.push(A(De=Rt,Lt,Zs).call(De,Pe))}_(this,L,`${qt.join(`
`)}${V}${jt.join(`
`)}`),A(this,Tt,ti).call(this);const pe=new Range;let ge=qt.reduce((Ce,ke)=>Ce+ke.length,0);for(const{firstChild:Ce}of this.editorDiv.childNodes)if(Ce.nodeType===Node.TEXT_NODE){const ke=Ce.nodeValue.length;if(ge<=ke){pe.setStart(Ce,ge),pe.setEnd(Ce,ge);break}ge-=ke}at.removeAllRanges(),at.addRange(pe)}get contentDiv(){return this.editorDiv}static deserialize(r,b,G){var Ct;let V=null;if(r instanceof Y.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:kt,fontColor:_t},rect:qt,rotation:jt,id:pe},textContent:ge,textPosition:me,parent:{page:{pageNumber:ve}}}=r;if(!ge||ge.length===0)return null;V=r={annotationType:d.AnnotationEditorType.FREETEXT,color:Array.from(_t),fontSize:kt,value:ge.join(`
`),position:me,pageIndex:ve-1,rect:qt.slice(0),rotation:jt,id:pe,deleted:!1}}const at=super.deserialize(r,b,G);return _(at,st,r.fontSize),_(at,R,d.Util.makeHexColor(...r.color)),_(at,L,A(Ct=Rt,Lt,ki).call(Ct,r.value)),at.annotationElementId=r.id||null,_(at,At,V),at}serialize(r=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const b=Rt._internalPadding*this.parentScale,G=this.getRect(b,b),V=J.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,R)),at={annotationType:d.AnnotationEditorType.FREETEXT,color:V,fontSize:t(this,st),value:A(this,Tt,Pn).call(this),pageIndex:this.pageIndex,rect:G,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return r?at:this.annotationElementId&&!A(this,Tt,kn).call(this,at)?null:(at.id=this.annotationElementId,at)}renderAnnotationElement(r){const b=super.renderAnnotationElement(r);if(this.deleted)return b;const{style:G}=b;G.fontSize=`calc(${t(this,st)}px * var(--scale-factor))`,G.color=t(this,R),b.replaceChildren();for(const at of t(this,L).split(`
`)){const Ct=document.createElement("div");Ct.append(at?document.createTextNode(at):document.createElement("br")),b.append(Ct)}const V=Rt._internalPadding*this.parentScale;return r.updateEdited({rect:this.getRect(V,V)}),b}resetAnnotationElement(r){super.resetAnnotationElement(r),r.resetEdited()}};Z=new WeakMap,U=new WeakMap,K=new WeakMap,P=new WeakMap,B=new WeakMap,R=new WeakMap,L=new WeakMap,ht=new WeakMap,st=new WeakMap,At=new WeakMap,Tt=new WeakSet,Tn=function(r){const b=V=>{this.editorDiv.style.fontSize=`calc(${V}px * var(--scale-factor))`,this.translate(0,-(V-t(this,st))*this.parentScale),_(this,st,V),A(this,Tt,Qs).call(this)},G=t(this,st);this.addCommands({cmd:b.bind(this,r),undo:b.bind(this,G),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Mn=function(r){const b=V=>{_(this,R,this.editorDiv.style.color=V)},G=t(this,R);this.addCommands({cmd:b.bind(this,r),undo:b.bind(this,G),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Rn=function(){var b;const r=[];this.editorDiv.normalize();for(const G of this.editorDiv.childNodes)r.push(A(b=Rt,Lt,Zs).call(b,G));return r.join(`
`)},Qs=function(){const[r,b]=this.parentDimensions;let G;if(this.isAttachedToDOM)G=this.div.getBoundingClientRect();else{const{currentLayer:V,div:at}=this,Ct=at.style.display,kt=at.classList.contains("hidden");at.classList.remove("hidden"),at.style.display="hidden",V.div.append(this.div),G=at.getBoundingClientRect(),at.remove(),at.style.display=Ct,at.classList.toggle("hidden",kt)}this.rotation%180===this.parentRotation%180?(this.width=G.width/r,this.height=G.height/b):(this.width=G.height/r,this.height=G.width/b),this.fixAndSetPosition()},Lt=new WeakSet,Zs=function(r){return(r.nodeType===Node.TEXT_NODE?r.nodeValue:r.innerText).replaceAll(pt,"")},ti=function(){if(this.editorDiv.replaceChildren(),!!t(this,L))for(const r of t(this,L).split(`
`)){const b=document.createElement("div");b.append(r?document.createTextNode(r):document.createElement("br")),this.editorDiv.append(b)}},Pn=function(){return t(this,L).replaceAll("\xA0"," ")},ki=function(r){return r.replaceAll(" ","\xA0")},kn=function(r){const{value:b,fontSize:G,color:V,pageIndex:at}=t(this,At);return this._hasBeenMoved||r.value!==b||r.fontSize!==G||r.color.some((Ct,kt)=>Ct!==V[kt])||r.pageIndex!==at},w(Rt,Lt),he(Rt,"_freeTextDefaultContent",""),he(Rt,"_internalPadding",0),he(Rt,"_defaultColor",null),he(Rt,"_defaultFontSize",10),he(Rt,"_type","freetext"),he(Rt,"_editorType",d.AnnotationEditorType.FREETEXT);let H=Rt;var I=dt(61),k=dt(259),j=dt(419);const lt=class lt extends J.AnnotationEditor{constructor(r){super({...r,name:"highlightEditor"});w(this,p);w(this,Qt,null);w(this,ue,0);w(this,be);w(this,Ut,null);w(this,le,null);w(this,ee,null);w(this,ce,null);w(this,Zt,0);w(this,Ot,null);w(this,bt,null);w(this,gt,null);w(this,S,!1);w(this,n,A(this,p,Fn).bind(this));w(this,s,null);w(this,a);w(this,h,null);w(this,l,"");w(this,g);w(this,u,"");this.color=r.color||lt._defaultColor,_(this,g,r.thickness||lt._defaultThickness),_(this,a,r.opacity||lt._defaultOpacity),_(this,be,r.boxes||null),_(this,u,r.methodOfCreation||""),_(this,l,r.text||""),this._isDraggable=!1,r.highlightId>-1?(_(this,S,!0),A(this,p,Di).call(this,r),A(this,p,Ls).call(this)):(_(this,Qt,r.anchorNode),_(this,ue,r.anchorOffset),_(this,ce,r.focusNode),_(this,Zt,r.focusOffset),A(this,p,Li).call(this),A(this,p,Ls).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const r=lt.prototype;return(0,d.shadow)(this,"_keyboardManager",new N.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],r._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],r._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],r._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],r._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:t(this,S)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:t(this,g),methodOfCreation:t(this,u)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(r){return{numberOfColors:r.get("color").size}}static initialize(r,b){var G;J.AnnotationEditor.initialize(r,b),lt._defaultColor||(lt._defaultColor=((G=b.highlightColors)==null?void 0:G.values().next().value)||"#fff066")}static updateDefaultParams(r,b){switch(r){case d.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:lt._defaultColor=b;break;case d.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:lt._defaultThickness=b;break}}translateInPage(r,b){}get toolbarPosition(){return t(this,s)}updateParams(r,b){switch(r){case d.AnnotationEditorParamsType.HIGHLIGHT_COLOR:A(this,p,Ln).call(this,b);break;case d.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:A(this,p,Dn).call(this,b);break}}static get defaultPropertiesToUpdate(){return[[d.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,lt._defaultColor],[d.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,lt._defaultThickness]]}get propertiesToUpdate(){return[[d.AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||lt._defaultColor],[d.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,t(this,g)||lt._defaultThickness],[d.AnnotationEditorParamsType.HIGHLIGHT_FREE,t(this,S)]]}async addEditToolbar(){const r=await super.addEditToolbar();return r?(this._uiManager.highlightColors&&(_(this,le,new k.ColorPicker({editor:this})),r.addColorPicker(t(this,le))),r):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(A(this,p,Ds).call(this))}getBaseTranslation(){return[0,0]}getRect(r,b){return super.getRect(r,b,A(this,p,Ds).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){A(this,p,Ii).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,p,Ls).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(r){var G;let b=!1;this.parent&&!r?A(this,p,Ii).call(this):r&&(A(this,p,Ls).call(this,r),b=!this.parent&&((G=this.div)==null?void 0:G.classList.contains("selectedEditor"))),super.setParent(r),this.show(this._isVisible),b&&this.select()}rotate(r){var V,at,Ct;const{drawLayer:b}=this.parent;let G;t(this,S)?(r=(r-this.rotation+360)%360,G=A(V=lt,W,_s).call(V,t(this,bt).box,r)):G=A(at=lt,W,_s).call(at,this,r),b.rotate(t(this,gt),r),b.rotate(t(this,h),r),b.updateBox(t(this,gt),G),b.updateBox(t(this,h),A(Ct=lt,W,_s).call(Ct,t(this,ee).box,r))}render(){if(this.div)return this.div;const r=super.render();t(this,l)&&(r.setAttribute("aria-label",t(this,l)),r.setAttribute("role","mark")),t(this,S)?r.classList.add("free"):this.div.addEventListener("keydown",t(this,n));const b=_(this,Ot,document.createElement("div"));r.append(b),b.setAttribute("aria-hidden","true"),b.className="internal",b.style.clipPath=t(this,Ut);const[G,V]=this.parentDimensions;return this.setDims(this.width*G,this.height*V),(0,N.bindEvents)(this,t(this,Ot),["pointerover","pointerleave"]),this.enableEditing(),r}pointerover(){this.parent.drawLayer.addClass(t(this,h),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(t(this,h),"hovered")}_moveCaret(r){switch(this.parent.unselect(this),r){case 0:case 2:A(this,p,ei).call(this,!0);break;case 1:case 3:A(this,p,ei).call(this,!1);break}}select(){var r,b;super.select(),t(this,h)&&((r=this.parent)==null||r.drawLayer.removeClass(t(this,h),"hovered"),(b=this.parent)==null||b.drawLayer.addClass(t(this,h),"selected"))}unselect(){var r;super.unselect(),t(this,h)&&((r=this.parent)==null||r.drawLayer.removeClass(t(this,h),"selected"),t(this,S)||A(this,p,ei).call(this,!1))}get _mustFixPosition(){return!t(this,S)}show(r=this._isVisible){super.show(r),this.parent&&(this.parent.drawLayer.show(t(this,gt),r),this.parent.drawLayer.show(t(this,h),r))}static startHighlighting(r,b,{target:G,x:V,y:at}){const{x:Ct,y:kt,width:_t,height:qt}=G.getBoundingClientRect(),jt=ve=>{A(this,W,Bn).call(this,r,ve)},pe={capture:!0,passive:!1},ge=ve=>{ve.preventDefault(),ve.stopPropagation()},me=ve=>{G.removeEventListener("pointermove",jt),window.removeEventListener("blur",me),window.removeEventListener("pointerup",me),window.removeEventListener("pointerdown",ge,pe),window.removeEventListener("contextmenu",j.noContextMenu),A(this,W,Un).call(this,r,ve)};window.addEventListener("blur",me),window.addEventListener("pointerup",me),window.addEventListener("pointerdown",ge,pe),window.addEventListener("contextmenu",j.noContextMenu),G.addEventListener("pointermove",jt),this._freeHighlight=new I.FreeOutliner({x:V,y:at},[Ct,kt,_t,qt],r.scale,this._defaultThickness/2,b,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=r.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static deserialize(r,b,G){var ve;const V=super.deserialize(r,b,G),{rect:[at,Ct,kt,_t],color:qt,quadPoints:jt}=r;V.color=d.Util.makeHexColor(...qt),_(V,a,r.opacity);const[pe,ge]=V.pageDimensions;V.width=(kt-at)/pe,V.height=(_t-Ct)/ge;const me=_(V,be,[]);for(let De=0;De<jt.length;De+=8)me.push({x:(jt[4]-kt)/pe,y:(_t-(1-jt[De+5]))/ge,width:(jt[De+2]-jt[De])/pe,height:(jt[De+5]-jt[De+1])/ge});return A(ve=V,p,Li).call(ve),V}serialize(r=!1){if(this.isEmpty()||r)return null;const b=this.getRect(0,0),G=J.AnnotationEditor._colorManager.convert(this.color);return{annotationType:d.AnnotationEditorType.HIGHLIGHT,color:G,opacity:t(this,a),thickness:t(this,g),quadPoints:A(this,p,On).call(this),outlines:A(this,p,Nn).call(this,b),pageIndex:this.pageIndex,rect:b,rotation:A(this,p,Ds).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};Qt=new WeakMap,ue=new WeakMap,be=new WeakMap,Ut=new WeakMap,le=new WeakMap,ee=new WeakMap,ce=new WeakMap,Zt=new WeakMap,Ot=new WeakMap,bt=new WeakMap,gt=new WeakMap,S=new WeakMap,n=new WeakMap,s=new WeakMap,a=new WeakMap,h=new WeakMap,l=new WeakMap,g=new WeakMap,u=new WeakMap,p=new WeakSet,Li=function(){const r=new I.Outliner(t(this,be),.001);_(this,bt,r.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=t(this,bt).box;const b=new I.Outliner(t(this,be),.0025,.001,this._uiManager.direction==="ltr");_(this,ee,b.getOutlines());const{lastPoint:G}=t(this,ee).box;_(this,s,[(G[0]-this.x)/this.width,(G[1]-this.y)/this.height])},Di=function({highlightOutlines:r,highlightId:b,clipPathId:G}){var jt,pe;if(_(this,bt,r),_(this,ee,r.getNewOutline(t(this,g)/2+1.5,.0025)),b>=0)_(this,gt,b),_(this,Ut,G),this.parent.drawLayer.finalizeLine(b,r),_(this,h,this.parent.drawLayer.highlightOutline(t(this,ee)));else if(this.parent){const ge=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(t(this,gt),r),this.parent.drawLayer.updateBox(t(this,gt),A(jt=lt,W,_s).call(jt,t(this,bt).box,(ge-this.rotation+360)%360)),this.parent.drawLayer.updateLine(t(this,h),t(this,ee)),this.parent.drawLayer.updateBox(t(this,h),A(pe=lt,W,_s).call(pe,t(this,ee).box,ge))}const{x:at,y:Ct,width:kt,height:_t}=r.box;switch(this.rotation){case 0:this.x=at,this.y=Ct,this.width=kt,this.height=_t;break;case 90:{const[ge,me]=this.parentDimensions;this.x=Ct,this.y=1-at,this.width=kt*me/ge,this.height=_t*ge/me;break}case 180:this.x=1-at,this.y=1-Ct,this.width=kt,this.height=_t;break;case 270:{const[ge,me]=this.parentDimensions;this.x=1-Ct,this.y=at,this.width=kt*me/ge,this.height=_t*ge/me;break}}const{lastPoint:qt}=t(this,ee).box;_(this,s,[(qt[0]-at)/kt,(qt[1]-Ct)/_t])},Ln=function(r){const b=V=>{var at,Ct;this.color=V,(at=this.parent)==null||at.drawLayer.changeColor(t(this,gt),V),(Ct=t(this,le))==null||Ct.updateColor(V)},G=this.color;this.addCommands({cmd:b.bind(this,r),undo:b.bind(this,G),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(r)},!0)},Dn=function(r){const b=t(this,g),G=V=>{_(this,g,V),A(this,p,In).call(this,V)};this.addCommands({cmd:G.bind(this,r),undo:G.bind(this,b),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:r},!0)},In=function(r){if(!t(this,S))return;A(this,p,Di).call(this,{highlightOutlines:t(this,bt).getNewOutline(r/2)}),this.fixAndSetPosition();const[b,G]=this.parentDimensions;this.setDims(this.width*b,this.height*G)},Ii=function(){t(this,gt)===null||!this.parent||(this.parent.drawLayer.remove(t(this,gt)),_(this,gt,null),this.parent.drawLayer.remove(t(this,h)),_(this,h,null))},Ls=function(r=this.parent){t(this,gt)===null&&({id:Je(this,gt)._,clipPathId:Je(this,Ut)._}=r.drawLayer.highlight(t(this,bt),this.color,t(this,a)),_(this,h,r.drawLayer.highlightOutline(t(this,ee))),t(this,Ot)&&(t(this,Ot).style.clipPath=t(this,Ut)))},W=new WeakSet,_s=function({x:r,y:b,width:G,height:V},at){switch(at){case 90:return{x:1-b-V,y:r,width:V,height:G};case 180:return{x:1-r-G,y:1-b-V,width:G,height:V};case 270:return{x:b,y:1-r-G,width:V,height:G}}return{x:r,y:b,width:G,height:V}},Fn=function(r){lt._keyboardManager.exec(this,r)},ei=function(r){if(!t(this,Qt))return;const b=window.getSelection();r?b.setPosition(t(this,Qt),t(this,ue)):b.setPosition(t(this,ce),t(this,Zt))},Ds=function(){return t(this,S)?this.rotation:0},On=function(){if(t(this,S))return null;const[r,b]=this.pageDimensions,G=t(this,be),V=new Array(G.length*8);let at=0;for(const{x:Ct,y:kt,width:_t,height:qt}of G){const jt=Ct*r,pe=(1-kt-qt)*b;V[at]=V[at+4]=jt,V[at+1]=V[at+3]=pe,V[at+2]=V[at+6]=jt+_t*r,V[at+5]=V[at+7]=pe+qt*b,at+=8}return V},Nn=function(r){return t(this,bt).serialize(r,A(this,p,Ds).call(this))},Bn=function(r,b){this._freeHighlight.add(b)&&r.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},Un=function(r,b){this._freeHighlight.isEmpty()?r.drawLayer.removeFreeHighlight(this._freeHighlightId):r.createAndAddNewEditor(b,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},w(lt,W),he(lt,"_defaultColor",null),he(lt,"_defaultOpacity",1),he(lt,"_defaultThickness",12),he(lt,"_l10nPromise"),he(lt,"_type","highlight"),he(lt,"_editorType",d.AnnotationEditorType.HIGHLIGHT),he(lt,"_freeHighlightId",-1),he(lt,"_freeHighlight",null),he(lt,"_freeHighlightClipId","");let x=lt;const Ee=class Ee extends J.AnnotationEditor{constructor(r){super({...r,name:"inkEditor"});w(this,E);w(this,ut,0);w(this,C,0);w(this,X,this.canvasPointermove.bind(this));w(this,Q,this.canvasPointerleave.bind(this));w(this,vt,this.canvasPointerup.bind(this));w(this,xt,this.canvasPointerdown.bind(this));w(this,Pt,null);w(this,Bt,new Path2D);w(this,te,!1);w(this,de,!1);w(this,Ae,!1);w(this,_e,null);w(this,$t,0);w(this,v,0);w(this,f,null);this.color=r.color||null,this.thickness=r.thickness||null,this.opacity=r.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(r,b){J.AnnotationEditor.initialize(r,b)}static updateDefaultParams(r,b){switch(r){case d.AnnotationEditorParamsType.INK_THICKNESS:Ee._defaultThickness=b;break;case d.AnnotationEditorParamsType.INK_COLOR:Ee._defaultColor=b;break;case d.AnnotationEditorParamsType.INK_OPACITY:Ee._defaultOpacity=b/100;break}}updateParams(r,b){switch(r){case d.AnnotationEditorParamsType.INK_THICKNESS:A(this,E,Hn).call(this,b);break;case d.AnnotationEditorParamsType.INK_COLOR:A(this,E,zn).call(this,b);break;case d.AnnotationEditorParamsType.INK_OPACITY:A(this,E,jn).call(this,b);break}}static get defaultPropertiesToUpdate(){return[[d.AnnotationEditorParamsType.INK_THICKNESS,Ee._defaultThickness],[d.AnnotationEditorParamsType.INK_COLOR,Ee._defaultColor||J.AnnotationEditor._defaultLineColor],[d.AnnotationEditorParamsType.INK_OPACITY,Math.round(Ee._defaultOpacity*100)]]}get propertiesToUpdate(){return[[d.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Ee._defaultThickness],[d.AnnotationEditorParamsType.INK_COLOR,this.color||Ee._defaultColor||J.AnnotationEditor._defaultLineColor],[d.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Ee._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(A(this,E,si).call(this),A(this,E,ii).call(this)),this.isAttachedToDOM||(this.parent.add(this),A(this,E,ws).call(this)),A(this,E,Is).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,Pt)&&(clearTimeout(t(this,Pt)),_(this,Pt,null)),t(this,_e).disconnect(),_(this,_e,null),super.remove())}setParent(r){!this.parent&&r?this._uiManager.removeShouldRescale(this):this.parent&&r===null&&this._uiManager.addShouldRescale(this),super.setParent(r)}onScaleChanging(){const[r,b]=this.parentDimensions,G=this.width*r,V=this.height*b;this.setDimensions(G,V)}enableEditMode(){t(this,te)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,xt)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,xt)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,te)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),_(this,te,!0),this.div.classList.add("disabled"),A(this,E,Is).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(r){this._focusEventsAllowed&&(super.focusin(r),this.enableEditMode())}canvasPointerdown(r){r.button!==0||!this.isInEditMode()||t(this,te)||(this.setInForeground(),r.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),A(this,E,qn).call(this,r.offsetX,r.offsetY))}canvasPointermove(r){r.preventDefault(),A(this,E,Oi).call(this,r.offsetX,r.offsetY)}canvasPointerup(r){r.preventDefault(),A(this,E,Ni).call(this,r)}canvasPointerleave(r){A(this,E,Ni).call(this,r)}get isResizable(){return!this.isEmpty()&&t(this,te)}render(){if(this.div)return this.div;let r,b;this.width&&(r=this.x,b=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[G,V,at,Ct]=A(this,E,Gn).call(this);if(this.setAt(G,V,0,0),this.setDims(at,Ct),A(this,E,si).call(this),this.width){const[kt,_t]=this.parentDimensions;this.setAspectRatio(this.width*kt,this.height*_t),this.setAt(r*kt,b*_t,this.width*kt,this.height*_t),_(this,Ae,!0),A(this,E,ws).call(this),this.setDims(this.width*kt,this.height*_t),A(this,E,cs).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return A(this,E,ii).call(this),this.div}setDimensions(r,b){const G=Math.round(r),V=Math.round(b);if(t(this,$t)===G&&t(this,v)===V)return;_(this,$t,G),_(this,v,V),this.canvas.style.visibility="hidden";const[at,Ct]=this.parentDimensions;this.width=r/at,this.height=b/Ct,this.fixAndSetPosition(),t(this,te)&&A(this,E,Bi).call(this,r,b),A(this,E,ws).call(this),A(this,E,cs).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(r,b,G){var De,Ce,ke;if(r instanceof Y.InkAnnotationElement)return null;const V=super.deserialize(r,b,G);V.thickness=r.thickness,V.color=d.Util.makeHexColor(...r.color),V.opacity=r.opacity;const[at,Ct]=V.pageDimensions,kt=V.width*at,_t=V.height*Ct,qt=V.parentScale,jt=r.thickness/2;_(V,te,!0),_(V,$t,Math.round(kt)),_(V,v,Math.round(_t));const{paths:pe,rect:ge,rotation:me}=r;for(let{bezier:Pe}of pe){Pe=A(De=Ee,Ie,Jn).call(De,Pe,ge,me);const We=[];V.paths.push(We);let Cs=qt*(Pe[0]-jt),Ts=qt*(Pe[1]-jt);for(let je=2,bi=Pe.length;je<bi;je+=6){const Ai=qt*(Pe[je]-jt),qs=qt*(Pe[je+1]-jt),Vs=qt*(Pe[je+2]-jt),Ws=qt*(Pe[je+3]-jt),Ms=qt*(Pe[je+4]-jt),mn=qt*(Pe[je+5]-jt);We.push([[Cs,Ts],[Ai,qs],[Vs,Ws],[Ms,mn]]),Cs=Ms,Ts=mn}const Gs=A(this,Ie,Yn).call(this,We);V.bezierPath2D.push(Gs)}const ve=A(Ce=V,E,Hi).call(Ce);return _(V,C,Math.max(J.AnnotationEditor.MIN_SIZE,ve[2]-ve[0])),_(V,ut,Math.max(J.AnnotationEditor.MIN_SIZE,ve[3]-ve[1])),A(ke=V,E,Bi).call(ke,kt,_t),V}serialize(){if(this.isEmpty())return null;const r=this.getRect(0,0),b=J.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:d.AnnotationEditorType.INK,color:b,thickness:this.thickness,opacity:this.opacity,paths:A(this,E,Qn).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,r),pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};ut=new WeakMap,C=new WeakMap,X=new WeakMap,Q=new WeakMap,vt=new WeakMap,xt=new WeakMap,Pt=new WeakMap,Bt=new WeakMap,te=new WeakMap,de=new WeakMap,Ae=new WeakMap,_e=new WeakMap,$t=new WeakMap,v=new WeakMap,f=new WeakMap,E=new WeakSet,Hn=function(r){const b=V=>{this.thickness=V,A(this,E,Is).call(this)},G=this.thickness;this.addCommands({cmd:b.bind(this,r),undo:b.bind(this,G),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},zn=function(r){const b=V=>{this.color=V,A(this,E,cs).call(this)},G=this.color;this.addCommands({cmd:b.bind(this,r),undo:b.bind(this,G),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},jn=function(r){const b=V=>{this.opacity=V,A(this,E,cs).call(this)};r/=100;const G=this.opacity;this.addCommands({cmd:b.bind(this,r),undo:b.bind(this,G),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:d.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Gn=function(){const{parentRotation:r,parentDimensions:[b,G]}=this;switch(r){case 90:return[0,G,G,b];case 180:return[b,G,b,G];case 270:return[b,0,G,b];default:return[0,0,b,G]}},Fi=function(){const{ctx:r,color:b,opacity:G,thickness:V,parentScale:at,scaleFactor:Ct}=this;r.lineWidth=V*at/Ct,r.lineCap="round",r.lineJoin="round",r.miterLimit=10,r.strokeStyle=`${b}${(0,N.opacityToHex)(G)}`},qn=function(r,b){this.canvas.addEventListener("contextmenu",j.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,Q)),this.canvas.addEventListener("pointermove",t(this,X)),this.canvas.addEventListener("pointerup",t(this,vt)),this.canvas.removeEventListener("pointerdown",t(this,xt)),this.isEditing=!0,t(this,Ae)||(_(this,Ae,!0),A(this,E,ws).call(this),this.thickness||(this.thickness=Ee._defaultThickness),this.color||(this.color=Ee._defaultColor||J.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Ee._defaultOpacity)),this.currentPath.push([r,b]),_(this,de,!1),A(this,E,Fi).call(this),_(this,f,()=>{A(this,E,$n).call(this),t(this,f)&&window.requestAnimationFrame(t(this,f))}),window.requestAnimationFrame(t(this,f))},Oi=function(r,b){const[G,V]=this.currentPath.at(-1);if(this.currentPath.length>1&&r===G&&b===V)return;const at=this.currentPath;let Ct=t(this,Bt);if(at.push([r,b]),_(this,de,!0),at.length<=2){Ct.moveTo(...at[0]),Ct.lineTo(r,b);return}at.length===3&&(_(this,Bt,Ct=new Path2D),Ct.moveTo(...at[0])),A(this,E,Xn).call(this,Ct,...at.at(-3),...at.at(-2),r,b)},Vn=function(){if(this.currentPath.length===0)return;const r=this.currentPath.at(-1);t(this,Bt).lineTo(...r)},Wn=function(r,b){_(this,f,null),r=Math.min(Math.max(r,0),this.canvas.width),b=Math.min(Math.max(b,0),this.canvas.height),A(this,E,Oi).call(this,r,b),A(this,E,Vn).call(this);let G;if(this.currentPath.length!==1)G=A(this,E,Kn).call(this);else{const _t=[r,b];G=[[_t,_t.slice(),_t.slice(),_t]]}const V=t(this,Bt),at=this.currentPath;this.currentPath=[],_(this,Bt,new Path2D);const Ct=()=>{this.allRawPaths.push(at),this.paths.push(G),this.bezierPath2D.push(V),this._uiManager.rebuild(this)},kt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(A(this,E,si).call(this),A(this,E,ii).call(this)),A(this,E,Is).call(this))};this.addCommands({cmd:Ct,undo:kt,mustExec:!0})},$n=function(){if(!t(this,de))return;_(this,de,!1);const r=Math.ceil(this.thickness*this.parentScale),b=this.currentPath.slice(-3),G=b.map(Ct=>Ct[0]),V=b.map(Ct=>Ct[1]);Math.min(...G)-r,Math.max(...G)+r,Math.min(...V)-r,Math.max(...V)+r;const{ctx:at}=this;at.save(),at.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Ct of this.bezierPath2D)at.stroke(Ct);at.stroke(t(this,Bt)),at.restore()},Xn=function(r,b,G,V,at,Ct,kt){const _t=(b+V)/2,qt=(G+at)/2,jt=(V+Ct)/2,pe=(at+kt)/2;r.bezierCurveTo(_t+2*(V-_t)/3,qt+2*(at-qt)/3,jt+2*(V-jt)/3,pe+2*(at-pe)/3,jt,pe)},Kn=function(){const r=this.currentPath;if(r.length<=2)return[[r[0],r[0],r.at(-1),r.at(-1)]];const b=[];let G,[V,at]=r[0];for(G=1;G<r.length-2;G++){const[ge,me]=r[G],[ve,De]=r[G+1],Ce=(ge+ve)/2,ke=(me+De)/2,Pe=[V+2*(ge-V)/3,at+2*(me-at)/3],We=[Ce+2*(ge-Ce)/3,ke+2*(me-ke)/3];b.push([[V,at],Pe,We,[Ce,ke]]),[V,at]=[Ce,ke]}const[Ct,kt]=r[G],[_t,qt]=r[G+1],jt=[V+2*(Ct-V)/3,at+2*(kt-at)/3],pe=[_t+2*(Ct-_t)/3,qt+2*(kt-qt)/3];return b.push([[V,at],jt,pe,[_t,qt]]),b},cs=function(){if(this.isEmpty()){A(this,E,ni).call(this);return}A(this,E,Fi).call(this);const{canvas:r,ctx:b}=this;b.setTransform(1,0,0,1,0,0),b.clearRect(0,0,r.width,r.height),A(this,E,ni).call(this);for(const G of this.bezierPath2D)b.stroke(G)},Ni=function(r){this.canvas.removeEventListener("pointerleave",t(this,Q)),this.canvas.removeEventListener("pointermove",t(this,X)),this.canvas.removeEventListener("pointerup",t(this,vt)),this.canvas.addEventListener("pointerdown",t(this,xt)),t(this,Pt)&&clearTimeout(t(this,Pt)),_(this,Pt,setTimeout(()=>{_(this,Pt,null),this.canvas.removeEventListener("contextmenu",j.noContextMenu)},10)),A(this,E,Wn).call(this,r.offsetX,r.offsetY),this.addToAnnotationStorage(),this.setInBackground()},si=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},ii=function(){_(this,_e,new ResizeObserver(r=>{const b=r[0].contentRect;b.width&&b.height&&this.setDimensions(b.width,b.height)})),t(this,_e).observe(this.div)},ws=function(){if(!t(this,Ae))return;const[r,b]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*r),this.canvas.height=Math.ceil(this.height*b),A(this,E,ni).call(this)},Bi=function(r,b){const G=A(this,E,ri).call(this),V=(r-G)/t(this,C),at=(b-G)/t(this,ut);this.scaleFactor=Math.min(V,at)},ni=function(){const r=A(this,E,ri).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+r,this.translationY*this.scaleFactor+r)},Ie=new WeakSet,Yn=function(r){const b=new Path2D;for(let G=0,V=r.length;G<V;G++){const[at,Ct,kt,_t]=r[G];G===0&&b.moveTo(...at),b.bezierCurveTo(Ct[0],Ct[1],kt[0],kt[1],_t[0],_t[1])}return b},Ui=function(r,b,G){const[V,at,Ct,kt]=b;switch(G){case 0:for(let _t=0,qt=r.length;_t<qt;_t+=2)r[_t]+=V,r[_t+1]=kt-r[_t+1];break;case 90:for(let _t=0,qt=r.length;_t<qt;_t+=2){const jt=r[_t];r[_t]=r[_t+1]+V,r[_t+1]=jt+at}break;case 180:for(let _t=0,qt=r.length;_t<qt;_t+=2)r[_t]=Ct-r[_t],r[_t+1]+=at;break;case 270:for(let _t=0,qt=r.length;_t<qt;_t+=2){const jt=r[_t];r[_t]=Ct-r[_t+1],r[_t+1]=kt-jt}break;default:throw new Error("Invalid rotation")}return r},Jn=function(r,b,G){const[V,at,Ct,kt]=b;switch(G){case 0:for(let _t=0,qt=r.length;_t<qt;_t+=2)r[_t]-=V,r[_t+1]=kt-r[_t+1];break;case 90:for(let _t=0,qt=r.length;_t<qt;_t+=2){const jt=r[_t];r[_t]=r[_t+1]-at,r[_t+1]=jt-V}break;case 180:for(let _t=0,qt=r.length;_t<qt;_t+=2)r[_t]=Ct-r[_t],r[_t+1]-=at;break;case 270:for(let _t=0,qt=r.length;_t<qt;_t+=2){const jt=r[_t];r[_t]=kt-r[_t+1],r[_t+1]=Ct-jt}break;default:throw new Error("Invalid rotation")}return r},Qn=function(r,b,G,V){var qt,jt;const at=[],Ct=this.thickness/2,kt=r*b+Ct,_t=r*G+Ct;for(const pe of this.paths){const ge=[],me=[];for(let ve=0,De=pe.length;ve<De;ve++){const[Ce,ke,Pe,We]=pe[ve];if(Ce[0]===We[0]&&Ce[1]===We[1]&&De===1){const Ws=r*Ce[0]+kt,Ms=r*Ce[1]+_t;ge.push(Ws,Ms),me.push(Ws,Ms);break}const Cs=r*Ce[0]+kt,Ts=r*Ce[1]+_t,Gs=r*ke[0]+kt,je=r*ke[1]+_t,bi=r*Pe[0]+kt,Ai=r*Pe[1]+_t,qs=r*We[0]+kt,Vs=r*We[1]+_t;ve===0&&(ge.push(Cs,Ts),me.push(Cs,Ts)),ge.push(Gs,je,bi,Ai,qs,Vs),me.push(Gs,je),ve===De-1&&me.push(qs,Vs)}at.push({bezier:A(qt=Ee,Ie,Ui).call(qt,ge,V,this.rotation),points:A(jt=Ee,Ie,Ui).call(jt,me,V,this.rotation)})}return at},Hi=function(){let r=1/0,b=-1/0,G=1/0,V=-1/0;for(const at of this.paths)for(const[Ct,kt,_t,qt]of at){const jt=d.Util.bezierBoundingBox(...Ct,...kt,..._t,...qt);r=Math.min(r,jt[0]),G=Math.min(G,jt[1]),b=Math.max(b,jt[2]),V=Math.max(V,jt[3])}return[r,G,b,V]},ri=function(){return t(this,te)?Math.ceil(this.thickness*this.parentScale):0},Is=function(r=!1){if(this.isEmpty())return;if(!t(this,te)){A(this,E,cs).call(this);return}const b=A(this,E,Hi).call(this),G=A(this,E,ri).call(this);_(this,C,Math.max(J.AnnotationEditor.MIN_SIZE,b[2]-b[0])),_(this,ut,Math.max(J.AnnotationEditor.MIN_SIZE,b[3]-b[1]));const V=Math.ceil(G+t(this,C)*this.scaleFactor),at=Math.ceil(G+t(this,ut)*this.scaleFactor),[Ct,kt]=this.parentDimensions;this.width=V/Ct,this.height=at/kt,this.setAspectRatio(V,at);const _t=this.translationX,qt=this.translationY;this.translationX=-b[0],this.translationY=-b[1],A(this,E,ws).call(this),A(this,E,cs).call(this),_(this,$t,V),_(this,v,at),this.setDims(V,at);const jt=r?G/this.scaleFactor/2:0;this.translate(_t-this.translationX-jt,qt-this.translationY-jt)},w(Ee,Ie),he(Ee,"_defaultColor",null),he(Ee,"_defaultOpacity",1),he(Ee,"_defaultThickness",1),he(Ee,"_type","ink"),he(Ee,"_editorType",d.AnnotationEditorType.INK);let y=Ee;const Ss=class Ss extends J.AnnotationEditor{constructor(r){super({...r,name:"stampEditor"});w(this,ye);w(this,Se,null);w(this,Le,null);w(this,Ze,null);w(this,$e,null);w(this,ts,null);w(this,ps,"");w(this,Ge,null);w(this,as,null);w(this,qe,null);w(this,He,!1);w(this,xs,!1);_(this,$e,r.bitmapUrl),_(this,ts,r.bitmapFile)}static initialize(r,b){J.AnnotationEditor.initialize(r,b)}static get supportedTypes(){const r=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,d.shadow)(this,"supportedTypes",r.map(b=>`image/${b}`))}static get supportedTypesStr(){return(0,d.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(r){return this.supportedTypes.includes(r)}static paste(r,b){b.pasteEditor(d.AnnotationEditorType.STAMP,{bitmapFile:r.getAsFile()})}remove(){var r,b;t(this,Le)&&(_(this,Se,null),this._uiManager.imageManager.deleteId(t(this,Le)),(r=t(this,Ge))==null||r.remove(),_(this,Ge,null),(b=t(this,as))==null||b.disconnect(),_(this,as,null),t(this,qe)&&(clearTimeout(t(this,qe)),_(this,qe,null))),super.remove()}rebuild(){if(!this.parent){t(this,Le)&&A(this,ye,ai).call(this);return}super.rebuild(),this.div!==null&&(t(this,Le)&&t(this,Ge)===null&&A(this,ye,ai).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,Ze)||t(this,Se)||t(this,$e)||t(this,ts)||t(this,Le))}get isResizable(){return!0}render(){if(this.div)return this.div;let r,b;if(this.width&&(r=this.x,b=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),t(this,Se)?A(this,ye,zi).call(this):A(this,ye,ai).call(this),this.width){const[G,V]=this.parentDimensions;this.setAt(r*G,b*V,this.width*G,this.height*V)}return this.div}getImageForAltText(){return t(this,Ge)}static deserialize(r,b,G){if(r instanceof Y.StampAnnotationElement)return null;const V=super.deserialize(r,b,G),{rect:at,bitmapUrl:Ct,bitmapId:kt,isSvg:_t,accessibilityData:qt}=r;kt&&G.imageManager.isValidId(kt)?_(V,Le,kt):_(V,$e,Ct),_(V,He,_t);const[jt,pe]=V.pageDimensions;return V.width=(at[2]-at[0])/jt,V.height=(at[3]-at[1])/pe,qt&&(V.altTextData=qt),V}serialize(r=!1,b=null){if(this.isEmpty())return null;const G={annotationType:d.AnnotationEditorType.STAMP,bitmapId:t(this,Le),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,He),structTreeParentId:this._structTreeParentId};if(r)return G.bitmapUrl=A(this,ye,oi).call(this,!0),G.accessibilityData=this.altTextData,G;const{decorative:V,altText:at}=this.altTextData;if(!V&&at&&(G.accessibilityData={type:"Figure",alt:at}),b===null)return G;b.stamps||(b.stamps=new Map);const Ct=t(this,He)?(G.rect[2]-G.rect[0])*(G.rect[3]-G.rect[1]):null;if(!b.stamps.has(t(this,Le)))b.stamps.set(t(this,Le),{area:Ct,serialized:G}),G.bitmap=A(this,ye,oi).call(this,!1);else if(t(this,He)){const kt=b.stamps.get(t(this,Le));Ct>kt.area&&(kt.area=Ct,kt.serialized.bitmap.close(),kt.serialized.bitmap=A(this,ye,oi).call(this,!1))}return G}};Se=new WeakMap,Le=new WeakMap,Ze=new WeakMap,$e=new WeakMap,ts=new WeakMap,ps=new WeakMap,Ge=new WeakMap,as=new WeakMap,qe=new WeakMap,He=new WeakMap,xs=new WeakMap,ye=new WeakSet,Fs=function(r,b=!1){if(!r){this.remove();return}_(this,Se,r.bitmap),b||(_(this,Le,r.id),_(this,He,r.isSvg)),r.file&&_(this,ps,r.file.name),A(this,ye,zi).call(this)},Os=function(){_(this,Ze,null),this._uiManager.enableWaiting(!1),t(this,Ge)&&this.div.focus()},ai=function(){if(t(this,Le)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,Le)).then(b=>A(this,ye,Fs).call(this,b,!0)).finally(()=>A(this,ye,Os).call(this));return}if(t(this,$e)){const b=t(this,$e);_(this,$e,null),this._uiManager.enableWaiting(!0),_(this,Ze,this._uiManager.imageManager.getFromUrl(b).then(G=>A(this,ye,Fs).call(this,G)).finally(()=>A(this,ye,Os).call(this)));return}if(t(this,ts)){const b=t(this,ts);_(this,ts,null),this._uiManager.enableWaiting(!0),_(this,Ze,this._uiManager.imageManager.getFromFile(b).then(G=>A(this,ye,Fs).call(this,G)).finally(()=>A(this,ye,Os).call(this)));return}const r=document.createElement("input");r.type="file",r.accept=Ss.supportedTypesStr,_(this,Ze,new Promise(b=>{r.addEventListener("change",async()=>{if(!r.files||r.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const G=await this._uiManager.imageManager.getFromFile(r.files[0]);A(this,ye,Fs).call(this,G)}b()}),r.addEventListener("cancel",()=>{this.remove(),b()})}).finally(()=>A(this,ye,Os).call(this))),r.click()},zi=function(){const{div:r}=this;let{width:b,height:G}=t(this,Se);const[V,at]=this.pageDimensions,Ct=.75;if(this.width)b=this.width*V,G=this.height*at;else if(b>Ct*V||G>Ct*at){const jt=Math.min(Ct*V/b,Ct*at/G);b*=jt,G*=jt}const[kt,_t]=this.parentDimensions;this.setDims(b*kt/V,G*_t/at),this._uiManager.enableWaiting(!1);const qt=_(this,Ge,document.createElement("canvas"));r.append(qt),r.hidden=!1,A(this,ye,ji).call(this,b,G),A(this,ye,er).call(this),t(this,xs)||(this.parent.addUndoableEditor(this),_(this,xs,!0)),this._reportTelemetry({action:"inserted_image"}),t(this,ps)&&qt.setAttribute("aria-label",t(this,ps))},Zn=function(r,b){var Ct;const[G,V]=this.parentDimensions;this.width=r/G,this.height=b/V,this.setDims(r,b),(Ct=this._initialOptions)!=null&&Ct.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,qe)!==null&&clearTimeout(t(this,qe)),_(this,qe,setTimeout(()=>{_(this,qe,null),A(this,ye,ji).call(this,r,b)},200))},tr=function(r,b){const{width:G,height:V}=t(this,Se);let at=G,Ct=V,kt=t(this,Se);for(;at>2*r||Ct>2*b;){const _t=at,qt=Ct;at>2*r&&(at=at>=16384?Math.floor(at/2)-1:Math.ceil(at/2)),Ct>2*b&&(Ct=Ct>=16384?Math.floor(Ct/2)-1:Math.ceil(Ct/2));const jt=new OffscreenCanvas(at,Ct);jt.getContext("2d").drawImage(kt,0,0,_t,qt,0,0,at,Ct),kt=jt.transferToImageBitmap()}return kt},ji=function(r,b){r=Math.ceil(r),b=Math.ceil(b);const G=t(this,Ge);if(!G||G.width===r&&G.height===b)return;G.width=r,G.height=b;const V=t(this,He)?t(this,Se):A(this,ye,tr).call(this,r,b);if(this._uiManager.hasMLManager&&!this.hasAltText()){const Ct=new OffscreenCanvas(r,b);Ct.getContext("2d").drawImage(V,0,0,V.width,V.height,0,0,r,b),Ct.convertToBlob().then(kt=>{const _t=new FileReader;_t.onload=()=>{const qt=_t.result;this._uiManager.mlGuess({service:"image-to-text",request:{imageData:qt}}).then(jt=>{const pe=(jt==null?void 0:jt.output)||"";this.parent&&pe&&!this.hasAltText()&&(this.altTextData={altText:pe,decorative:!1})})},_t.readAsDataURL(kt)})}const at=G.getContext("2d");at.filter=this._uiManager.hcmFilter,at.drawImage(V,0,0,V.width,V.height,0,0,r,b)},oi=function(r){if(r){if(t(this,He)){const G=this._uiManager.imageManager.getSvgUrl(t(this,Le));if(G)return G}const b=document.createElement("canvas");return{width:b.width,height:b.height}=t(this,Se),b.getContext("2d").drawImage(t(this,Se),0,0),b.toDataURL()}if(t(this,He)){const[b,G]=this.pageDimensions,V=Math.round(this.width*b*j.PixelsPerInch.PDF_TO_CSS_UNITS),at=Math.round(this.height*G*j.PixelsPerInch.PDF_TO_CSS_UNITS),Ct=new OffscreenCanvas(V,at);return Ct.getContext("2d").drawImage(t(this,Se),0,0,t(this,Se).width,t(this,Se).height,0,0,V,at),Ct.transferToImageBitmap()}return structuredClone(t(this,Se))},er=function(){_(this,as,new ResizeObserver(r=>{const b=r[0].contentRect;b.width&&b.height&&A(this,ye,Zn).call(this,b.width,b.height)})),t(this,as).observe(this.div)},he(Ss,"_type","stamp"),he(Ss,"_editorType",d.AnnotationEditorType.STAMP);let F=Ss;const ze=class ze{constructor({uiManager:rt,pageIndex:r,div:b,accessibilityManager:G,annotationLayer:V,drawLayer:at,textLayer:Ct,viewport:kt,l10n:_t}){w(this,Fe);w(this,os);w(this,gs,!1);w(this,Ve,null);w(this,hs,null);w(this,Xe,null);w(this,Ke,null);w(this,Ye,null);w(this,Be,new Map);w(this,es,!1);w(this,fs,!1);w(this,ms,!1);w(this,Oe,null);w(this,ie);const qt=[...t(ze,ss).values()];if(!ze._initialized){ze._initialized=!0;for(const jt of qt)jt.initialize(_t,rt)}rt.registerEditorTypes(qt),_(this,ie,rt),this.pageIndex=r,this.div=b,_(this,os,G),_(this,Ve,V),this.viewport=kt,_(this,Oe,Ct),this.drawLayer=at,t(this,ie).addLayer(this)}get isEmpty(){return t(this,Be).size===0}get isInvisible(){return this.isEmpty&&t(this,ie).getMode()===d.AnnotationEditorType.NONE}updateToolbar(rt){t(this,ie).updateToolbar(rt)}updateMode(rt=t(this,ie).getMode()){switch(A(this,Fe,hi).call(this),rt){case d.AnnotationEditorType.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case d.AnnotationEditorType.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case d.AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:r}=this.div;for(const b of t(ze,ss).values())r.toggle(`${b._type}Editing`,rt===b._editorType);this.div.hidden=!1}hasTextLayer(rt){var r;return rt===((r=t(this,Oe))==null?void 0:r.div)}addInkEditorIfNeeded(rt){if(t(this,ie).getMode()===d.AnnotationEditorType.INK){if(!rt){for(const r of t(this,Be).values())if(r.isEmpty()){r.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(rt){t(this,ie).setEditingState(rt)}addCommands(rt){t(this,ie).addCommands(rt)}togglePointerEvents(rt=!1){this.div.classList.toggle("disabled",!rt)}toggleAnnotationLayerPointerEvents(rt=!1){var r;(r=t(this,Ve))==null||r.div.classList.toggle("disabled",!rt)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const rt=new Set;for(const b of t(this,Be).values())b.enableEditing(),b.show(!0),b.annotationElementId&&(t(this,ie).removeChangedExistingAnnotation(b),rt.add(b.annotationElementId));if(!t(this,Ve))return;const r=t(this,Ve).getEditableAnnotations();for(const b of r){if(b.hide(),t(this,ie).isDeletedAnnotationElement(b.data.id)||rt.has(b.data.id))continue;const G=this.deserialize(b);G&&(this.addOrRebuild(G),G.enableEditing())}}disable(){var G;_(this,ms,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const rt=new Map,r=new Map;for(const V of t(this,Be).values())if(V.disableEditing(),!!V.annotationElementId){if(V.serialize()!==null){rt.set(V.annotationElementId,V);continue}else r.set(V.annotationElementId,V);(G=this.getEditableAnnotation(V.annotationElementId))==null||G.show(),V.remove()}if(t(this,Ve)){const V=t(this,Ve).getEditableAnnotations();for(const at of V){const{id:Ct}=at.data;if(t(this,ie).isDeletedAnnotationElement(Ct))continue;let kt=r.get(Ct);if(kt){kt.resetAnnotationElement(at),kt.show(!1),at.show();continue}kt=rt.get(Ct),kt&&(t(this,ie).addChangedExistingAnnotation(kt),kt.renderAnnotationElement(at),kt.show(!1)),at.show()}}A(this,Fe,hi).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:b}=this.div;for(const V of t(ze,ss).values())b.remove(`${V._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),_(this,ms,!1)}getEditableAnnotation(rt){var r;return((r=t(this,Ve))==null?void 0:r.getEditableAnnotation(rt))||null}setActiveEditor(rt){t(this,ie).getActive()!==rt&&t(this,ie).setActiveEditor(rt)}enableTextSelection(){var rt;this.div.tabIndex=-1,(rt=t(this,Oe))!=null&&rt.div&&!t(this,Ke)&&(_(this,Ke,A(this,Fe,sr).bind(this)),t(this,Oe).div.addEventListener("pointerdown",t(this,Ke)),t(this,Oe).div.classList.add("highlighting"))}disableTextSelection(){var rt;this.div.tabIndex=0,(rt=t(this,Oe))!=null&&rt.div&&t(this,Ke)&&(t(this,Oe).div.removeEventListener("pointerdown",t(this,Ke)),_(this,Ke,null),t(this,Oe).div.classList.remove("highlighting"))}enableClick(){t(this,Xe)||(_(this,Xe,this.pointerdown.bind(this)),_(this,hs,this.pointerup.bind(this)),this.div.addEventListener("pointerdown",t(this,Xe)),this.div.addEventListener("pointerup",t(this,hs)))}disableClick(){t(this,Xe)&&(this.div.removeEventListener("pointerdown",t(this,Xe)),this.div.removeEventListener("pointerup",t(this,hs)),_(this,Xe,null),_(this,hs,null))}attach(rt){t(this,Be).set(rt.id,rt);const{annotationElementId:r}=rt;r&&t(this,ie).isDeletedAnnotationElement(r)&&t(this,ie).removeDeletedAnnotationElement(rt)}detach(rt){var r;t(this,Be).delete(rt.id),(r=t(this,os))==null||r.removePointerInTextLayer(rt.contentDiv),!t(this,ms)&&rt.annotationElementId&&t(this,ie).addDeletedAnnotationElement(rt)}remove(rt){this.detach(rt),t(this,ie).removeEditor(rt),rt.div.remove(),rt.isAttachedToDOM=!1,t(this,fs)||this.addInkEditorIfNeeded(!1)}changeParent(rt){var r;rt.parent!==this&&(rt.parent&&rt.annotationElementId&&(t(this,ie).addDeletedAnnotationElement(rt.annotationElementId),J.AnnotationEditor.deleteAnnotationElement(rt),rt.annotationElementId=null),this.attach(rt),(r=rt.parent)==null||r.detach(rt),rt.setParent(this),rt.div&&rt.isAttachedToDOM&&(rt.div.remove(),this.div.append(rt.div)))}add(rt){if(!(rt.parent===this&&rt.isAttachedToDOM)){if(this.changeParent(rt),t(this,ie).addEditor(rt),this.attach(rt),!rt.isAttachedToDOM){const r=rt.render();this.div.append(r),rt.isAttachedToDOM=!0}rt.fixAndSetPosition(),rt.onceAdded(),t(this,ie).addToAnnotationStorage(rt),rt._reportTelemetry(rt.telemetryInitialData)}}moveEditorInDOM(rt){var b;if(!rt.isAttachedToDOM)return;const{activeElement:r}=document;rt.div.contains(r)&&!t(this,Ye)&&(rt._focusEventsAllowed=!1,_(this,Ye,setTimeout(()=>{_(this,Ye,null),rt.div.contains(document.activeElement)?rt._focusEventsAllowed=!0:(rt.div.addEventListener("focusin",()=>{rt._focusEventsAllowed=!0},{once:!0}),r.focus())},0))),rt._structTreeParentId=(b=t(this,os))==null?void 0:b.moveElementInDOM(this.div,rt.div,rt.contentDiv,!0)}addOrRebuild(rt){rt.needsToBeRebuilt()?(rt.parent||(rt.parent=this),rt.rebuild(),rt.show()):this.add(rt)}addUndoableEditor(rt){const r=()=>rt._uiManager.rebuild(rt),b=()=>{rt.remove()};this.addCommands({cmd:r,undo:b,mustExec:!1})}getNextId(){return t(this,ie).getId()}canCreateNewEmptyEditor(){var rt;return(rt=t(this,Fe,Gi))==null?void 0:rt.canCreateNewEmptyEditor()}pasteEditor(rt,r){t(this,ie).updateToolbar(rt),t(this,ie).updateMode(rt);const{offsetX:b,offsetY:G}=A(this,Fe,Vi).call(this),V=this.getNextId(),at=A(this,Fe,qi).call(this,{parent:this,id:V,x:b,y:G,uiManager:t(this,ie),isCentered:!0,...r});at&&this.add(at)}deserialize(rt){var r;return((r=t(ze,ss).get(rt.annotationType??rt.annotationEditorType))==null?void 0:r.deserialize(rt,this,t(this,ie)))||null}createAndAddNewEditor(rt,r,b={}){const G=this.getNextId(),V=A(this,Fe,qi).call(this,{parent:this,id:G,x:rt.offsetX,y:rt.offsetY,uiManager:t(this,ie),isCentered:r,...b});return V&&this.add(V),V}addNewEditor(){this.createAndAddNewEditor(A(this,Fe,Vi).call(this),!0)}setSelected(rt){t(this,ie).setSelected(rt)}toggleSelected(rt){t(this,ie).toggleSelected(rt)}isSelected(rt){return t(this,ie).isSelected(rt)}unselect(rt){t(this,ie).unselect(rt)}pointerup(rt){const{isMac:r}=d.FeatureTest.platform;if(!(rt.button!==0||rt.ctrlKey&&r)&&rt.target===this.div&&t(this,es)){if(_(this,es,!1),!t(this,gs)){_(this,gs,!0);return}if(t(this,ie).getMode()===d.AnnotationEditorType.STAMP){t(this,ie).unselectAll();return}this.createAndAddNewEditor(rt,!1)}}pointerdown(rt){if(t(this,ie).getMode()===d.AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),t(this,es)){_(this,es,!1);return}const{isMac:r}=d.FeatureTest.platform;if(rt.button!==0||rt.ctrlKey&&r||rt.target!==this.div)return;_(this,es,!0);const b=t(this,ie).getActive();_(this,gs,!b||b.isEmpty())}findNewParent(rt,r,b){const G=t(this,ie).findParent(r,b);return G===null||G===this?!1:(G.changeParent(rt),!0)}destroy(){var rt,r;((rt=t(this,ie).getActive())==null?void 0:rt.parent)===this&&(t(this,ie).commitOrRemove(),t(this,ie).setActiveEditor(null)),t(this,Ye)&&(clearTimeout(t(this,Ye)),_(this,Ye,null));for(const b of t(this,Be).values())(r=t(this,os))==null||r.removePointerInTextLayer(b.contentDiv),b.setParent(null),b.isAttachedToDOM=!1,b.div.remove();this.div=null,t(this,Be).clear(),t(this,ie).removeLayer(this)}render({viewport:rt}){this.viewport=rt,(0,j.setLayerDimensions)(this.div,rt);for(const r of t(this,ie).getEditors(this.pageIndex))this.add(r),r.rebuild();this.updateMode()}update({viewport:rt}){t(this,ie).commitOrRemove(),A(this,Fe,hi).call(this);const r=this.viewport.rotation,b=rt.rotation;if(this.viewport=rt,(0,j.setLayerDimensions)(this.div,{rotation:b}),r!==b)for(const G of t(this,Be).values())G.rotate(b);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:rt,pageHeight:r}=this.viewport.rawDims;return[rt,r]}get scale(){return t(this,ie).viewParameters.realScale}};os=new WeakMap,gs=new WeakMap,Ve=new WeakMap,hs=new WeakMap,Xe=new WeakMap,Ke=new WeakMap,Ye=new WeakMap,Be=new WeakMap,es=new WeakMap,fs=new WeakMap,ms=new WeakMap,Oe=new WeakMap,ie=new WeakMap,ss=new WeakMap,Fe=new WeakSet,sr=function(rt){if(t(this,ie).unselectAll(),rt.target===t(this,Oe).div){const{isMac:r}=d.FeatureTest.platform;if(rt.button!==0||rt.ctrlKey&&r)return;t(this,ie).showAllEditors("highlight",!0,!0),t(this,Oe).div.classList.add("free"),x.startHighlighting(this,t(this,ie).direction==="ltr",rt),t(this,Oe).div.addEventListener("pointerup",()=>{t(this,Oe).div.classList.remove("free")},{once:!0}),rt.preventDefault()}},Gi=function(){return t(ze,ss).get(t(this,ie).getMode())},qi=function(rt){const r=t(this,Fe,Gi);return r?new r.prototype.constructor(rt):null},Vi=function(){const{x:rt,y:r,width:b,height:G}=this.div.getBoundingClientRect(),V=Math.max(0,rt),at=Math.max(0,r),Ct=Math.min(window.innerWidth,rt+b),kt=Math.min(window.innerHeight,r+G),_t=(V+Ct)/2-rt,qt=(at+kt)/2-r,[jt,pe]=this.viewport.rotation%180===0?[_t,qt]:[qt,_t];return{offsetX:jt,offsetY:pe}},hi=function(){_(this,fs,!0);for(const rt of t(this,Be).values())rt.isEmpty()&&rt.remove();_(this,fs,!1)},he(ze,"_initialized",!1),w(ze,ss,new Map([H,y,F,x].map(rt=>[rt._editorType,rt])));let D=ze},259:(se,Vt,dt)=>{var pt,H,I,k,j,x,y,F,D,Z,U,K,P,Wi,$i,ir,ds,nr,is;dt.d(Vt,{ColorPicker:()=>Y});var d=dt(292),J=dt(830),N=dt(419);const Tt=class Tt{constructor({editor:nt=null,uiManager:Mt=null}){w(this,P);w(this,pt,A(this,P,ir).bind(this));w(this,H,A(this,P,nr).bind(this));w(this,I,null);w(this,k,null);w(this,j);w(this,x,null);w(this,y,!1);w(this,F,!1);w(this,D,null);w(this,Z);w(this,U,null);w(this,K);var Dt;nt?(_(this,F,!1),_(this,K,d.AnnotationEditorParamsType.HIGHLIGHT_COLOR),_(this,D,nt)):(_(this,F,!0),_(this,K,d.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR)),_(this,U,(nt==null?void 0:nt._uiManager)||Mt),_(this,Z,t(this,U)._eventBus),_(this,j,(nt==null?void 0:nt.color)||((Dt=t(this,U))==null?void 0:Dt.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return(0,d.shadow)(this,"_keyboardManager",new J.KeyboardManager([[["Escape","mac+Escape"],Tt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Tt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Tt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Tt.prototype._moveToPrevious],[["Home","mac+Home"],Tt.prototype._moveToBeginning],[["End","mac+End"],Tt.prototype._moveToEnd]]))}renderButton(){const nt=_(this,I,document.createElement("button"));nt.className="colorPicker",nt.tabIndex="0",nt.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),nt.setAttribute("aria-haspopup",!0),nt.addEventListener("click",A(this,P,ds).bind(this)),nt.addEventListener("keydown",t(this,pt));const Mt=_(this,k,document.createElement("span"));return Mt.className="swatch",Mt.setAttribute("aria-hidden",!0),Mt.style.backgroundColor=t(this,j),nt.append(Mt),nt}renderMainDropdown(){const nt=_(this,x,A(this,P,Wi).call(this));return nt.setAttribute("aria-orientation","horizontal"),nt.setAttribute("aria-labelledby","highlightColorPickerLabel"),nt}_colorSelectFromKeyboard(nt){if(nt.target===t(this,I)){A(this,P,ds).call(this,nt);return}const Mt=nt.target.getAttribute("data-color");Mt&&A(this,P,$i).call(this,Mt,nt)}_moveToNext(nt){var Mt,Dt;if(!t(this,P,is)){A(this,P,ds).call(this,nt);return}if(nt.target===t(this,I)){(Mt=t(this,x).firstChild)==null||Mt.focus();return}(Dt=nt.target.nextSibling)==null||Dt.focus()}_moveToPrevious(nt){var Mt,Dt;if(nt.target===((Mt=t(this,x))==null?void 0:Mt.firstChild)||nt.target===t(this,I)){t(this,P,is)&&this._hideDropdownFromKeyboard();return}t(this,P,is)||A(this,P,ds).call(this,nt),(Dt=nt.target.previousSibling)==null||Dt.focus()}_moveToBeginning(nt){var Mt;if(!t(this,P,is)){A(this,P,ds).call(this,nt);return}(Mt=t(this,x).firstChild)==null||Mt.focus()}_moveToEnd(nt){var Mt;if(!t(this,P,is)){A(this,P,ds).call(this,nt);return}(Mt=t(this,x).lastChild)==null||Mt.focus()}hideDropdown(){var nt;(nt=t(this,x))==null||nt.classList.add("hidden"),window.removeEventListener("pointerdown",t(this,H))}_hideDropdownFromKeyboard(){var nt;if(!t(this,F)){if(!t(this,P,is)){(nt=t(this,D))==null||nt.unselect();return}this.hideDropdown(),t(this,I).focus({preventScroll:!0,focusVisible:t(this,y)})}}updateColor(nt){if(t(this,k)&&(t(this,k).style.backgroundColor=nt),!t(this,x))return;const Mt=t(this,U).highlightColors.values();for(const Dt of t(this,x).children)Dt.setAttribute("aria-selected",Mt.next().value===nt)}destroy(){var nt,Mt;(nt=t(this,I))==null||nt.remove(),_(this,I,null),_(this,k,null),(Mt=t(this,x))==null||Mt.remove(),_(this,x,null)}};pt=new WeakMap,H=new WeakMap,I=new WeakMap,k=new WeakMap,j=new WeakMap,x=new WeakMap,y=new WeakMap,F=new WeakMap,D=new WeakMap,Z=new WeakMap,U=new WeakMap,K=new WeakMap,P=new WeakSet,Wi=function(){const nt=document.createElement("div");nt.addEventListener("contextmenu",N.noContextMenu),nt.className="dropdown",nt.role="listbox",nt.setAttribute("aria-multiselectable",!1),nt.setAttribute("aria-orientation","vertical"),nt.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[Mt,Dt]of t(this,U).highlightColors){const Lt=document.createElement("button");Lt.tabIndex="0",Lt.role="option",Lt.setAttribute("data-color",Dt),Lt.title=Mt,Lt.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${Mt}`);const Xt=document.createElement("span");Lt.append(Xt),Xt.className="swatch",Xt.style.backgroundColor=Dt,Lt.setAttribute("aria-selected",Dt===t(this,j)),Lt.addEventListener("click",A(this,P,$i).bind(this,Dt)),nt.append(Lt)}return nt.addEventListener("keydown",t(this,pt)),nt},$i=function(nt,Mt){Mt.stopPropagation(),t(this,Z).dispatch("switchannotationeditorparams",{source:this,type:t(this,K),value:nt})},ir=function(nt){Tt._keyboardManager.exec(this,nt)},ds=function(nt){if(t(this,P,is)){this.hideDropdown();return}if(_(this,y,nt.detail===0),window.addEventListener("pointerdown",t(this,H)),t(this,x)){t(this,x).classList.remove("hidden");return}const Mt=_(this,x,A(this,P,Wi).call(this));t(this,I).append(Mt)},nr=function(nt){var Mt;(Mt=t(this,x))!=null&&Mt.contains(nt.target)||this.hideDropdown()},is=function(){return t(this,x)&&!t(this,x).classList.contains("hidden")};let Y=Tt},310:(se,Vt,dt)=>{var k,j,x,y,F,D,Z,U,Xi,B,R,L,ht,st,At,Tt,ot,nt,Mt,Dt,Lt,Xt,ae,Jt,ne,oe,Rt,Qt,ue,be,Ut,Ki,ee,Yi,Ji,rr,ar,Qi,Zi,tn,or,hr,lr,cr,en,Ns;dt.d(Vt,{AnnotationEditor:()=>H});var d=dt(830),J=dt(292),N=dt(419);const P=class P{constructor(e){w(this,U);w(this,k,"");w(this,j,!1);w(this,x,null);w(this,y,null);w(this,F,null);w(this,D,!1);w(this,Z,null);_(this,Z,e)}static initialize(e){P._l10nPromise||(P._l10nPromise=e)}async render(){const e=_(this,x,document.createElement("button"));e.className="altText";const i=await P._l10nPromise.get("pdfjs-editor-alt-text-button-label");e.textContent=i,e.setAttribute("aria-label",i),e.tabIndex="0",e.addEventListener("contextmenu",N.noContextMenu),e.addEventListener("pointerdown",m=>m.stopPropagation());const o=m=>{m.preventDefault(),t(this,Z)._uiManager.editAltText(t(this,Z))};return e.addEventListener("click",o,{capture:!0}),e.addEventListener("keydown",m=>{m.target===e&&m.key==="Enter"&&(_(this,D,!0),o(m))}),await A(this,U,Xi).call(this),e}finish(){t(this,x)&&(t(this,x).focus({focusVisible:t(this,D)}),_(this,D,!1))}isEmpty(){return!t(this,k)&&!t(this,j)}get data(){return{altText:t(this,k),decorative:t(this,j)}}set data({altText:e,decorative:i}){t(this,k)===e&&t(this,j)===i||(_(this,k,e),_(this,j,i),A(this,U,Xi).call(this))}toggle(e=!1){t(this,x)&&(!e&&t(this,F)&&(clearTimeout(t(this,F)),_(this,F,null)),t(this,x).disabled=!e)}destroy(){var e;(e=t(this,x))==null||e.remove(),_(this,x,null),_(this,y,null)}};k=new WeakMap,j=new WeakMap,x=new WeakMap,y=new WeakMap,F=new WeakMap,D=new WeakMap,Z=new WeakMap,U=new WeakSet,Xi=async function(){var o,m;const e=t(this,x);if(!e)return;if(!t(this,k)&&!t(this,j)){e.classList.remove("done"),(o=t(this,y))==null||o.remove();return}e.classList.add("done"),P._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(T=>{e.setAttribute("aria-label",T)});let i=t(this,y);if(!i){_(this,y,i=document.createElement("span")),i.className="tooltip",i.setAttribute("role","tooltip");const T=i.id=`alt-text-tooltip-${t(this,Z).id}`;e.setAttribute("aria-describedby",T);const $=100;e.addEventListener("mouseenter",()=>{_(this,F,setTimeout(()=>{_(this,F,null),t(this,y).classList.add("show"),t(this,Z)._reportTelemetry({action:"alt_text_tooltip"})},$))}),e.addEventListener("mouseleave",()=>{var W;t(this,F)&&(clearTimeout(t(this,F)),_(this,F,null)),(W=t(this,y))==null||W.classList.remove("show")})}i.innerText=t(this,j)?await P._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):t(this,k),i.parentNode||e.append(i),(m=t(this,Z).getImageForAltText())==null||m.setAttribute("aria-describedby",i.id)},he(P,"_l10nPromise",null);let Y=P;var pt=dt(362);const p=class p{constructor(e){w(this,Ut);w(this,B,null);w(this,R,null);w(this,L,!1);w(this,ht,!1);w(this,st,null);w(this,At,null);w(this,Tt,this.focusin.bind(this));w(this,ot,this.focusout.bind(this));w(this,nt,null);w(this,Mt,"");w(this,Dt,!1);w(this,Lt,null);w(this,Xt,!1);w(this,ae,!1);w(this,Jt,!1);w(this,ne,null);w(this,oe,0);w(this,Rt,0);w(this,Qt,null);he(this,"_initialOptions",Object.create(null));he(this,"_isVisible",!0);he(this,"_uiManager",null);he(this,"_focusEventsAllowed",!0);he(this,"_l10nPromise",null);w(this,ue,!1);w(this,be,p._zIndex++);this.constructor===p&&(0,J.unreachable)("Cannot initialize AnnotationEditor."),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:i,rawDims:{pageWidth:o,pageHeight:m,pageX:T,pageY:$}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[o,m],this.pageTranslation=[T,$];const[W,tt]=this.parentDimensions;this.x=e.x/W,this.y=e.y/tt,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=p.prototype._resizeWithKeyboard,i=d.AnnotationEditorUIManager.TRANSLATE_SMALL,o=d.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,J.shadow)(this,"_resizerKeyboardManager",new d.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-o,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[o,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-o]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,o]}],[["Escape","mac+Escape"],p.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,J.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const i=new I({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});i.annotationElementId=e.annotationElementId,i.deleted=!0,i._uiManager.addToAnnotationStorage(i)}static initialize(e,i,o){if(p._l10nPromise||(p._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(T=>[T,e.get(T.replaceAll(/([A-Z])/g,$=>`-${$.toLowerCase()}`))]))),o==null?void 0:o.strings)for(const T of o.strings)p._l10nPromise.set(T,e.get(T));if(p._borderLineWidth!==-1)return;const m=getComputedStyle(document.documentElement);p._borderLineWidth=parseFloat(m.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,i){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,i){(0,J.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,ue)}set _isDraggable(e){var i;_(this,ue,e),(i=this.div)==null||i.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,i]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*i/(e*2),this.y+=this.width*e/(i*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*i/(e*2),this.y-=this.width*e/(i*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,be)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):A(this,Ut,Ns).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(t(this,Dt)?_(this,Dt,!1):this.parent.setSelected(this))}focusout(e){var i,o;!this._focusEventsAllowed||!this.isAttachedToDOM||(i=e.relatedTarget)!=null&&i.closest(`#${this.id}`)||(e.preventDefault(),(o=this.parent)!=null&&o.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,i,o,m){const[T,$]=this.parentDimensions;[o,m]=this.screenToPageTranslation(o,m),this.x=(e+o)/T,this.y=(i+m)/$,this.fixAndSetPosition()}translate(e,i){A(this,Ut,Ki).call(this,this.parentDimensions,e,i)}translateInPage(e,i){t(this,Lt)||_(this,Lt,[this.x,this.y]),A(this,Ut,Ki).call(this,this.pageDimensions,e,i),this.div.scrollIntoView({block:"nearest"})}drag(e,i){t(this,Lt)||_(this,Lt,[this.x,this.y]);const[o,m]=this.parentDimensions;if(this.x+=e/o,this.y+=i/m,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:ft,y:it}=this.div.getBoundingClientRect();this.parent.findNewParent(this,ft,it)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:T,y:$}=this;const[W,tt]=this.getBaseTranslation();T+=W,$+=tt,this.div.style.left=`${(100*T).toFixed(2)}%`,this.div.style.top=`${(100*$).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!t(this,Lt)&&(t(this,Lt)[0]!==this.x||t(this,Lt)[1]!==this.y)}getBaseTranslation(){const[e,i]=this.parentDimensions,{_borderLineWidth:o}=p,m=o/e,T=o/i;switch(this.rotation){case 90:return[-m,T];case 180:return[m,T];case 270:return[m,-T];default:return[-m,-T]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const[i,o]=this.pageDimensions;let{x:m,y:T,width:$,height:W}=this;if($*=i,W*=o,m*=i,T*=o,this._mustFixPosition)switch(e){case 0:m=Math.max(0,Math.min(i-$,m)),T=Math.max(0,Math.min(o-W,T));break;case 90:m=Math.max(0,Math.min(i-W,m)),T=Math.min(o,Math.max($,T));break;case 180:m=Math.min(i,Math.max($,m)),T=Math.min(o,Math.max(W,T));break;case 270:m=Math.min(i,Math.max(W,m)),T=Math.max(0,Math.min(o-$,T));break}this.x=m/=i,this.y=T/=o;const[tt,ft]=this.getBaseTranslation();m+=tt,T+=ft;const{style:it}=this.div;it.left=`${(100*m).toFixed(2)}%`,it.top=`${(100*T).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,i){var o;return A(o=p,ee,Yi).call(o,e,i,this.parentRotation)}pageTranslationToScreen(e,i){var o;return A(o=p,ee,Yi).call(o,e,i,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[i,o]}=this,m=i*e,T=o*e;return J.FeatureTest.isCSSRoundSupported?[Math.round(m),Math.round(T)]:[m,T]}setDims(e,i){const[o,m]=this.parentDimensions;this.div.style.width=`${(100*e/o).toFixed(2)}%`,t(this,ht)||(this.div.style.height=`${(100*i/m).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:i,width:o}=e,m=o.endsWith("%"),T=!t(this,ht)&&i.endsWith("%");if(m&&T)return;const[$,W]=this.parentDimensions;m||(e.width=`${(100*parseFloat(o)/$).toFixed(2)}%`),!t(this,ht)&&!T&&(e.height=`${(100*parseFloat(i)/W).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var e;(e=t(this,R))==null||e.finish()}async addEditToolbar(){return t(this,nt)||t(this,ae)?t(this,nt):(_(this,nt,new pt.EditorToolbar(this)),this.div.append(t(this,nt).render()),t(this,R)&&t(this,nt).addAltTextButton(await t(this,R).render()),t(this,nt))}removeEditToolbar(){var e;t(this,nt)&&(t(this,nt).remove(),_(this,nt,null),(e=t(this,R))==null||e.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){t(this,R)||(Y.initialize(p._l10nPromise),_(this,R,new Y(this)),await this.addEditToolbar())}get altTextData(){var e;return(e=t(this,R))==null?void 0:e.data}set altTextData(e){t(this,R)&&(t(this,R).data=e)}hasAltText(){var e;return!((e=t(this,R))!=null&&e.isEmpty())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=t(this,L)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.div.addEventListener("focusin",t(this,Tt)),this.div.addEventListener("focusout",t(this,ot));const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*i/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[o,m]=this.getInitialTranslation();return this.translate(o,m),(0,d.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(e){const{isMac:i}=J.FeatureTest.platform;if(e.button!==0||e.ctrlKey&&i){e.preventDefault();return}if(_(this,Dt,!0),this._isDraggable){A(this,Ut,or).call(this,e);return}A(this,Ut,tn).call(this,e)}moveInDOM(){t(this,ne)&&clearTimeout(t(this,ne)),_(this,ne,setTimeout(()=>{var e;_(this,ne,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,i,o){e.changeParent(this),this.x=i,this.y=o,this.fixAndSetPosition()}getRect(e,i,o=this.rotation){const m=this.parentScale,[T,$]=this.pageDimensions,[W,tt]=this.pageTranslation,ft=e/m,it=i/m,wt=this.x*T,Nt=this.y*$,Gt=this.width*T,Wt=this.height*$;switch(o){case 0:return[wt+ft+W,$-Nt-it-Wt+tt,wt+ft+Gt+W,$-Nt-it+tt];case 90:return[wt+it+W,$-Nt+ft+tt,wt+it+Wt+W,$-Nt+ft+Gt+tt];case 180:return[wt-ft-Gt+W,$-Nt+it+tt,wt-ft+W,$-Nt+it+Wt+tt];case 270:return[wt-it-Wt+W,$-Nt-ft-Gt+tt,wt-it+W,$-Nt-ft+tt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,i){const[o,m,T,$]=e,W=T-o,tt=$-m;switch(this.rotation){case 0:return[o,i-$,W,tt];case 90:return[o,i-m,tt,W];case 180:return[T,i-m,W,tt];case 270:return[T,i-$,tt,W];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){_(this,ae,!0)}disableEditMode(){_(this,ae,!1)}isInEditMode(){return t(this,ae)}shouldGetKeyboardEvents(){return t(this,Jt)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var e,i;(e=this.div)==null||e.addEventListener("focusin",t(this,Tt)),(i=this.div)==null||i.addEventListener("focusout",t(this,ot))}rotate(e){}serialize(e=!1,i=null){(0,J.unreachable)("An editor must be serializable")}static deserialize(e,i,o){const m=new this.prototype.constructor({parent:i,id:i.getNextId(),uiManager:o});m.rotation=e.rotation;const[T,$]=m.pageDimensions,[W,tt,ft,it]=m.getRectInCurrentCoords(e.rect,$);return m.x=W/T,m.y=tt/$,m.width=ft/T,m.height=it/$,m}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.div.removeEventListener("focusin",t(this,Tt)),this.div.removeEventListener("focusout",t(this,ot)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),t(this,ne)&&(clearTimeout(t(this,ne)),_(this,ne,null)),A(this,Ut,Ns).call(this),this.removeEditToolbar(),t(this,Qt)){for(const e of t(this,Qt).values())clearTimeout(e);_(this,Qt,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(A(this,Ut,rr).call(this),t(this,st).classList.remove("hidden"),(0,d.bindEvents)(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),_(this,At,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const i=t(this,st).children;if(!t(this,B)){_(this,B,Array.from(i));const $=A(this,Ut,hr).bind(this),W=A(this,Ut,lr).bind(this);for(const tt of t(this,B)){const ft=tt.getAttribute("data-resizer-name");tt.setAttribute("role","spinbutton"),tt.addEventListener("keydown",$),tt.addEventListener("blur",W),tt.addEventListener("focus",A(this,Ut,cr).bind(this,ft)),p._l10nPromise.get(`pdfjs-editor-resizer-label-${ft}`).then(it=>tt.setAttribute("aria-label",it))}}const o=t(this,B)[0];let m=0;for(const $ of i){if($===o)break;m++}const T=(360-this.rotation+this.parentRotation)%360/90*(t(this,B).length/4);if(T!==m){if(T<m)for(let W=0;W<m-T;W++)t(this,st).append(t(this,st).firstChild);else if(T>m)for(let W=0;W<T-m;W++)t(this,st).firstChild.before(t(this,st).lastChild);let $=0;for(const W of i){const tt=t(this,B)[$++].getAttribute("data-resizer-name");p._l10nPromise.get(`pdfjs-editor-resizer-label-${tt}`).then(ft=>W.setAttribute("aria-label",ft))}}A(this,Ut,en).call(this,0),_(this,Jt,!0),t(this,st).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,i){t(this,Jt)&&A(this,Ut,Zi).call(this,t(this,Mt),{movementX:e,movementY:i})}_stopResizingWithKeyboard(){A(this,Ut,Ns).call(this),this.div.focus()}select(){var e,i;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!t(this,nt)){this.addEditToolbar().then(()=>{var o,m;(o=this.div)!=null&&o.classList.contains("selectedEditor")&&((m=t(this,nt))==null||m.show())});return}(i=t(this,nt))==null||i.show()}unselect(){var e,i,o,m;(e=t(this,st))==null||e.classList.add("hidden"),(i=this.div)==null||i.classList.remove("selectedEditor"),(o=this.div)!=null&&o.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(m=t(this,nt))==null||m.hide()}updateParams(e,i){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return t(this,Xt)}set isEditing(e){_(this,Xt,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,i){_(this,ht,!0);const o=e/i,{style:m}=this.div;m.aspectRatio=o,m.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,i=!1){if(i){t(this,Qt)||_(this,Qt,new Map);const{action:o}=e;let m=t(this,Qt).get(o);m&&clearTimeout(m),m=setTimeout(()=>{this._reportTelemetry(e),t(this,Qt).delete(o),t(this,Qt).size===0&&_(this,Qt,null)},p._telemetryTimeout),t(this,Qt).set(o,m);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),_(this,L,!1)}disable(){this.div&&(this.div.tabIndex=-1),_(this,L,!0)}renderAnnotationElement(e){let i=e.container.querySelector(".annotationContent");if(!i)i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),e.container.prepend(i);else if(i.nodeName==="CANVAS"){const o=i;i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),o.before(i)}return i}resetAnnotationElement(e){const{firstChild:i}=e.container;i.nodeName==="DIV"&&i.classList.contains("annotationContent")&&i.remove()}};B=new WeakMap,R=new WeakMap,L=new WeakMap,ht=new WeakMap,st=new WeakMap,At=new WeakMap,Tt=new WeakMap,ot=new WeakMap,nt=new WeakMap,Mt=new WeakMap,Dt=new WeakMap,Lt=new WeakMap,Xt=new WeakMap,ae=new WeakMap,Jt=new WeakMap,ne=new WeakMap,oe=new WeakMap,Rt=new WeakMap,Qt=new WeakMap,ue=new WeakMap,be=new WeakMap,Ut=new WeakSet,Ki=function([e,i],o,m){[o,m]=this.screenToPageTranslation(o,m),this.x+=o/e,this.y+=m/i,this.fixAndSetPosition()},ee=new WeakSet,Yi=function(e,i,o){switch(o){case 90:return[i,-e];case 180:return[-e,-i];case 270:return[-i,e];default:return[e,i]}},Ji=function(e){switch(e){case 90:{const[i,o]=this.pageDimensions;return[0,-i/o,o/i,0]}case 180:return[-1,0,0,-1];case 270:{const[i,o]=this.pageDimensions;return[0,i/o,-o/i,0]}default:return[1,0,0,1]}},rr=function(){if(t(this,st))return;_(this,st,document.createElement("div")),t(this,st).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const i of e){const o=document.createElement("div");t(this,st).append(o),o.classList.add("resizer",i),o.setAttribute("data-resizer-name",i),o.addEventListener("pointerdown",A(this,Ut,ar).bind(this,i)),o.addEventListener("contextmenu",N.noContextMenu),o.tabIndex=-1}this.div.prepend(t(this,st))},ar=function(e,i){var Wt;i.preventDefault();const{isMac:o}=J.FeatureTest.platform;if(i.button!==0||i.ctrlKey&&o)return;(Wt=t(this,R))==null||Wt.toggle(!1);const m=A(this,Ut,Zi).bind(this,e),T=this._isDraggable;this._isDraggable=!1;const $={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",m,$),window.addEventListener("contextmenu",N.noContextMenu);const W=this.x,tt=this.y,ft=this.width,it=this.height,wt=this.parent.div.style.cursor,Nt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(i.target).cursor;const Gt=()=>{var Ht;this.parent.togglePointerEvents(!0),(Ht=t(this,R))==null||Ht.toggle(!0),this._isDraggable=T,window.removeEventListener("pointerup",Gt),window.removeEventListener("blur",Gt),window.removeEventListener("pointermove",m,$),window.removeEventListener("contextmenu",N.noContextMenu),this.parent.div.style.cursor=wt,this.div.style.cursor=Nt,A(this,Ut,Qi).call(this,W,tt,ft,it)};window.addEventListener("pointerup",Gt),window.addEventListener("blur",Gt)},Qi=function(e,i,o,m){const T=this.x,$=this.y,W=this.width,tt=this.height;T===e&&$===i&&W===o&&tt===m||this.addCommands({cmd:()=>{this.width=W,this.height=tt,this.x=T,this.y=$;const[ft,it]=this.parentDimensions;this.setDims(ft*W,it*tt),this.fixAndSetPosition()},undo:()=>{this.width=o,this.height=m,this.x=e,this.y=i;const[ft,it]=this.parentDimensions;this.setDims(ft*o,it*m),this.fixAndSetPosition()},mustExec:!0})},Zi=function(e,i){const[o,m]=this.parentDimensions,T=this.x,$=this.y,W=this.width,tt=this.height,ft=p.MIN_SIZE/o,it=p.MIN_SIZE/m,wt=z=>Math.round(z*1e4)/1e4,Nt=A(this,Ut,Ji).call(this,this.rotation),Gt=(z,q)=>[Nt[0]*z+Nt[2]*q,Nt[1]*z+Nt[3]*q],Wt=A(this,Ut,Ji).call(this,360-this.rotation),Ht=(z,q)=>[Wt[0]*z+Wt[2]*q,Wt[1]*z+Wt[3]*q];let lt,ut,C=!1,X=!1;switch(e){case"topLeft":C=!0,lt=(z,q)=>[0,0],ut=(z,q)=>[z,q];break;case"topMiddle":lt=(z,q)=>[z/2,0],ut=(z,q)=>[z/2,q];break;case"topRight":C=!0,lt=(z,q)=>[z,0],ut=(z,q)=>[0,q];break;case"middleRight":X=!0,lt=(z,q)=>[z,q/2],ut=(z,q)=>[0,q/2];break;case"bottomRight":C=!0,lt=(z,q)=>[z,q],ut=(z,q)=>[0,0];break;case"bottomMiddle":lt=(z,q)=>[z/2,q],ut=(z,q)=>[z/2,0];break;case"bottomLeft":C=!0,lt=(z,q)=>[0,q],ut=(z,q)=>[z,0];break;case"middleLeft":X=!0,lt=(z,q)=>[0,q/2],ut=(z,q)=>[z,q/2];break}const Q=lt(W,tt),vt=ut(W,tt);let xt=Gt(...vt);const Pt=wt(T+xt[0]),Bt=wt($+xt[1]);let te=1,de=1,[Ae,_e]=this.screenToPageTranslation(i.movementX,i.movementY);if([Ae,_e]=Ht(Ae/o,_e/m),C){const z=Math.hypot(W,tt);te=de=Math.max(Math.min(Math.hypot(vt[0]-Q[0]-Ae,vt[1]-Q[1]-_e)/z,1/W,1/tt),ft/W,it/tt)}else X?te=Math.max(ft,Math.min(1,Math.abs(vt[0]-Q[0]-Ae)))/W:de=Math.max(it,Math.min(1,Math.abs(vt[1]-Q[1]-_e)))/tt;const $t=wt(W*te),v=wt(tt*de);xt=Gt(...ut($t,v));const f=Pt-xt[0],E=Bt-xt[1];this.width=$t,this.height=v,this.x=f,this.y=E,this.setDims(o*$t,m*v),this.fixAndSetPosition()},tn=function(e){const{isMac:i}=J.FeatureTest.platform;e.ctrlKey&&!i||e.shiftKey||e.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)},or=function(e){const i=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let o,m;i&&(this.div.classList.add("moving"),o={passive:!0,capture:!0},_(this,oe,e.clientX),_(this,Rt,e.clientY),m=$=>{const{clientX:W,clientY:tt}=$,[ft,it]=this.screenToPageTranslation(W-t(this,oe),tt-t(this,Rt));_(this,oe,W),_(this,Rt,tt),this._uiManager.dragSelectedEditors(ft,it)},window.addEventListener("pointermove",m,o));const T=()=>{window.removeEventListener("pointerup",T),window.removeEventListener("blur",T),i&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",m,o)),_(this,Dt,!1),this._uiManager.endDragSession()||A(this,Ut,tn).call(this,e)};window.addEventListener("pointerup",T),window.addEventListener("blur",T)},hr=function(e){p._resizerKeyboardManager.exec(this,e)},lr=function(e){var i;t(this,Jt)&&((i=e.relatedTarget)==null?void 0:i.parentNode)!==t(this,st)&&A(this,Ut,Ns).call(this)},cr=function(e){_(this,Mt,t(this,Jt)?e:"")},en=function(e){if(t(this,B))for(const i of t(this,B))i.tabIndex=e},Ns=function(){if(_(this,Jt,!1),A(this,Ut,en).call(this,-1),t(this,At)){const{savedX:e,savedY:i,savedWidth:o,savedHeight:m}=t(this,At);A(this,Ut,Qi).call(this,e,i,o,m),_(this,At,null)}},w(p,ee),he(p,"_borderLineWidth",-1),he(p,"_colorManager",new d.ColorManager),he(p,"_zIndex",1),he(p,"_telemetryTimeout",1e3);let H=p;class I extends H{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},61:(se,Vt,dt)=>{var I,k,j,x,dr,li,ur,pr,sn,K,P,B,R,L,ht,st,At,Tt,ot,nt,Mt,Dt,Lt,Xt,ae,Jt,ne,oe,nn,ue,be,Ut,le,ee,ce,Zt,Ot,Bs,Us,gr;dt.d(Vt,{FreeOutliner:()=>pt,Outliner:()=>J});var d=dt(292);class J{constructor(s,a=0,h=0,l=!0){w(this,x);w(this,I);w(this,k,[]);w(this,j,[]);let g=1/0,u=-1/0,p=1/0,M=-1/0;const e=10**-4;for(const{x:tt,y:ft,width:it,height:wt}of s){const Nt=Math.floor((tt-a)/e)*e,Gt=Math.ceil((tt+it+a)/e)*e,Wt=Math.floor((ft-a)/e)*e,Ht=Math.ceil((ft+wt+a)/e)*e,lt=[Nt,Wt,Ht,!0],ut=[Gt,Wt,Ht,!1];t(this,k).push(lt,ut),g=Math.min(g,Nt),u=Math.max(u,Gt),p=Math.min(p,Wt),M=Math.max(M,Ht)}const i=u-g+2*h,o=M-p+2*h,m=g-h,T=p-h,$=t(this,k).at(l?-1:-2),W=[$[0],$[2]];for(const tt of t(this,k)){const[ft,it,wt]=tt;tt[0]=(ft-m)/i,tt[1]=(it-T)/o,tt[2]=(wt-T)/o}_(this,I,{x:m,y:T,width:i,height:o,lastPoint:W})}getOutlines(){t(this,k).sort((a,h)=>a[0]-h[0]||a[1]-h[1]||a[2]-h[2]);const s=[];for(const a of t(this,k))a[3]?(s.push(...A(this,x,sn).call(this,a)),A(this,x,ur).call(this,a)):(A(this,x,pr).call(this,a),s.push(...A(this,x,sn).call(this,a)));return A(this,x,dr).call(this,s)}}I=new WeakMap,k=new WeakMap,j=new WeakMap,x=new WeakSet,dr=function(s){const a=[],h=new Set;for(const u of s){const[p,M,e]=u;a.push([p,M,u],[p,e,u])}a.sort((u,p)=>u[1]-p[1]||u[0]-p[0]);for(let u=0,p=a.length;u<p;u+=2){const M=a[u][2],e=a[u+1][2];M.push(e),e.push(M),h.add(M),h.add(e)}const l=[];let g;for(;h.size>0;){const u=h.values().next().value;let[p,M,e,i,o]=u;h.delete(u);let m=p,T=M;for(g=[p,e],l.push(g);;){let $;if(h.has(i))$=i;else if(h.has(o))$=o;else break;h.delete($),[p,M,e,i,o]=$,m!==p&&(g.push(m,T,p,T===M?M:e),m=p),T=T===M?e:M}g.push(m,T)}return new Y(l,t(this,I))},li=function(s){const a=t(this,j);let h=0,l=a.length-1;for(;h<=l;){const g=h+l>>1,u=a[g][0];if(u===s)return g;u<s?h=g+1:l=g-1}return l+1},ur=function([,s,a]){const h=A(this,x,li).call(this,s);t(this,j).splice(h,0,[s,a])},pr=function([,s,a]){const h=A(this,x,li).call(this,s);for(let l=h;l<t(this,j).length;l++){const[g,u]=t(this,j)[l];if(g!==s)break;if(g===s&&u===a){t(this,j).splice(l,1);return}}for(let l=h-1;l>=0;l--){const[g,u]=t(this,j)[l];if(g!==s)break;if(g===s&&u===a){t(this,j).splice(l,1);return}}},sn=function(s){const[a,h,l]=s,g=[[a,h,l]],u=A(this,x,li).call(this,l);for(let p=0;p<u;p++){const[M,e]=t(this,j)[p];for(let i=0,o=g.length;i<o;i++){const[,m,T]=g[i];if(!(e<=m||T<=M)){if(m>=M){if(T>e)g[i][1]=e;else{if(o===1)return[];g.splice(i,1),i--,o--}continue}g[i][2]=M,T>e&&g.push([a,e,T])}}}return g};class N{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(s,a){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof H}}class Y extends N{constructor(a,h){super();w(this,K);w(this,P);_(this,P,a),_(this,K,h)}toSVGPath(){const a=[];for(const h of t(this,P)){let[l,g]=h;a.push(`M${l} ${g}`);for(let u=2;u<h.length;u+=2){const p=h[u],M=h[u+1];p===l?(a.push(`V${M}`),g=M):M===g&&(a.push(`H${p}`),l=p)}a.push("Z")}return a.join(" ")}serialize([a,h,l,g],u){const p=[],M=l-a,e=g-h;for(const i of t(this,P)){const o=new Array(i.length);for(let m=0;m<i.length;m+=2)o[m]=a+i[m]*M,o[m+1]=g-i[m+1]*e;p.push(o)}return p}get box(){return t(this,K)}}K=new WeakMap,P=new WeakMap;const Qt=class Qt{constructor({x:s,y:a},h,l,g,u,p=0){w(this,oe);w(this,B);w(this,R,[]);w(this,L);w(this,ht);w(this,st,[]);w(this,At,new Float64Array(18));w(this,Tt);w(this,ot);w(this,nt);w(this,Mt);w(this,Dt);w(this,Lt);w(this,Xt,[]);_(this,B,h),_(this,Lt,g*l),_(this,ht,u),t(this,At).set([NaN,NaN,NaN,NaN,s,a],6),_(this,L,p),_(this,Mt,t(Qt,ae)*l),_(this,nt,t(Qt,ne)*l),_(this,Dt,l),t(this,Xt).push(s,a)}get free(){return!0}isEmpty(){return isNaN(t(this,At)[8])}add({x:s,y:a}){var lt;_(this,Tt,s),_(this,ot,a);const[h,l,g,u]=t(this,B);let[p,M,e,i]=t(this,At).subarray(8,12);const o=s-e,m=a-i,T=Math.hypot(o,m);if(T<t(this,nt))return!1;const $=T-t(this,Mt),W=$/T,tt=W*o,ft=W*m;let it=p,wt=M;p=e,M=i,e+=tt,i+=ft,(lt=t(this,Xt))==null||lt.push(s,a);const Nt=-ft/$,Gt=tt/$,Wt=Nt*t(this,Lt),Ht=Gt*t(this,Lt);return t(this,At).set(t(this,At).subarray(2,8),0),t(this,At).set([e+Wt,i+Ht],4),t(this,At).set(t(this,At).subarray(14,18),12),t(this,At).set([e-Wt,i-Ht],16),isNaN(t(this,At)[6])?(t(this,st).length===0&&(t(this,At).set([p+Wt,M+Ht],2),t(this,st).push(NaN,NaN,NaN,NaN,(p+Wt-h)/g,(M+Ht-l)/u),t(this,At).set([p-Wt,M-Ht],14),t(this,R).push(NaN,NaN,NaN,NaN,(p-Wt-h)/g,(M-Ht-l)/u)),t(this,At).set([it,wt,p,M,e,i],6),!this.isEmpty()):(t(this,At).set([it,wt,p,M,e,i],6),Math.abs(Math.atan2(wt-M,it-p)-Math.atan2(ft,tt))<Math.PI/2?([p,M,e,i]=t(this,At).subarray(2,6),t(this,st).push(NaN,NaN,NaN,NaN,((p+e)/2-h)/g,((M+i)/2-l)/u),[p,M,it,wt]=t(this,At).subarray(14,18),t(this,R).push(NaN,NaN,NaN,NaN,((it+p)/2-h)/g,((wt+M)/2-l)/u),!0):([it,wt,p,M,e,i]=t(this,At).subarray(0,6),t(this,st).push(((it+5*p)/6-h)/g,((wt+5*M)/6-l)/u,((5*p+e)/6-h)/g,((5*M+i)/6-l)/u,((p+e)/2-h)/g,((M+i)/2-l)/u),[e,i,p,M,it,wt]=t(this,At).subarray(12,18),t(this,R).push(((it+5*p)/6-h)/g,((wt+5*M)/6-l)/u,((5*p+e)/6-h)/g,((5*M+i)/6-l)/u,((p+e)/2-h)/g,((M+i)/2-l)/u),!0))}toSVGPath(){if(this.isEmpty())return"";const s=t(this,st),a=t(this,R),h=t(this,At).subarray(4,6),l=t(this,At).subarray(16,18),[g,u,p,M]=t(this,B),[e,i,o,m]=A(this,oe,nn).call(this);if(isNaN(t(this,At)[6])&&!this.isEmpty())return`M${(t(this,At)[2]-g)/p} ${(t(this,At)[3]-u)/M} L${(t(this,At)[4]-g)/p} ${(t(this,At)[5]-u)/M} L${e} ${i} L${o} ${m} L${(t(this,At)[16]-g)/p} ${(t(this,At)[17]-u)/M} L${(t(this,At)[14]-g)/p} ${(t(this,At)[15]-u)/M} Z`;const T=[];T.push(`M${s[4]} ${s[5]}`);for(let $=6;$<s.length;$+=6)isNaN(s[$])?T.push(`L${s[$+4]} ${s[$+5]}`):T.push(`C${s[$]} ${s[$+1]} ${s[$+2]} ${s[$+3]} ${s[$+4]} ${s[$+5]}`);T.push(`L${(h[0]-g)/p} ${(h[1]-u)/M} L${e} ${i} L${o} ${m} L${(l[0]-g)/p} ${(l[1]-u)/M}`);for(let $=a.length-6;$>=6;$-=6)isNaN(a[$])?T.push(`L${a[$+4]} ${a[$+5]}`):T.push(`C${a[$]} ${a[$+1]} ${a[$+2]} ${a[$+3]} ${a[$+4]} ${a[$+5]}`);return T.push(`L${a[4]} ${a[5]} Z`),T.join(" ")}getOutlines(){var ft;const s=t(this,st),a=t(this,R),h=t(this,At),l=h.subarray(4,6),g=h.subarray(16,18),[u,p,M,e]=t(this,B),i=new Float64Array((((ft=t(this,Xt))==null?void 0:ft.length)??0)+2);for(let it=0,wt=i.length-2;it<wt;it+=2)i[it]=(t(this,Xt)[it]-u)/M,i[it+1]=(t(this,Xt)[it+1]-p)/e;i[i.length-2]=(t(this,Tt)-u)/M,i[i.length-1]=(t(this,ot)-p)/e;const[o,m,T,$]=A(this,oe,nn).call(this);if(isNaN(h[6])&&!this.isEmpty()){const it=new Float64Array(36);return it.set([NaN,NaN,NaN,NaN,(h[2]-u)/M,(h[3]-p)/e,NaN,NaN,NaN,NaN,(h[4]-u)/M,(h[5]-p)/e,NaN,NaN,NaN,NaN,o,m,NaN,NaN,NaN,NaN,T,$,NaN,NaN,NaN,NaN,(h[16]-u)/M,(h[17]-p)/e,NaN,NaN,NaN,NaN,(h[14]-u)/M,(h[15]-p)/e],0),new H(it,i,t(this,B),t(this,Dt),t(this,L),t(this,ht))}const W=new Float64Array(t(this,st).length+24+t(this,R).length);let tt=s.length;for(let it=0;it<tt;it+=2){if(isNaN(s[it])){W[it]=W[it+1]=NaN;continue}W[it]=s[it],W[it+1]=s[it+1]}W.set([NaN,NaN,NaN,NaN,(l[0]-u)/M,(l[1]-p)/e,NaN,NaN,NaN,NaN,o,m,NaN,NaN,NaN,NaN,T,$,NaN,NaN,NaN,NaN,(g[0]-u)/M,(g[1]-p)/e],tt),tt+=24;for(let it=a.length-6;it>=6;it-=6)for(let wt=0;wt<6;wt+=2){if(isNaN(a[it+wt])){W[tt]=W[tt+1]=NaN,tt+=2;continue}W[tt]=a[it+wt],W[tt+1]=a[it+wt+1],tt+=2}return W.set([NaN,NaN,NaN,NaN,a[4],a[5]],tt),new H(W,i,t(this,B),t(this,Dt),t(this,L),t(this,ht))}};B=new WeakMap,R=new WeakMap,L=new WeakMap,ht=new WeakMap,st=new WeakMap,At=new WeakMap,Tt=new WeakMap,ot=new WeakMap,nt=new WeakMap,Mt=new WeakMap,Dt=new WeakMap,Lt=new WeakMap,Xt=new WeakMap,ae=new WeakMap,Jt=new WeakMap,ne=new WeakMap,oe=new WeakSet,nn=function(){const s=t(this,At).subarray(4,6),a=t(this,At).subarray(16,18),[h,l,g,u]=t(this,B);return[(t(this,Tt)+(s[0]-a[0])/2-h)/g,(t(this,ot)+(s[1]-a[1])/2-l)/u,(t(this,Tt)+(a[0]-s[0])/2-h)/g,(t(this,ot)+(a[1]-s[1])/2-l)/u]},w(Qt,ae,8),w(Qt,Jt,2),w(Qt,ne,t(Qt,ae)+t(Qt,Jt));let pt=Qt;class H extends N{constructor(a,h,l,g,u,p){super();w(this,Ot);w(this,ue);w(this,be,null);w(this,Ut);w(this,le);w(this,ee);w(this,ce);w(this,Zt);_(this,Zt,a),_(this,ee,h),_(this,ue,l),_(this,ce,g),_(this,Ut,u),_(this,le,p),A(this,Ot,gr).call(this,p);const{x:M,y:e,width:i,height:o}=t(this,be);for(let m=0,T=a.length;m<T;m+=2)a[m]=(a[m]-M)/i,a[m+1]=(a[m+1]-e)/o;for(let m=0,T=h.length;m<T;m+=2)h[m]=(h[m]-M)/i,h[m+1]=(h[m+1]-e)/o}toSVGPath(){const a=[`M${t(this,Zt)[4]} ${t(this,Zt)[5]}`];for(let h=6,l=t(this,Zt).length;h<l;h+=6){if(isNaN(t(this,Zt)[h])){a.push(`L${t(this,Zt)[h+4]} ${t(this,Zt)[h+5]}`);continue}a.push(`C${t(this,Zt)[h]} ${t(this,Zt)[h+1]} ${t(this,Zt)[h+2]} ${t(this,Zt)[h+3]} ${t(this,Zt)[h+4]} ${t(this,Zt)[h+5]}`)}return a.push("Z"),a.join(" ")}serialize([a,h,l,g],u){const p=l-a,M=g-h;let e,i;switch(u){case 0:e=A(this,Ot,Bs).call(this,t(this,Zt),a,g,p,-M),i=A(this,Ot,Bs).call(this,t(this,ee),a,g,p,-M);break;case 90:e=A(this,Ot,Us).call(this,t(this,Zt),a,h,p,M),i=A(this,Ot,Us).call(this,t(this,ee),a,h,p,M);break;case 180:e=A(this,Ot,Bs).call(this,t(this,Zt),l,h,-p,M),i=A(this,Ot,Bs).call(this,t(this,ee),l,h,-p,M);break;case 270:e=A(this,Ot,Us).call(this,t(this,Zt),l,g,-p,-M),i=A(this,Ot,Us).call(this,t(this,ee),l,g,-p,-M);break}return{outline:Array.from(e),points:[Array.from(i)]}}get box(){return t(this,be)}getNewOutline(a,h){const{x:l,y:g,width:u,height:p}=t(this,be),[M,e,i,o]=t(this,ue),m=u*i,T=p*o,$=l*i+M,W=g*o+e,tt=new pt({x:t(this,ee)[0]*m+$,y:t(this,ee)[1]*T+W},t(this,ue),t(this,ce),a,t(this,le),h??t(this,Ut));for(let ft=2;ft<t(this,ee).length;ft+=2)tt.add({x:t(this,ee)[ft]*m+$,y:t(this,ee)[ft+1]*T+W});return tt.getOutlines()}}ue=new WeakMap,be=new WeakMap,Ut=new WeakMap,le=new WeakMap,ee=new WeakMap,ce=new WeakMap,Zt=new WeakMap,Ot=new WeakSet,Bs=function(a,h,l,g,u){const p=new Float64Array(a.length);for(let M=0,e=a.length;M<e;M+=2)p[M]=h+a[M]*g,p[M+1]=l+a[M+1]*u;return p},Us=function(a,h,l,g,u){const p=new Float64Array(a.length);for(let M=0,e=a.length;M<e;M+=2)p[M]=h+a[M+1]*g,p[M+1]=l+a[M]*u;return p},gr=function(a){const h=t(this,Zt);let l=h[4],g=h[5],u=l,p=g,M=l,e=g,i=l,o=g;const m=a?Math.max:Math.min;for(let ft=6,it=h.length;ft<it;ft+=6){if(isNaN(h[ft]))u=Math.min(u,h[ft+4]),p=Math.min(p,h[ft+5]),M=Math.max(M,h[ft+4]),e=Math.max(e,h[ft+5]),o<h[ft+5]?(i=h[ft+4],o=h[ft+5]):o===h[ft+5]&&(i=m(i,h[ft+4]));else{const wt=d.Util.bezierBoundingBox(l,g,...h.slice(ft,ft+6));u=Math.min(u,wt[0]),p=Math.min(p,wt[1]),M=Math.max(M,wt[2]),e=Math.max(e,wt[3]),o<wt[3]?(i=wt[2],o=wt[3]):o===wt[3]&&(i=m(i,wt[2]))}l=h[ft+4],g=h[ft+5]}const T=u-t(this,Ut),$=p-t(this,Ut),W=M-u+2*t(this,Ut),tt=e-p+2*t(this,Ut);_(this,be,{x:T,y:$,width:W,height:tt,lastPoint:[i,o]})}},362:(se,Vt,dt)=>{var Y,pt,H,I,k,fr,x,mr,br,ci,Ar,rn,P,B,R,L,vr,yr,_r;dt.d(Vt,{EditorToolbar:()=>J,HighlightToolbar:()=>N});var d=dt(419);const K=class K{constructor(ot){w(this,x);w(this,Y,null);w(this,pt,null);w(this,H);w(this,I,null);_(this,H,ot)}render(){const ot=_(this,Y,document.createElement("div"));ot.className="editToolbar",ot.setAttribute("role","toolbar"),ot.addEventListener("contextmenu",d.noContextMenu),ot.addEventListener("pointerdown",A(K,k,fr));const nt=_(this,I,document.createElement("div"));nt.className="buttons",ot.append(nt);const Mt=t(this,H).toolbarPosition;if(Mt){const{style:Dt}=ot,Lt=t(this,H)._uiManager.direction==="ltr"?1-Mt[0]:Mt[0];Dt.insetInlineEnd=`${100*Lt}%`,Dt.top=`calc(${100*Mt[1]}% + var(--editor-toolbar-vert-offset))`}return A(this,x,Ar).call(this),ot}hide(){var ot;t(this,Y).classList.add("hidden"),(ot=t(this,pt))==null||ot.hideDropdown()}show(){t(this,Y).classList.remove("hidden")}addAltTextButton(ot){A(this,x,ci).call(this,ot),t(this,I).prepend(ot,t(this,x,rn))}addColorPicker(ot){_(this,pt,ot);const nt=ot.renderButton();A(this,x,ci).call(this,nt),t(this,I).prepend(nt,t(this,x,rn))}remove(){var ot;t(this,Y).remove(),(ot=t(this,pt))==null||ot.destroy(),_(this,pt,null)}};Y=new WeakMap,pt=new WeakMap,H=new WeakMap,I=new WeakMap,k=new WeakSet,fr=function(ot){ot.stopPropagation()},x=new WeakSet,mr=function(ot){t(this,H)._focusEventsAllowed=!1,ot.preventDefault(),ot.stopPropagation()},br=function(ot){t(this,H)._focusEventsAllowed=!0,ot.preventDefault(),ot.stopPropagation()},ci=function(ot){ot.addEventListener("focusin",A(this,x,mr).bind(this),{capture:!0}),ot.addEventListener("focusout",A(this,x,br).bind(this),{capture:!0}),ot.addEventListener("contextmenu",d.noContextMenu)},Ar=function(){const ot=document.createElement("button");ot.className="delete",ot.tabIndex=0,ot.setAttribute("data-l10n-id",`pdfjs-editor-remove-${t(this,H).editorType}-button`),A(this,x,ci).call(this,ot),ot.addEventListener("click",nt=>{t(this,H)._uiManager.delete()}),t(this,I).append(ot)},rn=function(){const ot=document.createElement("div");return ot.className="divider",ot},w(K,k);let J=K;class N{constructor(ot){w(this,L);w(this,P,null);w(this,B,null);w(this,R);_(this,R,ot)}show(ot,nt,Mt){const[Dt,Lt]=A(this,L,yr).call(this,nt,Mt),{style:Xt}=t(this,B)||_(this,B,A(this,L,vr).call(this));ot.append(t(this,B)),Xt.insetInlineEnd=`${100*Dt}%`,Xt.top=`calc(${100*Lt}% + var(--editor-toolbar-vert-offset))`}hide(){t(this,B).remove()}}P=new WeakMap,B=new WeakMap,R=new WeakMap,L=new WeakSet,vr=function(){const ot=_(this,B,document.createElement("div"));ot.className="editToolbar",ot.setAttribute("role","toolbar"),ot.addEventListener("contextmenu",d.noContextMenu);const nt=_(this,P,document.createElement("div"));return nt.className="buttons",ot.append(nt),A(this,L,_r).call(this),ot},yr=function(ot,nt){let Mt=0,Dt=0;for(const Lt of ot){const Xt=Lt.y+Lt.height;if(Xt<Mt)continue;const ae=Lt.x+(nt?Lt.width:0);if(Xt>Mt){Dt=ae,Mt=Xt;continue}nt?ae>Dt&&(Dt=ae):ae<Dt&&(Dt=ae)}return[nt?1-Dt:Dt,Mt]},_r=function(){const ot=document.createElement("button");ot.className="highlightButton",ot.tabIndex=0,ot.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const nt=document.createElement("span");ot.append(nt),nt.className="visuallyHidden",nt.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label"),ot.addEventListener("contextmenu",d.noContextMenu),ot.addEventListener("click",()=>{t(this,R).highlightSelection("floating_button")}),t(this,P).append(ot)}},830:(se,Vt,dt)=>{var F,D,Z,U,K,an,R,L,ht,st,At,wr,nt,Mt,Dt,Lt,Xt,ae,Jt,ne,oe,Rt,Qt,ue,be,Ut,le,ee,ce,Zt,Ot,bt,gt,S,n,s,a,h,l,g,u,p,M,e,i,o,m,T,$,W,tt,ft,it,wt,Nt,Gt,Wt,Ht,lt,di,Er,xr,ui,Sr,Cr,Tr,on,hn,ln,cn,dn,Ne,ns,Mr,Rr,un,Pr,Hs,pn;dt.d(Vt,{AnnotationEditorUIManager:()=>y,ColorManager:()=>x,KeyboardManager:()=>j,bindEvents:()=>Y,opacityToHex:()=>pt});var d=dt(292),J=dt(419),N=dt(362);function Y(Ft,c,O){for(const et of O)c.addEventListener(et,Ft[et].bind(Ft))}function pt(Ft){return Math.round(Math.min(255,Math.max(1,255*Ft))).toString(16).padStart(2,"0")}class H{constructor(){w(this,F,0)}get id(){return`${d.AnnotationEditorPrefix}${Je(this,F)._++}`}}F=new WeakMap;const B=class B{constructor(){w(this,K);w(this,D,(0,d.getUuid)());w(this,Z,0);w(this,U,null)}static get _isSVGFittingCanvas(){const c='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',O=new OffscreenCanvas(1,3).getContext("2d"),et=new Image;et.src=c;const ct=et.decode().then(()=>(O.drawImage(et,0,0,1,1,0,0,1,3),new Uint32Array(O.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,d.shadow)(this,"_isSVGFittingCanvas",ct)}async getFromFile(c){const{lastModified:O,name:et,size:ct,type:St}=c;return A(this,K,an).call(this,`${O}_${et}_${ct}_${St}`,c)}async getFromUrl(c){return A(this,K,an).call(this,c,c)}async getFromId(c){t(this,U)||_(this,U,new Map);const O=t(this,U).get(c);return O?O.bitmap?(O.refCounter+=1,O):O.file?this.getFromFile(O.file):this.getFromUrl(O.url):null}getSvgUrl(c){const O=t(this,U).get(c);return O!=null&&O.isSvg?O.svgUrl:null}deleteId(c){t(this,U)||_(this,U,new Map);const O=t(this,U).get(c);O&&(O.refCounter-=1,O.refCounter===0&&(O.bitmap=null))}isValidId(c){return c.startsWith(`image_${t(this,D)}_`)}};D=new WeakMap,Z=new WeakMap,U=new WeakMap,K=new WeakSet,an=async function(c,O){t(this,U)||_(this,U,new Map);let et=t(this,U).get(c);if(et===null)return null;if(et!=null&&et.bitmap)return et.refCounter+=1,et;try{et||(et={bitmap:null,id:`image_${t(this,D)}_${Je(this,Z)._++}`,refCounter:0,isSvg:!1});let ct;if(typeof O=="string"?(et.url=O,ct=await(0,J.fetchData)(O,"blob")):ct=et.file=O,ct.type==="image/svg+xml"){const St=B._isSVGFittingCanvas,Et=new FileReader,It=new Image,Kt=new Promise((Yt,fe)=>{It.onload=()=>{et.bitmap=It,et.isSvg=!0,Yt()},Et.onload=async()=>{const Te=et.svgUrl=Et.result;It.src=await St?`${Te}#svgView(preserveAspectRatio(none))`:Te},It.onerror=Et.onerror=fe});Et.readAsDataURL(ct),await Kt}else et.bitmap=await createImageBitmap(ct);et.refCounter=1}catch(ct){console.error(ct),et=null}return t(this,U).set(c,et),et&&t(this,U).set(et.id,et),et};let I=B;class k{constructor(c=128){w(this,R,[]);w(this,L,!1);w(this,ht);w(this,st,-1);_(this,ht,c)}add({cmd:c,undo:O,post:et,mustExec:ct,type:St=NaN,overwriteIfSameType:Et=!1,keepUndo:It=!1}){if(ct&&c(),t(this,L))return;const Kt={cmd:c,undo:O,post:et,type:St};if(t(this,st)===-1){t(this,R).length>0&&(t(this,R).length=0),_(this,st,0),t(this,R).push(Kt);return}if(Et&&t(this,R)[t(this,st)].type===St){It&&(Kt.undo=t(this,R)[t(this,st)].undo),t(this,R)[t(this,st)]=Kt;return}const Yt=t(this,st)+1;Yt===t(this,ht)?t(this,R).splice(0,1):(_(this,st,Yt),Yt<t(this,R).length&&t(this,R).splice(Yt)),t(this,R).push(Kt)}undo(){if(t(this,st)===-1)return;_(this,L,!0);const{undo:c,post:O}=t(this,R)[t(this,st)];c(),O==null||O(),_(this,L,!1),_(this,st,t(this,st)-1)}redo(){if(t(this,st)<t(this,R).length-1){_(this,st,t(this,st)+1),_(this,L,!0);const{cmd:c,post:O}=t(this,R)[t(this,st)];c(),O==null||O(),_(this,L,!1)}}hasSomethingToUndo(){return t(this,st)!==-1}hasSomethingToRedo(){return t(this,st)<t(this,R).length-1}destroy(){_(this,R,null)}}R=new WeakMap,L=new WeakMap,ht=new WeakMap,st=new WeakMap;class j{constructor(c){w(this,At);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:O}=d.FeatureTest.platform;for(const[et,ct,St={}]of c)for(const Et of et){const It=Et.startsWith("mac+");O&&It?(this.callbacks.set(Et.slice(4),{callback:ct,options:St}),this.allKeys.add(Et.split("+").at(-1))):!O&&!It&&(this.callbacks.set(Et,{callback:ct,options:St}),this.allKeys.add(Et.split("+").at(-1)))}}exec(c,O){if(!this.allKeys.has(O.key))return;const et=this.callbacks.get(A(this,At,wr).call(this,O));if(!et)return;const{callback:ct,options:{bubbles:St=!1,args:Et=[],checker:It=null}}=et;It&&!It(c,O)||(ct.bind(c,...Et,O)(),St||(O.stopPropagation(),O.preventDefault()))}}At=new WeakSet,wr=function(c){c.altKey&&this.buffer.push("alt"),c.ctrlKey&&this.buffer.push("ctrl"),c.metaKey&&this.buffer.push("meta"),c.shiftKey&&this.buffer.push("shift"),this.buffer.push(c.key);const O=this.buffer.join("+");return this.buffer.length=0,O};const ot=class ot{get _colors(){const c=new Map([["CanvasText",null],["Canvas",null]]);return(0,J.getColorValues)(c),(0,d.shadow)(this,"_colors",c)}convert(c){const O=(0,J.getRGB)(c);if(!window.matchMedia("(forced-colors: active)").matches)return O;for(const[et,ct]of this._colors)if(ct.every((St,Et)=>St===O[Et]))return ot._colorsMapping.get(et);return O}getHexCode(c){const O=this._colors.get(c);return O?d.Util.makeHexColor(...O):c}};he(ot,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let x=ot;const zt=class zt{constructor(c,O,et,ct,St,Et,It,Kt,Yt){w(this,lt);w(this,nt,null);w(this,Mt,new Map);w(this,Dt,new Map);w(this,Lt,null);w(this,Xt,null);w(this,ae,null);w(this,Jt,new k);w(this,ne,0);w(this,oe,new Set);w(this,Rt,null);w(this,Qt,null);w(this,ue,new Set);w(this,be,!1);w(this,Ut,null);w(this,le,null);w(this,ee,null);w(this,ce,!1);w(this,Zt,null);w(this,Ot,new H);w(this,bt,!1);w(this,gt,!1);w(this,S,null);w(this,n,null);w(this,s,null);w(this,a,d.AnnotationEditorType.NONE);w(this,h,new Set);w(this,l,null);w(this,g,null);w(this,u,null);w(this,p,this.blur.bind(this));w(this,M,this.focus.bind(this));w(this,e,this.copy.bind(this));w(this,i,this.cut.bind(this));w(this,o,this.paste.bind(this));w(this,m,this.keydown.bind(this));w(this,T,this.keyup.bind(this));w(this,$,this.onEditingAction.bind(this));w(this,W,this.onPageChanging.bind(this));w(this,tt,this.onScaleChanging.bind(this));w(this,ft,A(this,lt,xr).bind(this));w(this,it,this.onRotationChanging.bind(this));w(this,wt,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});w(this,Nt,[0,0]);w(this,Gt,null);w(this,Wt,null);w(this,Ht,null);_(this,Wt,c),_(this,Ht,O),_(this,Lt,et),this._eventBus=ct,this._eventBus._on("editingaction",t(this,$)),this._eventBus._on("pagechanging",t(this,W)),this._eventBus._on("scalechanging",t(this,tt)),this._eventBus._on("rotationchanging",t(this,it)),A(this,lt,Sr).call(this),A(this,lt,hn).call(this),_(this,Xt,St.annotationStorage),_(this,Ut,St.filterFactory),_(this,g,Et),_(this,ee,It||null),_(this,be,Kt),_(this,s,Yt||null),this.viewParameters={realScale:J.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const c=zt.prototype,O=Et=>t(Et,Wt).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&Et.hasSomethingToControl(),et=(Et,{target:It})=>{if(It instanceof HTMLInputElement){const{type:Kt}=It;return Kt!=="text"&&Kt!=="number"}return!0},ct=this.TRANSLATE_SMALL,St=this.TRANSLATE_BIG;return(0,d.shadow)(this,"_keyboardManager",new j([[["ctrl+a","mac+meta+a"],c.selectAll,{checker:et}],[["ctrl+z","mac+meta+z"],c.undo,{checker:et}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],c.redo,{checker:et}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],c.delete,{checker:et}],[["Enter","mac+Enter"],c.addNewEditorFromKeyboard,{checker:(Et,{target:It})=>!(It instanceof HTMLButtonElement)&&t(Et,Wt).contains(It)&&!Et.isEnterHandled}],[[" ","mac+ "],c.addNewEditorFromKeyboard,{checker:(Et,{target:It})=>!(It instanceof HTMLButtonElement)&&t(Et,Wt).contains(document.activeElement)}],[["Escape","mac+Escape"],c.unselectAll],[["ArrowLeft","mac+ArrowLeft"],c.translateSelectedEditors,{args:[-ct,0],checker:O}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],c.translateSelectedEditors,{args:[-St,0],checker:O}],[["ArrowRight","mac+ArrowRight"],c.translateSelectedEditors,{args:[ct,0],checker:O}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],c.translateSelectedEditors,{args:[St,0],checker:O}],[["ArrowUp","mac+ArrowUp"],c.translateSelectedEditors,{args:[0,-ct],checker:O}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],c.translateSelectedEditors,{args:[0,-St],checker:O}],[["ArrowDown","mac+ArrowDown"],c.translateSelectedEditors,{args:[0,ct],checker:O}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],c.translateSelectedEditors,{args:[0,St],checker:O}]]))}destroy(){var c,O;A(this,lt,ln).call(this),A(this,lt,on).call(this),this._eventBus._off("editingaction",t(this,$)),this._eventBus._off("pagechanging",t(this,W)),this._eventBus._off("scalechanging",t(this,tt)),this._eventBus._off("rotationchanging",t(this,it));for(const et of t(this,Dt).values())et.destroy();t(this,Dt).clear(),t(this,Mt).clear(),t(this,ue).clear(),_(this,nt,null),t(this,h).clear(),t(this,Jt).destroy(),(c=t(this,Lt))==null||c.destroy(),(O=t(this,Zt))==null||O.hide(),_(this,Zt,null),t(this,le)&&(clearTimeout(t(this,le)),_(this,le,null)),t(this,Gt)&&(clearTimeout(t(this,Gt)),_(this,Gt,null)),A(this,lt,Cr).call(this)}async mlGuess(c){var O;return((O=t(this,s))==null?void 0:O.guess(c))||null}get hasMLManager(){return!!t(this,s)}get hcmFilter(){return(0,d.shadow)(this,"hcmFilter",t(this,g)?t(this,Ut).addHCMFilter(t(this,g).foreground,t(this,g).background):"none")}get direction(){return(0,d.shadow)(this,"direction",getComputedStyle(t(this,Wt)).direction)}get highlightColors(){return(0,d.shadow)(this,"highlightColors",t(this,ee)?new Map(t(this,ee).split(",").map(c=>c.split("=").map(O=>O.trim()))):null)}get highlightColorNames(){return(0,d.shadow)(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,c=>c.reverse())):null)}setMainHighlightColorPicker(c){_(this,n,c)}editAltText(c){var O;(O=t(this,Lt))==null||O.editAltText(this,c)}onPageChanging({pageNumber:c}){_(this,ne,c-1)}focusMainContainer(){t(this,Wt).focus()}findParent(c,O){for(const et of t(this,Dt).values()){const{x:ct,y:St,width:Et,height:It}=et.div.getBoundingClientRect();if(c>=ct&&c<=ct+Et&&O>=St&&O<=St+It)return et}return null}disableUserSelect(c=!1){t(this,Ht).classList.toggle("noUserSelect",c)}addShouldRescale(c){t(this,ue).add(c)}removeShouldRescale(c){t(this,ue).delete(c)}onScaleChanging({scale:c}){this.commitOrRemove(),this.viewParameters.realScale=c*J.PixelsPerInch.PDF_TO_CSS_UNITS;for(const O of t(this,ue))O.onScaleChanging()}onRotationChanging({pagesRotation:c}){this.commitOrRemove(),this.viewParameters.rotation=c}highlightSelection(c=""){const O=document.getSelection();if(!O||O.isCollapsed)return;const{anchorNode:et,anchorOffset:ct,focusNode:St,focusOffset:Et}=O,It=O.toString(),Kt=A(this,lt,di).call(this,O).closest(".textLayer"),Yt=this.getSelectionBoxes(Kt);if(Yt){O.empty(),t(this,a)===d.AnnotationEditorType.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:d.AnnotationEditorType.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const fe of t(this,Dt).values())if(fe.hasTextLayer(Kt)){fe.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:c,boxes:Yt,anchorNode:et,anchorOffset:ct,focusNode:St,focusOffset:Et,text:It});break}}}addToAnnotationStorage(c){!c.isEmpty()&&t(this,Xt)&&!t(this,Xt).has(c.id)&&t(this,Xt).setValue(c.id,c)}blur(){if(this.isShiftKeyDown=!1,t(this,ce)&&(_(this,ce,!1),A(this,lt,ui).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:c}=document;for(const O of t(this,h))if(O.div.contains(c)){_(this,S,[O,c]),O._focusEventsAllowed=!1;break}}focus(){if(!t(this,S))return;const[c,O]=t(this,S);_(this,S,null),O.addEventListener("focusin",()=>{c._focusEventsAllowed=!0},{once:!0}),O.focus()}addEditListeners(){A(this,lt,hn).call(this),A(this,lt,cn).call(this)}removeEditListeners(){A(this,lt,ln).call(this),A(this,lt,dn).call(this)}copy(c){var et;if(c.preventDefault(),(et=t(this,nt))==null||et.commitOrRemove(),!this.hasSelection)return;const O=[];for(const ct of t(this,h)){const St=ct.serialize(!0);St&&O.push(St)}O.length!==0&&c.clipboardData.setData("application/pdfjs",JSON.stringify(O))}cut(c){this.copy(c),this.delete()}paste(c){c.preventDefault();const{clipboardData:O}=c;for(const St of O.items)for(const Et of t(this,Qt))if(Et.isHandlingMimeForPasting(St.type)){Et.paste(St,this.currentLayer);return}let et=O.getData("application/pdfjs");if(!et)return;try{et=JSON.parse(et)}catch(St){(0,d.warn)(`paste: "${St.message}".`);return}if(!Array.isArray(et))return;this.unselectAll();const ct=this.currentLayer;try{const St=[];for(const Kt of et){const Yt=ct.deserialize(Kt);if(!Yt)return;St.push(Yt)}const Et=()=>{for(const Kt of St)A(this,lt,un).call(this,Kt);A(this,lt,pn).call(this,St)},It=()=>{for(const Kt of St)Kt.remove()};this.addCommands({cmd:Et,undo:It,mustExec:!0})}catch(St){(0,d.warn)(`paste: "${St.message}".`)}}keydown(c){!this.isShiftKeyDown&&c.key==="Shift"&&(this.isShiftKeyDown=!0),t(this,a)!==d.AnnotationEditorType.NONE&&!this.isEditorHandlingKeyboard&&zt._keyboardManager.exec(this,c)}keyup(c){this.isShiftKeyDown&&c.key==="Shift"&&(this.isShiftKeyDown=!1,t(this,ce)&&(_(this,ce,!1),A(this,lt,ui).call(this,"main_toolbar")))}onEditingAction({name:c}){switch(c){case"undo":case"redo":case"delete":case"selectAll":this[c]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(c){c?(A(this,lt,Tr).call(this),A(this,lt,cn).call(this),A(this,lt,Ne).call(this,{isEditing:t(this,a)!==d.AnnotationEditorType.NONE,isEmpty:A(this,lt,Hs).call(this),hasSomethingToUndo:t(this,Jt).hasSomethingToUndo(),hasSomethingToRedo:t(this,Jt).hasSomethingToRedo(),hasSelectedEditor:!1})):(A(this,lt,on).call(this),A(this,lt,dn).call(this),A(this,lt,Ne).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(c){if(!t(this,Qt)){_(this,Qt,c);for(const O of t(this,Qt))A(this,lt,ns).call(this,O.defaultPropertiesToUpdate)}}getId(){return t(this,Ot).id}get currentLayer(){return t(this,Dt).get(t(this,ne))}getLayer(c){return t(this,Dt).get(c)}get currentPageIndex(){return t(this,ne)}addLayer(c){t(this,Dt).set(c.pageIndex,c),t(this,bt)?c.enable():c.disable()}removeLayer(c){t(this,Dt).delete(c.pageIndex)}updateMode(c,O=null,et=!1){if(t(this,a)!==c){if(_(this,a,c),c===d.AnnotationEditorType.NONE){this.setEditingState(!1),A(this,lt,Rr).call(this);return}this.setEditingState(!0),A(this,lt,Mr).call(this),this.unselectAll();for(const ct of t(this,Dt).values())ct.updateMode(c);if(!O&&et){this.addNewEditorFromKeyboard();return}if(O){for(const ct of t(this,Mt).values())if(ct.annotationElementId===O){this.setSelected(ct),ct.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(c){c!==t(this,a)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:c})}updateParams(c,O){var et;if(t(this,Qt)){switch(c){case d.AnnotationEditorParamsType.CREATE:this.currentLayer.addNewEditor();return;case d.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:(et=t(this,n))==null||et.updateColor(O);break;case d.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(t(this,u)||_(this,u,new Map)).set(c,O),this.showAllEditors("highlight",O);break}for(const ct of t(this,h))ct.updateParams(c,O);for(const ct of t(this,Qt))ct.updateDefaultParams(c,O)}}showAllEditors(c,O,et=!1){var ct;for(const St of t(this,Mt).values())St.editorType===c&&St.show(O);(((ct=t(this,u))==null?void 0:ct.get(d.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL))??!0)!==O&&A(this,lt,ns).call(this,[[d.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL,O]])}enableWaiting(c=!1){if(t(this,gt)!==c){_(this,gt,c);for(const O of t(this,Dt).values())c?O.disableClick():O.enableClick(),O.div.classList.toggle("waiting",c)}}getEditors(c){const O=[];for(const et of t(this,Mt).values())et.pageIndex===c&&O.push(et);return O}getEditor(c){return t(this,Mt).get(c)}addEditor(c){t(this,Mt).set(c.id,c)}removeEditor(c){var O;c.div.contains(document.activeElement)&&(t(this,le)&&clearTimeout(t(this,le)),_(this,le,setTimeout(()=>{this.focusMainContainer(),_(this,le,null)},0))),t(this,Mt).delete(c.id),this.unselect(c),(!c.annotationElementId||!t(this,oe).has(c.annotationElementId))&&((O=t(this,Xt))==null||O.remove(c.id))}addDeletedAnnotationElement(c){t(this,oe).add(c.annotationElementId),this.addChangedExistingAnnotation(c),c.deleted=!0}isDeletedAnnotationElement(c){return t(this,oe).has(c)}removeDeletedAnnotationElement(c){t(this,oe).delete(c.annotationElementId),this.removeChangedExistingAnnotation(c),c.deleted=!1}setActiveEditor(c){t(this,nt)!==c&&(_(this,nt,c),c&&A(this,lt,ns).call(this,c.propertiesToUpdate))}updateUI(c){t(this,lt,Pr)===c&&A(this,lt,ns).call(this,c.propertiesToUpdate)}toggleSelected(c){if(t(this,h).has(c)){t(this,h).delete(c),c.unselect(),A(this,lt,Ne).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,h).add(c),c.select(),A(this,lt,ns).call(this,c.propertiesToUpdate),A(this,lt,Ne).call(this,{hasSelectedEditor:!0})}setSelected(c){for(const O of t(this,h))O!==c&&O.unselect();t(this,h).clear(),t(this,h).add(c),c.select(),A(this,lt,ns).call(this,c.propertiesToUpdate),A(this,lt,Ne).call(this,{hasSelectedEditor:!0})}isSelected(c){return t(this,h).has(c)}get firstSelectedEditor(){return t(this,h).values().next().value}unselect(c){c.unselect(),t(this,h).delete(c),A(this,lt,Ne).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,h).size!==0}get isEnterHandled(){return t(this,h).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){t(this,Jt).undo(),A(this,lt,Ne).call(this,{hasSomethingToUndo:t(this,Jt).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:A(this,lt,Hs).call(this)})}redo(){t(this,Jt).redo(),A(this,lt,Ne).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,Jt).hasSomethingToRedo(),isEmpty:A(this,lt,Hs).call(this)})}addCommands(c){t(this,Jt).add(c),A(this,lt,Ne).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:A(this,lt,Hs).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const c=[...t(this,h)],O=()=>{for(const ct of c)ct.remove()},et=()=>{for(const ct of c)A(this,lt,un).call(this,ct)};this.addCommands({cmd:O,undo:et,mustExec:!0})}commitOrRemove(){var c;(c=t(this,nt))==null||c.commitOrRemove()}hasSomethingToControl(){return t(this,nt)||this.hasSelection}selectAll(){for(const c of t(this,h))c.commit();A(this,lt,pn).call(this,t(this,Mt).values())}unselectAll(){if(!(t(this,nt)&&(t(this,nt).commitOrRemove(),t(this,a)!==d.AnnotationEditorType.NONE))&&this.hasSelection){for(const c of t(this,h))c.unselect();t(this,h).clear(),A(this,lt,Ne).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(c,O,et=!1){if(et||this.commitOrRemove(),!this.hasSelection)return;t(this,Nt)[0]+=c,t(this,Nt)[1]+=O;const[ct,St]=t(this,Nt),Et=[...t(this,h)];t(this,Gt)&&clearTimeout(t(this,Gt)),_(this,Gt,setTimeout(()=>{_(this,Gt,null),t(this,Nt)[0]=t(this,Nt)[1]=0,this.addCommands({cmd:()=>{for(const Kt of Et)t(this,Mt).has(Kt.id)&&Kt.translateInPage(ct,St)},undo:()=>{for(const Kt of Et)t(this,Mt).has(Kt.id)&&Kt.translateInPage(-ct,-St)},mustExec:!1})},1e3));for(const Kt of Et)Kt.translateInPage(c,O)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),_(this,Rt,new Map);for(const c of t(this,h))t(this,Rt).set(c,{savedX:c.x,savedY:c.y,savedPageIndex:c.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,Rt))return!1;this.disableUserSelect(!1);const c=t(this,Rt);_(this,Rt,null);let O=!1;for(const[{x:ct,y:St,pageIndex:Et},It]of c)It.newX=ct,It.newY=St,It.newPageIndex=Et,O||(O=ct!==It.savedX||St!==It.savedY||Et!==It.savedPageIndex);if(!O)return!1;const et=(ct,St,Et,It)=>{if(t(this,Mt).has(ct.id)){const Kt=t(this,Dt).get(It);Kt?ct._setParentAndPosition(Kt,St,Et):(ct.pageIndex=It,ct.x=St,ct.y=Et)}};return this.addCommands({cmd:()=>{for(const[ct,{newX:St,newY:Et,newPageIndex:It}]of c)et(ct,St,Et,It)},undo:()=>{for(const[ct,{savedX:St,savedY:Et,savedPageIndex:It}]of c)et(ct,St,Et,It)},mustExec:!0}),!0}dragSelectedEditors(c,O){if(t(this,Rt))for(const et of t(this,Rt).keys())et.drag(c,O)}rebuild(c){if(c.parent===null){const O=this.getLayer(c.pageIndex);O?(O.changeParent(c),O.addOrRebuild(c)):(this.addEditor(c),this.addToAnnotationStorage(c),c.rebuild())}else c.parent.addOrRebuild(c)}get isEditorHandlingKeyboard(){var c;return((c=this.getActive())==null?void 0:c.shouldGetKeyboardEvents())||t(this,h).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(c){return t(this,nt)===c}getActive(){return t(this,nt)}getMode(){return t(this,a)}get imageManager(){return(0,d.shadow)(this,"imageManager",new I)}getSelectionBoxes(c){if(!c)return null;const O=document.getSelection();for(let Yt=0,fe=O.rangeCount;Yt<fe;Yt++)if(!c.contains(O.getRangeAt(Yt).commonAncestorContainer))return null;const{x:et,y:ct,width:St,height:Et}=c.getBoundingClientRect();let It;switch(c.getAttribute("data-main-rotation")){case"90":It=(Yt,fe,Te,Re)=>({x:(fe-ct)/Et,y:1-(Yt+Te-et)/St,width:Re/Et,height:Te/St});break;case"180":It=(Yt,fe,Te,Re)=>({x:1-(Yt+Te-et)/St,y:1-(fe+Re-ct)/Et,width:Te/St,height:Re/Et});break;case"270":It=(Yt,fe,Te,Re)=>({x:1-(fe+Re-ct)/Et,y:(Yt-et)/St,width:Re/Et,height:Te/St});break;default:It=(Yt,fe,Te,Re)=>({x:(Yt-et)/St,y:(fe-ct)/Et,width:Te/St,height:Re/Et});break}const Kt=[];for(let Yt=0,fe=O.rangeCount;Yt<fe;Yt++){const Te=O.getRangeAt(Yt);if(!Te.collapsed)for(const{x:Re,y:Ue,width:Ie,height:js}of Te.getClientRects())Ie===0||js===0||Kt.push(It(Re,Ue,Ie,js))}return Kt.length===0?null:Kt}addChangedExistingAnnotation({annotationElementId:c,id:O}){(t(this,ae)||_(this,ae,new Map)).set(c,O)}removeChangedExistingAnnotation({annotationElementId:c}){var O;(O=t(this,ae))==null||O.delete(c)}renderAnnotationElement(c){var ct;const O=(ct=t(this,ae))==null?void 0:ct.get(c.data.id);if(!O)return;const et=t(this,Xt).getRawValue(O);et&&(t(this,a)===d.AnnotationEditorType.NONE&&!et.hasBeenModified||et.renderAnnotationElement(c))}};nt=new WeakMap,Mt=new WeakMap,Dt=new WeakMap,Lt=new WeakMap,Xt=new WeakMap,ae=new WeakMap,Jt=new WeakMap,ne=new WeakMap,oe=new WeakMap,Rt=new WeakMap,Qt=new WeakMap,ue=new WeakMap,be=new WeakMap,Ut=new WeakMap,le=new WeakMap,ee=new WeakMap,ce=new WeakMap,Zt=new WeakMap,Ot=new WeakMap,bt=new WeakMap,gt=new WeakMap,S=new WeakMap,n=new WeakMap,s=new WeakMap,a=new WeakMap,h=new WeakMap,l=new WeakMap,g=new WeakMap,u=new WeakMap,p=new WeakMap,M=new WeakMap,e=new WeakMap,i=new WeakMap,o=new WeakMap,m=new WeakMap,T=new WeakMap,$=new WeakMap,W=new WeakMap,tt=new WeakMap,ft=new WeakMap,it=new WeakMap,wt=new WeakMap,Nt=new WeakMap,Gt=new WeakMap,Wt=new WeakMap,Ht=new WeakMap,lt=new WeakSet,di=function({anchorNode:c}){return c.nodeType===Node.TEXT_NODE?c.parentElement:c},Er=function(){const c=document.getSelection();if(!c||c.isCollapsed)return;const O=A(this,lt,di).call(this,c).closest(".textLayer"),et=this.getSelectionBoxes(O);et&&(t(this,Zt)||_(this,Zt,new N.HighlightToolbar(this)),t(this,Zt).show(O,et,this.direction==="ltr"))},xr=function(){var et,ct,St;const c=document.getSelection();if(!c||c.isCollapsed){t(this,l)&&((et=t(this,Zt))==null||et.hide(),_(this,l,null),A(this,lt,Ne).call(this,{hasSelectedText:!1}));return}const{anchorNode:O}=c;if(O!==t(this,l)){if(!A(this,lt,di).call(this,c).closest(".textLayer")){t(this,l)&&((ct=t(this,Zt))==null||ct.hide(),_(this,l,null),A(this,lt,Ne).call(this,{hasSelectedText:!1}));return}if((St=t(this,Zt))==null||St.hide(),_(this,l,O),A(this,lt,Ne).call(this,{hasSelectedText:!0}),!(t(this,a)!==d.AnnotationEditorType.HIGHLIGHT&&t(this,a)!==d.AnnotationEditorType.NONE)&&(t(this,a)===d.AnnotationEditorType.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),_(this,ce,this.isShiftKeyDown),!this.isShiftKeyDown)){const Et=It=>{It.type==="pointerup"&&It.button!==0||(window.removeEventListener("pointerup",Et),window.removeEventListener("blur",Et),It.type==="pointerup"&&A(this,lt,ui).call(this,"main_toolbar"))};window.addEventListener("pointerup",Et),window.addEventListener("blur",Et)}}},ui=function(c=""){t(this,a)===d.AnnotationEditorType.HIGHLIGHT?this.highlightSelection(c):t(this,be)&&A(this,lt,Er).call(this)},Sr=function(){document.addEventListener("selectionchange",t(this,ft))},Cr=function(){document.removeEventListener("selectionchange",t(this,ft))},Tr=function(){window.addEventListener("focus",t(this,M)),window.addEventListener("blur",t(this,p))},on=function(){window.removeEventListener("focus",t(this,M)),window.removeEventListener("blur",t(this,p))},hn=function(){window.addEventListener("keydown",t(this,m)),window.addEventListener("keyup",t(this,T))},ln=function(){window.removeEventListener("keydown",t(this,m)),window.removeEventListener("keyup",t(this,T))},cn=function(){document.addEventListener("copy",t(this,e)),document.addEventListener("cut",t(this,i)),document.addEventListener("paste",t(this,o))},dn=function(){document.removeEventListener("copy",t(this,e)),document.removeEventListener("cut",t(this,i)),document.removeEventListener("paste",t(this,o))},Ne=function(c){Object.entries(c).some(([O,et])=>t(this,wt)[O]!==et)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,wt),c)}),t(this,a)===d.AnnotationEditorType.HIGHLIGHT&&c.hasSelectedEditor===!1&&A(this,lt,ns).call(this,[[d.AnnotationEditorParamsType.HIGHLIGHT_FREE,!0]]))},ns=function(c){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:c})},Mr=function(){if(!t(this,bt)){_(this,bt,!0);for(const c of t(this,Dt).values())c.enable();for(const c of t(this,Mt).values())c.enable()}},Rr=function(){if(this.unselectAll(),t(this,bt)){_(this,bt,!1);for(const c of t(this,Dt).values())c.disable();for(const c of t(this,Mt).values())c.disable()}},un=function(c){const O=t(this,Dt).get(c.pageIndex);O?O.addOrRebuild(c):(this.addEditor(c),this.addToAnnotationStorage(c))},Pr=function(){let c=null;for(c of t(this,h));return c},Hs=function(){if(t(this,Mt).size===0)return!0;if(t(this,Mt).size===1)for(const c of t(this,Mt).values())return c.isEmpty();return!1},pn=function(c){for(const O of t(this,h))O.unselect();t(this,h).clear();for(const O of c)O.isEmpty()||(t(this,h).add(O),O.select());A(this,lt,Ne).call(this,{hasSelectedEditor:this.hasSelection})},he(zt,"TRANSLATE_SMALL",1),he(zt,"TRANSLATE_BIG",10);let y=zt},94:(se,Vt,dt)=>{dt.d(Vt,{PDFFetchStream:()=>H});var d=dt(292),J=dt(490);function N(j,x,y){return{method:"GET",headers:j,signal:y.signal,mode:"cors",credentials:x?"include":"same-origin",redirect:"follow"}}function Y(j){const x=new Headers;for(const y in j){const F=j[y];F!==void 0&&x.append(y,F)}return x}function pt(j){return j instanceof Uint8Array?j.buffer:j instanceof ArrayBuffer?j:((0,d.warn)(`getArrayBuffer - unexpected data format: ${j}`),new Uint8Array(j).buffer)}class H{constructor(x){this.source=x,this.isHttp=/^https?:/i.test(x.url),this.httpHeaders=this.isHttp&&x.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var x;return((x=this._fullRequestReader)==null?void 0:x._loaded)??0}getFullReader(){return(0,d.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new I(this),this._fullRequestReader}getRangeReader(x,y){if(y<=this._progressiveDataLength)return null;const F=new k(this,x,y);return this._rangeRequestReaders.push(F),F}cancelAllRequests(x){var y;(y=this._fullRequestReader)==null||y.cancel(x);for(const F of this._rangeRequestReaders.slice(0))F.cancel(x)}}class I{constructor(x){this._stream=x,this._reader=null,this._loaded=0,this._filename=null;const y=x.source;this._withCredentials=y.withCredentials||!1,this._contentLength=y.length,this._headersCapability=Promise.withResolvers(),this._disableRange=y.disableRange||!1,this._rangeChunkSize=y.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!y.disableStream,this._isRangeSupported=!y.disableRange,this._headers=Y(this._stream.httpHeaders);const F=y.url;fetch(F,N(this._headers,this._withCredentials,this._abortController)).then(D=>{if(!(0,J.validateResponseStatus)(D.status))throw(0,J.createResponseStatusError)(D.status,F);this._reader=D.body.getReader(),this._headersCapability.resolve();const Z=P=>D.headers.get(P),{allowRangeRequests:U,suggestedLength:K}=(0,J.validateRangeRequestCapabilities)({getResponseHeader:Z,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=U,this._contentLength=K||this._contentLength,this._filename=(0,J.extractFilenameFromHeader)(Z),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new d.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var F;await this._headersCapability.promise;const{value:x,done:y}=await this._reader.read();return y?{value:x,done:y}:(this._loaded+=x.byteLength,(F=this.onProgress)==null||F.call(this,{loaded:this._loaded,total:this._contentLength}),{value:pt(x),done:!1})}cancel(x){var y;(y=this._reader)==null||y.cancel(x),this._abortController.abort()}}class k{constructor(x,y,F){this._stream=x,this._reader=null,this._loaded=0;const D=x.source;this._withCredentials=D.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!D.disableStream,this._abortController=new AbortController,this._headers=Y(this._stream.httpHeaders),this._headers.append("Range",`bytes=${y}-${F-1}`);const Z=D.url;fetch(Z,N(this._headers,this._withCredentials,this._abortController)).then(U=>{if(!(0,J.validateResponseStatus)(U.status))throw(0,J.createResponseStatusError)(U.status,Z);this._readCapability.resolve(),this._reader=U.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var F;await this._readCapability.promise;const{value:x,done:y}=await this._reader.read();return y?{value:x,done:y}:(this._loaded+=x.byteLength,(F=this.onProgress)==null||F.call(this,{loaded:this._loaded}),{value:pt(x),done:!1})}cancel(x){var y;(y=this._reader)==null||y.cancel(x),this._abortController.abort()}}},10:(se,Vt,dt)=>{var Y;dt.d(Vt,{FontFaceObject:()=>N,FontLoader:()=>J});var d=dt(292);class J{constructor({ownerDocument:H=globalThis.document,styleElement:I=null}){w(this,Y,new Set);this._document=H,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(H){this.nativeFontFaces.add(H),this._document.fonts.add(H)}removeNativeFontFace(H){this.nativeFontFaces.delete(H),this._document.fonts.delete(H)}insertRule(H){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const I=this.styleElement.sheet;I.insertRule(H,I.cssRules.length)}clear(){for(const H of this.nativeFontFaces)this._document.fonts.delete(H);this.nativeFontFaces.clear(),t(this,Y).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:H,_inspectFont:I}){if(!(!H||t(this,Y).has(H.loadedName))){if((0,d.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:k,src:j,style:x}=H,y=new FontFace(k,j,x);this.addNativeFontFace(y);try{await y.load(),t(this,Y).add(k),I==null||I(H)}catch{(0,d.warn)(`Cannot load system font: ${H.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(y)}return}(0,d.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(H){if(H.attached||H.missingFile&&!H.systemFontInfo)return;if(H.attached=!0,H.systemFontInfo){await this.loadSystemFont(H);return}if(this.isFontLoadingAPISupported){const k=H.createNativeFontFace();if(k){this.addNativeFontFace(k);try{await k.loaded}catch(j){throw(0,d.warn)(`Failed to load font '${k.family}': '${j}'.`),H.disableFontFace=!0,j}}return}const I=H.createFontFaceRule();if(I){if(this.insertRule(I),this.isSyncFontLoadingSupported)return;await new Promise(k=>{const j=this._queueLoadingCallback(k);this._prepareFontLoadEvent(H,j)})}}get isFontLoadingAPISupported(){var I;const H=!!((I=this._document)!=null&&I.fonts);return(0,d.shadow)(this,"isFontLoadingAPISupported",H)}get isSyncFontLoadingSupported(){let H=!1;return(d.isNodeJS||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(H=!0),(0,d.shadow)(this,"isSyncFontLoadingSupported",H)}_queueLoadingCallback(H){function I(){for((0,d.assert)(!j.done,"completeRequest() cannot be called twice."),j.done=!0;k.length>0&&k[0].done;){const x=k.shift();setTimeout(x.callback,0)}}const{loadingRequests:k}=this,j={done:!1,complete:I,callback:H};return k.push(j),j}get _loadTestFont(){const H=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,d.shadow)(this,"_loadTestFont",H)}_prepareFontLoadEvent(H,I){function k(Tt,ot){return Tt.charCodeAt(ot)<<24|Tt.charCodeAt(ot+1)<<16|Tt.charCodeAt(ot+2)<<8|Tt.charCodeAt(ot+3)&255}function j(Tt,ot,nt,Mt){const Dt=Tt.substring(0,ot),Lt=Tt.substring(ot+nt);return Dt+Mt+Lt}let x,y;const F=this._document.createElement("canvas");F.width=1,F.height=1;const D=F.getContext("2d");let Z=0;function U(Tt,ot){if(++Z>30){(0,d.warn)("Load test font never loaded."),ot();return}if(D.font="30px "+Tt,D.fillText(".",0,20),D.getImageData(0,0,1,1).data[3]>0){ot();return}setTimeout(U.bind(null,Tt,ot))}const K=`lt${Date.now()}${this.loadTestFontId++}`;let P=this._loadTestFont;P=j(P,976,K.length,K);const B=16,R=1482184792;let L=k(P,B);for(x=0,y=K.length-3;x<y;x+=4)L=L-R+k(K,x)|0;x<K.length&&(L=L-R+k(K+"XXX",x)|0),P=j(P,B,4,(0,d.string32)(L));const ht=`url(data:font/opentype;base64,${btoa(P)});`,st=`@font-face {font-family:"${K}";src:${ht}}`;this.insertRule(st);const At=this._document.createElement("div");At.style.visibility="hidden",At.style.width=At.style.height="10px",At.style.position="absolute",At.style.top=At.style.left="0px";for(const Tt of[H.loadedName,K]){const ot=this._document.createElement("span");ot.textContent="Hi",ot.style.fontFamily=Tt,At.append(ot)}this._document.body.append(At),U(K,()=>{At.remove(),I.complete()})}}Y=new WeakMap;class N{constructor(H,{disableFontFace:I=!1,ignoreErrors:k=!1,inspectFont:j=null}){this.compiledGlyphs=Object.create(null);for(const x in H)this[x]=H[x];this.disableFontFace=I===!0,this.ignoreErrors=k===!0,this._inspectFont=j}createNativeFontFace(){var I;if(!this.data||this.disableFontFace)return null;let H;if(!this.cssFontInfo)H=new FontFace(this.loadedName,this.data,{});else{const k={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(k.style=`oblique ${this.cssFontInfo.italicAngle}deg`),H=new FontFace(this.cssFontInfo.fontFamily,this.data,k)}return(I=this._inspectFont)==null||I.call(this,this),H}createFontFaceRule(){var j;if(!this.data||this.disableFontFace)return null;const H=(0,d.bytesToString)(this.data),I=`url(data:${this.mimetype};base64,${btoa(H)});`;let k;if(!this.cssFontInfo)k=`@font-face {font-family:"${this.loadedName}";src:${I}}`;else{let x=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(x+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),k=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${x}src:${I}}`}return(j=this._inspectFont)==null||j.call(this,this,I),k}getPathGenerator(H,I){if(this.compiledGlyphs[I]!==void 0)return this.compiledGlyphs[I];let k;try{k=H.get(this.loadedName+"_path_"+I)}catch(x){if(!this.ignoreErrors)throw x;(0,d.warn)(`getPathGenerator - ignoring character: "${x}".`)}if(!Array.isArray(k)||k.length===0)return this.compiledGlyphs[I]=function(x,y){};const j=[];for(let x=0,y=k.length;x<y;)switch(k[x++]){case d.FontRenderOps.BEZIER_CURVE_TO:{const[F,D,Z,U,K,P]=k.slice(x,x+6);j.push(B=>B.bezierCurveTo(F,D,Z,U,K,P)),x+=6}break;case d.FontRenderOps.MOVE_TO:{const[F,D]=k.slice(x,x+2);j.push(Z=>Z.moveTo(F,D)),x+=2}break;case d.FontRenderOps.LINE_TO:{const[F,D]=k.slice(x,x+2);j.push(Z=>Z.lineTo(F,D)),x+=2}break;case d.FontRenderOps.QUADRATIC_CURVE_TO:{const[F,D,Z,U]=k.slice(x,x+4);j.push(K=>K.quadraticCurveTo(F,D,Z,U)),x+=4}break;case d.FontRenderOps.RESTORE:j.push(F=>F.restore());break;case d.FontRenderOps.SAVE:j.push(F=>F.save());break;case d.FontRenderOps.SCALE:(0,d.assert)(j.length===2,"Scale command is only valid at the third position.");break;case d.FontRenderOps.TRANSFORM:{const[F,D,Z,U,K,P]=k.slice(x,x+6);j.push(B=>B.transform(F,D,Z,U,K,P)),x+=6}break;case d.FontRenderOps.TRANSLATE:{const[F,D]=k.slice(x,x+2);j.push(Z=>Z.translate(F,D)),x+=2}break}return this.compiledGlyphs[I]=function(x,y){j[0](x),j[1](x),x.scale(y,-y);for(let F=2,D=j.length;F<D;F++)j[F](x)}}}},62:(se,Vt,dt)=>{var N,Y;dt.d(Vt,{Metadata:()=>J});var d=dt(292);class J{constructor({parsedData:H,rawData:I}){w(this,N);w(this,Y);_(this,N,H),_(this,Y,I)}getRaw(){return t(this,Y)}get(H){return t(this,N).get(H)??null}getAll(){return(0,d.objectFromMap)(t(this,N))}has(H){return t(this,N).has(H)}}N=new WeakMap,Y=new WeakMap},457:(se,Vt,dt)=>{dt.d(Vt,{PDFNetworkStream:()=>I});var d=dt(292),J=dt(490);const N=200,Y=206;function pt(x){const y=x.response;return typeof y!="string"?y:(0,d.stringToBytes)(y).buffer}class H{constructor(y,F={}){this.url=y,this.isHttp=/^https?:/i.test(y),this.httpHeaders=this.isHttp&&F.httpHeaders||Object.create(null),this.withCredentials=F.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(y,F,D){const Z={begin:y,end:F};for(const U in D)Z[U]=D[U];return this.request(Z)}requestFull(y){return this.request(y)}request(y){const F=new XMLHttpRequest,D=this.currXhrId++,Z=this.pendingRequests[D]={xhr:F};F.open("GET",this.url),F.withCredentials=this.withCredentials;for(const U in this.httpHeaders){const K=this.httpHeaders[U];K!==void 0&&F.setRequestHeader(U,K)}return this.isHttp&&"begin"in y&&"end"in y?(F.setRequestHeader("Range",`bytes=${y.begin}-${y.end-1}`),Z.expectedStatus=Y):Z.expectedStatus=N,F.responseType="arraybuffer",y.onError&&(F.onerror=function(U){y.onError(F.status)}),F.onreadystatechange=this.onStateChange.bind(this,D),F.onprogress=this.onProgress.bind(this,D),Z.onHeadersReceived=y.onHeadersReceived,Z.onDone=y.onDone,Z.onError=y.onError,Z.onProgress=y.onProgress,F.send(null),D}onProgress(y,F){var Z;const D=this.pendingRequests[y];D&&((Z=D.onProgress)==null||Z.call(D,F))}onStateChange(y,F){var P,B,R;const D=this.pendingRequests[y];if(!D)return;const Z=D.xhr;if(Z.readyState>=2&&D.onHeadersReceived&&(D.onHeadersReceived(),delete D.onHeadersReceived),Z.readyState!==4||!(y in this.pendingRequests))return;if(delete this.pendingRequests[y],Z.status===0&&this.isHttp){(P=D.onError)==null||P.call(D,Z.status);return}const U=Z.status||N;if(!(U===N&&D.expectedStatus===Y)&&U!==D.expectedStatus){(B=D.onError)==null||B.call(D,Z.status);return}const K=pt(Z);if(U===Y){const L=Z.getResponseHeader("Content-Range"),ht=/bytes (\d+)-(\d+)\/(\d+)/.exec(L);D.onDone({begin:parseInt(ht[1],10),chunk:K})}else K?D.onDone({begin:0,chunk:K}):(R=D.onError)==null||R.call(D,Z.status)}getRequestXhr(y){return this.pendingRequests[y].xhr}isPendingRequest(y){return y in this.pendingRequests}abortRequest(y){const F=this.pendingRequests[y].xhr;delete this.pendingRequests[y],F.abort()}}class I{constructor(y){this._source=y,this._manager=new H(y.url,{httpHeaders:y.httpHeaders,withCredentials:y.withCredentials}),this._rangeChunkSize=y.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(y){const F=this._rangeRequestReaders.indexOf(y);F>=0&&this._rangeRequestReaders.splice(F,1)}getFullReader(){return(0,d.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new k(this._manager,this._source),this._fullRequestReader}getRangeReader(y,F){const D=new j(this._manager,y,F);return D.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(D),D}cancelAllRequests(y){var F;(F=this._fullRequestReader)==null||F.cancel(y);for(const D of this._rangeRequestReaders.slice(0))D.cancel(y)}}class k{constructor(y,F){this._manager=y;const D={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=F.url,this._fullRequestId=y.requestFull(D),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=F.disableRange||!1,this._contentLength=F.length,this._rangeChunkSize=F.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const y=this._fullRequestId,F=this._manager.getRequestXhr(y),D=K=>F.getResponseHeader(K),{allowRangeRequests:Z,suggestedLength:U}=(0,J.validateRangeRequestCapabilities)({getResponseHeader:D,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});Z&&(this._isRangeSupported=!0),this._contentLength=U||this._contentLength,this._filename=(0,J.extractFilenameFromHeader)(D),this._isRangeSupported&&this._manager.abortRequest(y),this._headersReceivedCapability.resolve()}_onDone(y){if(y&&(this._requests.length>0?this._requests.shift().resolve({value:y.chunk,done:!1}):this._cachedChunks.push(y.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(y){this._storedError=(0,J.createResponseStatusError)(y,this._url),this._headersReceivedCapability.reject(this._storedError);for(const F of this._requests)F.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(y){var F;(F=this.onProgress)==null||F.call(this,{loaded:y.loaded,total:y.lengthComputable?y.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const y=Promise.withResolvers();return this._requests.push(y),y.promise}cancel(y){this._done=!0,this._headersReceivedCapability.reject(y);for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class j{constructor(y,F,D){this._manager=y;const Z={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=y.url,this._requestId=y.requestRange(F,D,Z),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var y;(y=this.onClosed)==null||y.call(this,this)}_onDone(y){const F=y.chunk;this._requests.length>0?this._requests.shift().resolve({value:F,done:!1}):this._queuedChunk=F,this._done=!0;for(const D of this._requests)D.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(y){this._storedError=(0,J.createResponseStatusError)(y,this._url);for(const F of this._requests)F.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(y){var F;this.isStreamingSupported||((F=this.onProgress)==null||F.call(this,{loaded:y.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const F=this._queuedChunk;return this._queuedChunk=null,{value:F,done:!1}}if(this._done)return{value:void 0,done:!0};const y=Promise.withResolvers();return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},490:(se,Vt,dt)=>{dt.d(Vt,{createResponseStatusError:()=>H,extractFilenameFromHeader:()=>pt,validateRangeRequestCapabilities:()=>Y,validateResponseStatus:()=>I});var d=dt(292);function J(k){let j=!0,x=y("filename\\*","i").exec(k);if(x){x=x[1];let B=U(x);return B=unescape(B),B=K(B),B=P(B),D(B)}if(x=Z(k),x){const B=P(x);return D(B)}if(x=y("filename","i").exec(k),x){x=x[1];let B=U(x);return B=P(B),D(B)}function y(B,R){return new RegExp("(?:^|;)\\s*"+B+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',R)}function F(B,R){if(B){if(!/^[\x00-\xFF]+$/.test(R))return R;try{const L=new TextDecoder(B,{fatal:!0}),ht=(0,d.stringToBytes)(R);R=L.decode(ht),j=!1}catch{}}return R}function D(B){return j&&/[\x80-\xff]/.test(B)&&(B=F("utf-8",B),j&&(B=F("iso-8859-1",B))),B}function Z(B){const R=[];let L;const ht=y("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(L=ht.exec(B))!==null;){let[,At,Tt,ot]=L;if(At=parseInt(At,10),At in R){if(At===0)break;continue}R[At]=[Tt,ot]}const st=[];for(let At=0;At<R.length&&At in R;++At){let[Tt,ot]=R[At];ot=U(ot),Tt&&(ot=unescape(ot),At===0&&(ot=K(ot))),st.push(ot)}return st.join("")}function U(B){if(B.startsWith('"')){const R=B.slice(1).split('\\"');for(let L=0;L<R.length;++L){const ht=R[L].indexOf('"');ht!==-1&&(R[L]=R[L].slice(0,ht),R.length=L+1),R[L]=R[L].replaceAll(/\\(.)/g,"$1")}B=R.join('"')}return B}function K(B){const R=B.indexOf("'");if(R===-1)return B;const L=B.slice(0,R),ht=B.slice(R+1).replace(/^[^']*'/,"");return F(L,ht)}function P(B){return!B.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(B)?B:B.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(R,L,ht,st){if(ht==="q"||ht==="Q")return st=st.replaceAll("_"," "),st=st.replaceAll(/=([0-9a-fA-F]{2})/g,function(At,Tt){return String.fromCharCode(parseInt(Tt,16))}),F(L,st);try{st=atob(st)}catch{}return F(L,st)})}return""}var N=dt(419);function Y({getResponseHeader:k,isHttp:j,rangeChunkSize:x,disableRange:y}){const F={allowRangeRequests:!1,suggestedLength:void 0},D=parseInt(k("Content-Length"),10);return!Number.isInteger(D)||(F.suggestedLength=D,D<=2*x)||y||!j||k("Accept-Ranges")!=="bytes"||(k("Content-Encoding")||"identity")!=="identity"||(F.allowRangeRequests=!0),F}function pt(k){const j=k("Content-Disposition");if(j){let x=J(j);if(x.includes("%"))try{x=decodeURIComponent(x)}catch{}if((0,N.isPdfFile)(x))return x}return null}function H(k,j){return k===404||k===0&&j.startsWith("file:")?new d.MissingPDFException('Missing PDF "'+j+'".'):new d.UnexpectedResponseException(`Unexpected server response (${k}) while retrieving PDF "${j}".`,k)}function I(k){return k===200||k===206}},786:(se,Vt,dt)=>{dt.a(se,async(d,J)=>{try{let pt=function(R){const L=x.parse(R);return L.protocol==="file:"||L.host?L:/^[a-z]:[/\\]/i.test(R)?x.parse(`file:///${R}`):(L.host||(L.protocol="file:"),L)},H=function(R,L){return{protocol:R.protocol,auth:R.auth,host:R.hostname,port:R.port,path:R.path,method:"GET",headers:L}};dt.d(Vt,{PDFNodeStream:()=>F});var N=dt(292),Y=dt(490);let I,k,j,x;N.isNodeJS&&(I=await Qe(()=>import("./vite-browser-external.BIHI7g3E.js"),[]),k=await Qe(()=>import("./vite-browser-external.BIHI7g3E.js"),[]),j=await Qe(()=>import("./vite-browser-external.BIHI7g3E.js"),[]),x=await Qe(()=>import("./vite-browser-external.BIHI7g3E.js"),[]));const y=/^file:\/\/\/[a-zA-Z]:\//;class F{constructor(L){this.source=L,this.url=pt(L.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&L.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var L;return((L=this._fullRequestReader)==null?void 0:L._loaded)??0}getFullReader(){return(0,N.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new P(this):new U(this),this._fullRequestReader}getRangeReader(L,ht){if(ht<=this._progressiveDataLength)return null;const st=this.isFsUrl?new B(this,L,ht):new K(this,L,ht);return this._rangeRequestReaders.push(st),st}cancelAllRequests(L){var ht;(ht=this._fullRequestReader)==null||ht.cancel(L);for(const st of this._rangeRequestReaders.slice(0))st.cancel(L)}}class D{constructor(L){this._url=L.url,this._done=!1,this._storedError=null,this.onProgress=null;const ht=L.source;this._contentLength=ht.length,this._loaded=0,this._filename=null,this._disableRange=ht.disableRange||!1,this._rangeChunkSize=ht.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!ht.disableStream,this._isRangeSupported=!ht.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var ht;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const L=this._readableStream.read();return L===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=L.length,(ht=this.onProgress)==null||ht.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(L).buffer,done:!1})}cancel(L){if(!this._readableStream){this._error(L);return}this._readableStream.destroy(L)}_error(L){this._storedError=L,this._readCapability.resolve()}_setReadableStream(L){this._readableStream=L,L.on("readable",()=>{this._readCapability.resolve()}),L.on("end",()=>{L.destroy(),this._done=!0,this._readCapability.resolve()}),L.on("error",ht=>{this._error(ht)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new N.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Z{constructor(L){this._url=L.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const ht=L.source;this._isStreamingSupported=!ht.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var ht;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const L=this._readableStream.read();return L===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=L.length,(ht=this.onProgress)==null||ht.call(this,{loaded:this._loaded}),{value:new Uint8Array(L).buffer,done:!1})}cancel(L){if(!this._readableStream){this._error(L);return}this._readableStream.destroy(L)}_error(L){this._storedError=L,this._readCapability.resolve()}_setReadableStream(L){this._readableStream=L,L.on("readable",()=>{this._readCapability.resolve()}),L.on("end",()=>{L.destroy(),this._done=!0,this._readCapability.resolve()}),L.on("error",ht=>{this._error(ht)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class U extends D{constructor(L){super(L);const ht=st=>{if(st.statusCode===404){const nt=new N.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=nt,this._headersCapability.reject(nt);return}this._headersCapability.resolve(),this._setReadableStream(st);const At=nt=>this._readableStream.headers[nt.toLowerCase()],{allowRangeRequests:Tt,suggestedLength:ot}=(0,Y.validateRangeRequestCapabilities)({getResponseHeader:At,isHttp:L.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Tt,this._contentLength=ot||this._contentLength,this._filename=(0,Y.extractFilenameFromHeader)(At)};this._request=null,this._url.protocol==="http:"?this._request=k.request(H(this._url,L.httpHeaders),ht):this._request=j.request(H(this._url,L.httpHeaders),ht),this._request.on("error",st=>{this._storedError=st,this._headersCapability.reject(st)}),this._request.end()}}class K extends Z{constructor(L,ht,st){super(L),this._httpHeaders={};for(const Tt in L.httpHeaders){const ot=L.httpHeaders[Tt];ot!==void 0&&(this._httpHeaders[Tt]=ot)}this._httpHeaders.Range=`bytes=${ht}-${st-1}`;const At=Tt=>{if(Tt.statusCode===404){const ot=new N.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=ot;return}this._setReadableStream(Tt)};this._request=null,this._url.protocol==="http:"?this._request=k.request(H(this._url,this._httpHeaders),At):this._request=j.request(H(this._url,this._httpHeaders),At),this._request.on("error",Tt=>{this._storedError=Tt}),this._request.end()}}class P extends D{constructor(L){super(L);let ht=decodeURIComponent(this._url.path);y.test(this._url.href)&&(ht=ht.replace(/^\//,"")),I.promises.lstat(ht).then(st=>{this._contentLength=st.size,this._setReadableStream(I.createReadStream(ht)),this._headersCapability.resolve()},st=>{st.code==="ENOENT"&&(st=new N.MissingPDFException(`Missing PDF "${ht}".`)),this._storedError=st,this._headersCapability.reject(st)})}}class B extends Z{constructor(L,ht,st){super(L);let At=decodeURIComponent(this._url.path);y.test(this._url.href)&&(At=At.replace(/^\//,"")),this._setReadableStream(I.createReadStream(At,{start:ht,end:st-1}))}}J()}catch(pt){J(pt)}},1)},573:(se,Vt,dt)=>{dt.a(se,async(d,J)=>{try{dt.d(Vt,{NodeCMapReaderFactory:()=>y,NodeCanvasFactory:()=>x,NodeFilterFactory:()=>j,NodeStandardFontDataFactory:()=>F});var N=dt(583),Y=dt(292);let pt,H,I;if(Y.isNodeJS){pt=await Qe(()=>import("./vite-browser-external.BIHI7g3E.js"),[]);try{H=await Qe(()=>import("./vite-browser-external.BIHI7g3E.js"),[])}catch{}try{I=await Qe(()=>import("./path2d.-EVKqUhF.js"),[])}catch{}}const k=function(D){return pt.promises.readFile(D).then(Z=>new Uint8Array(Z))};class j extends N.BaseFilterFactory{}class x extends N.BaseCanvasFactory{_createCanvas(Z,U){return H.createCanvas(Z,U)}}class y extends N.BaseCMapReaderFactory{_fetchData(Z,U){return k(Z).then(K=>({cMapData:K,compressionType:U}))}}class F extends N.BaseStandardFontDataFactory{_fetchData(Z){return k(Z)}}J()}catch(pt){J(pt)}},1)},626:(se,Vt,dt)=>{var H,I,k,j,x,y,F,D,Z,gn;dt.d(Vt,{OptionalContentConfig:()=>pt});var d=dt(292),J=dt(651);const N=Symbol("INTERNAL");class Y{constructor(P,{name:B,intent:R,usage:L}){w(this,H,!1);w(this,I,!1);w(this,k,!1);w(this,j,!0);_(this,H,!!(P&d.RenderingIntentFlag.DISPLAY)),_(this,I,!!(P&d.RenderingIntentFlag.PRINT)),this.name=B,this.intent=R,this.usage=L}get visible(){if(t(this,k))return t(this,j);if(!t(this,j))return!1;const{print:P,view:B}=this.usage;return t(this,H)?(B==null?void 0:B.viewState)!=="OFF":t(this,I)?(P==null?void 0:P.printState)!=="OFF":!0}_setVisible(P,B,R=!1){P!==N&&(0,d.unreachable)("Internal method `_setVisible` called."),_(this,k,R),_(this,j,B)}}H=new WeakMap,I=new WeakMap,k=new WeakMap,j=new WeakMap;class pt{constructor(P,B=d.RenderingIntentFlag.DISPLAY){w(this,Z);w(this,x,null);w(this,y,new Map);w(this,F,null);w(this,D,null);if(this.renderingIntent=B,this.name=null,this.creator=null,P!==null){this.name=P.name,this.creator=P.creator,_(this,D,P.order);for(const R of P.groups)t(this,y).set(R.id,new Y(B,R));if(P.baseState==="OFF")for(const R of t(this,y).values())R._setVisible(N,!1);for(const R of P.on)t(this,y).get(R)._setVisible(N,!0);for(const R of P.off)t(this,y).get(R)._setVisible(N,!1);_(this,F,this.getHash())}}isVisible(P){if(t(this,y).size===0)return!0;if(!P)return(0,d.info)("Optional content group not defined."),!0;if(P.type==="OCG")return t(this,y).has(P.id)?t(this,y).get(P.id).visible:((0,d.warn)(`Optional content group not found: ${P.id}`),!0);if(P.type==="OCMD"){if(P.expression)return A(this,Z,gn).call(this,P.expression);if(!P.policy||P.policy==="AnyOn"){for(const B of P.ids){if(!t(this,y).has(B))return(0,d.warn)(`Optional content group not found: ${B}`),!0;if(t(this,y).get(B).visible)return!0}return!1}else if(P.policy==="AllOn"){for(const B of P.ids){if(!t(this,y).has(B))return(0,d.warn)(`Optional content group not found: ${B}`),!0;if(!t(this,y).get(B).visible)return!1}return!0}else if(P.policy==="AnyOff"){for(const B of P.ids){if(!t(this,y).has(B))return(0,d.warn)(`Optional content group not found: ${B}`),!0;if(!t(this,y).get(B).visible)return!0}return!1}else if(P.policy==="AllOff"){for(const B of P.ids){if(!t(this,y).has(B))return(0,d.warn)(`Optional content group not found: ${B}`),!0;if(t(this,y).get(B).visible)return!1}return!0}return(0,d.warn)(`Unknown optional content policy ${P.policy}.`),!0}return(0,d.warn)(`Unknown group type ${P.type}.`),!0}setVisibility(P,B=!0){const R=t(this,y).get(P);if(!R){(0,d.warn)(`Optional content group not found: ${P}`);return}R._setVisible(N,!!B,!0),_(this,x,null)}setOCGState({state:P,preserveRB:B}){let R;for(const L of P){switch(L){case"ON":case"OFF":case"Toggle":R=L;continue}const ht=t(this,y).get(L);if(ht)switch(R){case"ON":ht._setVisible(N,!0);break;case"OFF":ht._setVisible(N,!1);break;case"Toggle":ht._setVisible(N,!ht.visible);break}}_(this,x,null)}get hasInitialVisibility(){return t(this,F)===null||this.getHash()===t(this,F)}getOrder(){return t(this,y).size?t(this,D)?t(this,D).slice():[...t(this,y).keys()]:null}getGroups(){return t(this,y).size>0?(0,d.objectFromMap)(t(this,y)):null}getGroup(P){return t(this,y).get(P)||null}getHash(){if(t(this,x)!==null)return t(this,x);const P=new J.MurmurHash3_64;for(const[B,R]of t(this,y))P.update(`${B}:${R.visible}`);return _(this,x,P.hexdigest())}}x=new WeakMap,y=new WeakMap,F=new WeakMap,D=new WeakMap,Z=new WeakSet,gn=function(P){const B=P.length;if(B<2)return!0;const R=P[0];for(let L=1;L<B;L++){const ht=P[L];let st;if(Array.isArray(ht))st=A(this,Z,gn).call(this,ht);else if(t(this,y).has(ht))st=t(this,y).get(ht).visible;else return(0,d.warn)(`Optional content group not found: ${ht}`),!0;switch(R){case"And":if(!st)return!1;break;case"Or":if(st)return!0;break;case"Not":return!st;default:return!0}}return R==="And"}},814:(se,Vt,dt)=>{dt.d(Vt,{cleanupTextLayer:()=>j,renderTextLayer:()=>U,updateTextLayer:()=>K});var d=dt(292),J=dt(419);const N=1e5,Y=30,pt=.8,H=new Map;let I=null;function k(){if(!I){const P=document.createElement("canvas");P.className="hiddenCanvasElement",document.body.append(P),I=P.getContext("2d",{alpha:!1})}return I}function j(){I==null||I.canvas.remove(),I=null}function x(P){const B=H.get(P);if(B)return B;const R=k(),L=R.font;R.canvas.width=R.canvas.height=Y,R.font=`${Y}px ${P}`;const ht=R.measureText("");let st=ht.fontBoundingBoxAscent,At=Math.abs(ht.fontBoundingBoxDescent);if(st){const ot=st/(st+At);return H.set(P,ot),R.canvas.width=R.canvas.height=0,R.font=L,ot}R.strokeStyle="red",R.clearRect(0,0,Y,Y),R.strokeText("g",0,0);let Tt=R.getImageData(0,0,Y,Y).data;At=0;for(let ot=Tt.length-1-3;ot>=0;ot-=4)if(Tt[ot]>0){At=Math.ceil(ot/4/Y);break}R.clearRect(0,0,Y,Y),R.strokeText("A",0,Y),Tt=R.getImageData(0,0,Y,Y).data,st=0;for(let ot=0,nt=Tt.length;ot<nt;ot+=4)if(Tt[ot]>0){st=Y-Math.floor(ot/4/Y);break}if(R.canvas.width=R.canvas.height=0,R.font=L,st){const ot=st/(st+At);return H.set(P,ot),ot}return H.set(P,pt),pt}function y(P,B,R){const L=document.createElement("span"),ht={angle:0,canvasWidth:0,hasText:B.str!=="",hasEOL:B.hasEOL,fontSize:0};P._textDivs.push(L);const st=d.Util.transform(P._transform,B.transform);let At=Math.atan2(st[1],st[0]);const Tt=R[B.fontName];Tt.vertical&&(At+=Math.PI/2);const ot=P._fontInspectorEnabled&&Tt.fontSubstitution||Tt.fontFamily,nt=Math.hypot(st[2],st[3]),Mt=nt*x(ot);let Dt,Lt;At===0?(Dt=st[4],Lt=st[5]-Mt):(Dt=st[4]+Mt*Math.sin(At),Lt=st[5]-Mt*Math.cos(At));const Xt="calc(var(--scale-factor)*",ae=L.style;P._container===P._rootContainer?(ae.left=`${(100*Dt/P._pageWidth).toFixed(2)}%`,ae.top=`${(100*Lt/P._pageHeight).toFixed(2)}%`):(ae.left=`${Xt}${Dt.toFixed(2)}px)`,ae.top=`${Xt}${Lt.toFixed(2)}px)`),ae.fontSize=`${Xt}${nt.toFixed(2)}px)`,ae.fontFamily=ot,ht.fontSize=nt,L.setAttribute("role","presentation"),L.textContent=B.str,L.dir=B.dir,P._fontInspectorEnabled&&(L.dataset.fontName=Tt.fontSubstitutionLoadedName||B.fontName),At!==0&&(ht.angle=At*(180/Math.PI));let Jt=!1;if(B.str.length>1)Jt=!0;else if(B.str!==" "&&B.transform[0]!==B.transform[3]){const ne=Math.abs(B.transform[0]),oe=Math.abs(B.transform[3]);ne!==oe&&Math.max(ne,oe)/Math.min(ne,oe)>1.5&&(Jt=!0)}Jt&&(ht.canvasWidth=Tt.vertical?B.height:B.width),P._textDivProperties.set(L,ht),P._isReadableStream&&P._layoutText(L)}function F(P){const{div:B,scale:R,properties:L,ctx:ht,prevFontSize:st,prevFontFamily:At}=P,{style:Tt}=B;let ot="";if(L.canvasWidth!==0&&L.hasText){const{fontFamily:nt}=Tt,{canvasWidth:Mt,fontSize:Dt}=L;(st!==Dt||At!==nt)&&(ht.font=`${Dt*R}px ${nt}`,P.prevFontSize=Dt,P.prevFontFamily=nt);const{width:Lt}=ht.measureText(B.textContent);Lt>0&&(ot=`scaleX(${Mt*R/Lt})`)}L.angle!==0&&(ot=`rotate(${L.angle}deg) ${ot}`),ot.length>0&&(Tt.transform=ot)}function D(P){if(P._canceled)return;const B=P._textDivs,R=P._capability;if(B.length>N){R.resolve();return}if(!P._isReadableStream)for(const L of B)P._layoutText(L);R.resolve()}class Z{constructor({textContentSource:B,container:R,viewport:L,textDivs:ht,textDivProperties:st,textContentItemsStr:At}){var Dt;this._textContentSource=B,this._isReadableStream=B instanceof ReadableStream,this._container=this._rootContainer=R,this._textDivs=ht||[],this._textContentItemsStr=At||[],this._fontInspectorEnabled=!!((Dt=globalThis.FontInspector)!=null&&Dt.enabled),this._reader=null,this._textDivProperties=st||new WeakMap,this._canceled=!1,this._capability=Promise.withResolvers(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:L.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:k()};const{pageWidth:Tt,pageHeight:ot,pageX:nt,pageY:Mt}=L.rawDims;this._transform=[1,0,0,-1,-nt,Mt+ot],this._pageWidth=Tt,this._pageHeight=ot,(0,J.setLayerDimensions)(R,L),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new d.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new d.AbortException("TextLayer task cancelled."))}_processItems(B,R){for(const L of B){if(L.str===void 0){if(L.type==="beginMarkedContentProps"||L.type==="beginMarkedContent"){const ht=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),L.id!==null&&this._container.setAttribute("id",`${L.id}`),ht.append(this._container)}else L.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(L.str),y(this,L,R)}}_layoutText(B){const R=this._layoutTextParams.properties=this._textDivProperties.get(B);if(this._layoutTextParams.div=B,F(this._layoutTextParams),R.hasText&&this._container.append(B),R.hasEOL){const L=document.createElement("br");L.setAttribute("role","presentation"),this._container.append(L)}}_render(){const{promise:B,resolve:R,reject:L}=Promise.withResolvers();let ht=Object.create(null);if(this._isReadableStream){const st=()=>{this._reader.read().then(({value:At,done:Tt})=>{if(Tt){R();return}Object.assign(ht,At.styles),this._processItems(At.items,ht),st()},L)};this._reader=this._textContentSource.getReader(),st()}else if(this._textContentSource){const{items:st,styles:At}=this._textContentSource;this._processItems(st,At),R()}else throw new Error('No "textContentSource" parameter specified.');B.then(()=>{ht=null,D(this)},this._capability.reject)}}function U(P){const B=new Z(P);return B._render(),B}function K({container:P,viewport:B,textDivs:R,textDivProperties:L,mustRotate:ht=!0,mustRescale:st=!0}){if(ht&&(0,J.setLayerDimensions)(P,{rotation:B.rotation}),st){const At=k(),Tt={prevFontSize:null,prevFontFamily:null,div:null,scale:B.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:At};for(const ot of R)Tt.properties=L.get(ot),Tt.div=ot,F(Tt)}}},585:(se,Vt,dt)=>{dt.d(Vt,{PDFDataTransportStream:()=>N});var d=dt(292),J=dt(419);class N{constructor(I,{disableRange:k=!1,disableStream:j=!1}){(0,d.assert)(I,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:x,initialData:y,progressiveDone:F,contentDispositionFilename:D}=I;if(this._queuedChunks=[],this._progressiveDone=F,this._contentDispositionFilename=D,(y==null?void 0:y.length)>0){const Z=y instanceof Uint8Array&&y.byteLength===y.buffer.byteLength?y.buffer:new Uint8Array(y).buffer;this._queuedChunks.push(Z)}this._pdfDataRangeTransport=I,this._isStreamingSupported=!j,this._isRangeSupported=!k,this._contentLength=x,this._fullRequestReader=null,this._rangeReaders=[],I.addRangeListener((Z,U)=>{this._onReceiveData({begin:Z,chunk:U})}),I.addProgressListener((Z,U)=>{this._onProgress({loaded:Z,total:U})}),I.addProgressiveReadListener(Z=>{this._onReceiveData({chunk:Z})}),I.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),I.transportReady()}_onReceiveData({begin:I,chunk:k}){const j=k instanceof Uint8Array&&k.byteLength===k.buffer.byteLength?k.buffer:new Uint8Array(k).buffer;if(I===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(j):this._queuedChunks.push(j);else{const x=this._rangeReaders.some(function(y){return y._begin!==I?!1:(y._enqueue(j),!0)});(0,d.assert)(x,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var I;return((I=this._fullRequestReader)==null?void 0:I._loaded)??0}_onProgress(I){var k,j,x,y;I.total===void 0?(j=(k=this._rangeReaders[0])==null?void 0:k.onProgress)==null||j.call(k,{loaded:I.loaded}):(y=(x=this._fullRequestReader)==null?void 0:x.onProgress)==null||y.call(x,{loaded:I.loaded,total:I.total})}_onProgressiveDone(){var I;(I=this._fullRequestReader)==null||I.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(I){const k=this._rangeReaders.indexOf(I);k>=0&&this._rangeReaders.splice(k,1)}getFullReader(){(0,d.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const I=this._queuedChunks;return this._queuedChunks=null,new Y(this,I,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(I,k){if(k<=this._progressiveDataLength)return null;const j=new pt(this,I,k);return this._pdfDataRangeTransport.requestDataRange(I,k),this._rangeReaders.push(j),j}cancelAllRequests(I){var k;(k=this._fullRequestReader)==null||k.cancel(I);for(const j of this._rangeReaders.slice(0))j.cancel(I);this._pdfDataRangeTransport.abort()}}class Y{constructor(I,k,j=!1,x=null){this._stream=I,this._done=j||!1,this._filename=(0,J.isPdfFile)(x)?x:null,this._queuedChunks=k||[],this._loaded=0;for(const y of this._queuedChunks)this._loaded+=y.byteLength;this._requests=[],this._headersReady=Promise.resolve(),I._fullRequestReader=this,this.onProgress=null}_enqueue(I){this._done||(this._requests.length>0?this._requests.shift().resolve({value:I,done:!1}):this._queuedChunks.push(I),this._loaded+=I.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const I=Promise.withResolvers();return this._requests.push(I),I.promise}cancel(I){this._done=!0;for(const k of this._requests)k.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class pt{constructor(I,k,j){this._stream=I,this._begin=k,this._end=j,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(I){if(!this._done){if(this._requests.length===0)this._queuedChunk=I;else{this._requests.shift().resolve({value:I,done:!1});for(const k of this._requests)k.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const k=this._queuedChunk;return this._queuedChunk=null,{value:k,done:!1}}if(this._done)return{value:void 0,done:!0};const I=Promise.withResolvers();return this._requests.push(I),I.promise}cancel(I){this._done=!0;for(const k of this._requests)k.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},164:(se,Vt,dt)=>{var J,N;dt.d(Vt,{GlobalWorkerOptions:()=>d});class d{static get workerPort(){return t(this,J)}static set workerPort(pt){if(!(typeof Worker<"u"&&pt instanceof Worker)&&pt!==null)throw new Error("Invalid `workerPort` type.");_(this,J,pt)}static get workerSrc(){return t(this,N)}static set workerSrc(pt){if(typeof pt!="string")throw new Error("Invalid `workerSrc` type.");_(this,N,pt)}}J=new WeakMap,N=new WeakMap,w(d,J,null),w(d,N,"")},284:(se,Vt,dt)=>{dt.d(Vt,{XfaLayer:()=>J});var d=dt(50);class J{static setupStorage(Y,pt,H,I,k){const j=I.getValue(pt,{value:null});switch(H.name){case"textarea":if(j.value!==null&&(Y.textContent=j.value),k==="print")break;Y.addEventListener("input",x=>{I.setValue(pt,{value:x.target.value})});break;case"input":if(H.attributes.type==="radio"||H.attributes.type==="checkbox"){if(j.value===H.attributes.xfaOn?Y.setAttribute("checked",!0):j.value===H.attributes.xfaOff&&Y.removeAttribute("checked"),k==="print")break;Y.addEventListener("change",x=>{I.setValue(pt,{value:x.target.checked?x.target.getAttribute("xfaOn"):x.target.getAttribute("xfaOff")})})}else{if(j.value!==null&&Y.setAttribute("value",j.value),k==="print")break;Y.addEventListener("input",x=>{I.setValue(pt,{value:x.target.value})})}break;case"select":if(j.value!==null){Y.setAttribute("value",j.value);for(const x of H.children)x.attributes.value===j.value?x.attributes.selected=!0:x.attributes.hasOwnProperty("selected")&&delete x.attributes.selected}Y.addEventListener("input",x=>{const y=x.target.options,F=y.selectedIndex===-1?"":y[y.selectedIndex].value;I.setValue(pt,{value:F})});break}}static setAttributes({html:Y,element:pt,storage:H=null,intent:I,linkService:k}){const{attributes:j}=pt,x=Y instanceof HTMLAnchorElement;j.type==="radio"&&(j.name=`${j.name}-${I}`);for(const[y,F]of Object.entries(j))if(F!=null)switch(y){case"class":F.length&&Y.setAttribute(y,F.join(" "));break;case"dataId":break;case"id":Y.setAttribute("data-element-id",F);break;case"style":Object.assign(Y.style,F);break;case"textContent":Y.textContent=F;break;default:(!x||y!=="href"&&y!=="newWindow")&&Y.setAttribute(y,F)}x&&k.addLinkAttributes(Y,j.href,j.newWindow),H&&j.dataId&&this.setupStorage(Y,j.dataId,pt,H)}static render(Y){var Z,U;const pt=Y.annotationStorage,H=Y.linkService,I=Y.xfaHtml,k=Y.intent||"display",j=document.createElement(I.name);I.attributes&&this.setAttributes({html:j,element:I,intent:k,linkService:H});const x=k!=="richText",y=Y.div;if(y.append(j),Y.viewport){const K=`matrix(${Y.viewport.transform.join(",")})`;y.style.transform=K}x&&y.setAttribute("class","xfaLayer xfaFont");const F=[];if(I.children.length===0){if(I.value){const K=document.createTextNode(I.value);j.append(K),x&&d.XfaText.shouldBuildText(I.name)&&F.push(K)}return{textDivs:F}}const D=[[I,-1,j]];for(;D.length>0;){const[K,P,B]=D.at(-1);if(P+1===K.children.length){D.pop();continue}const R=K.children[++D.at(-1)[1]];if(R===null)continue;const{name:L}=R;if(L==="#text"){const st=document.createTextNode(R.value);F.push(st),B.append(st);continue}const ht=(Z=R==null?void 0:R.attributes)!=null&&Z.xmlns?document.createElementNS(R.attributes.xmlns,L):document.createElement(L);if(B.append(ht),R.attributes&&this.setAttributes({html:ht,element:R,storage:pt,intent:k,linkService:H}),((U=R.children)==null?void 0:U.length)>0)D.push([R,-1,ht]);else if(R.value){const st=document.createTextNode(R.value);x&&d.XfaText.shouldBuildText(L)&&F.push(st),ht.append(st)}}for(const K of y.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))K.setAttribute("readOnly",!0);return{textDivs:F}}static update(Y){const pt=`matrix(${Y.viewport.transform.join(",")})`;Y.div.style.transform=pt,Y.div.hidden=!1}}},50:(se,Vt,dt)=>{dt.d(Vt,{XfaText:()=>d});class d{static textContent(N){const Y=[],pt={items:Y,styles:Object.create(null)};function H(I){var x;if(!I)return;let k=null;const j=I.name;if(j==="#text")k=I.value;else if(d.shouldBuildText(j))(x=I==null?void 0:I.attributes)!=null&&x.textContent?k=I.attributes.textContent:I.value&&(k=I.value);else return;if(k!==null&&Y.push({str:k}),!!I.children)for(const y of I.children)H(y)}return H(N),pt}static shouldBuildText(N){return!(N==="textarea"||N==="input"||N==="option"||N==="select")}}},228:(se,Vt,dt)=>{dt.a(se,async(d,J)=>{try{dt.d(Vt,{AbortException:()=>N.AbortException,AnnotationEditorLayer:()=>I.AnnotationEditorLayer,AnnotationEditorParamsType:()=>N.AnnotationEditorParamsType,AnnotationEditorType:()=>N.AnnotationEditorType,AnnotationEditorUIManager:()=>k.AnnotationEditorUIManager,AnnotationLayer:()=>j.AnnotationLayer,AnnotationMode:()=>N.AnnotationMode,CMapCompressionType:()=>N.CMapCompressionType,ColorPicker:()=>x.ColorPicker,DOMSVGFactory:()=>pt.DOMSVGFactory,DrawLayer:()=>y.DrawLayer,FeatureTest:()=>N.FeatureTest,GlobalWorkerOptions:()=>F.GlobalWorkerOptions,ImageKind:()=>N.ImageKind,InvalidPDFException:()=>N.InvalidPDFException,MissingPDFException:()=>N.MissingPDFException,OPS:()=>N.OPS,Outliner:()=>D.Outliner,PDFDataRangeTransport:()=>Y.PDFDataRangeTransport,PDFDateString:()=>pt.PDFDateString,PDFWorker:()=>Y.PDFWorker,PasswordResponses:()=>N.PasswordResponses,PermissionFlag:()=>N.PermissionFlag,PixelsPerInch:()=>pt.PixelsPerInch,RenderingCancelledException:()=>pt.RenderingCancelledException,UnexpectedResponseException:()=>N.UnexpectedResponseException,Util:()=>N.Util,VerbosityLevel:()=>N.VerbosityLevel,XfaLayer:()=>Z.XfaLayer,build:()=>Y.build,createValidAbsoluteUrl:()=>N.createValidAbsoluteUrl,fetchData:()=>pt.fetchData,getDocument:()=>Y.getDocument,getFilenameFromUrl:()=>pt.getFilenameFromUrl,getPdfFilenameFromUrl:()=>pt.getPdfFilenameFromUrl,getXfaPageViewport:()=>pt.getXfaPageViewport,isDataScheme:()=>pt.isDataScheme,isPdfFile:()=>pt.isPdfFile,noContextMenu:()=>pt.noContextMenu,normalizeUnicode:()=>N.normalizeUnicode,renderTextLayer:()=>H.renderTextLayer,setLayerDimensions:()=>pt.setLayerDimensions,shadow:()=>N.shadow,updateTextLayer:()=>H.updateTextLayer,version:()=>Y.version});var N=dt(292),Y=dt(831),pt=dt(419),H=dt(814),I=dt(731),k=dt(830),j=dt(976),x=dt(259),y=dt(47),F=dt(164),D=dt(61),Z=dt(284),U=d([Y]);Y=(U.then?(await U)():U)[0];const K="4.2.67",P="49b388101";J()}catch(K){J(K)}})},178:(se,Vt,dt)=>{var H,kr,Lr,pi;dt.d(Vt,{MessageHandler:()=>pt});var d=dt(292);const J={UNKNOWN:0,DATA:1,ERROR:2},N={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Y(x){switch(x instanceof Error||typeof x=="object"&&x!==null||(0,d.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),x.name){case"AbortException":return new d.AbortException(x.message);case"MissingPDFException":return new d.MissingPDFException(x.message);case"PasswordException":return new d.PasswordException(x.message,x.code);case"UnexpectedResponseException":return new d.UnexpectedResponseException(x.message,x.status);case"UnknownErrorException":return new d.UnknownErrorException(x.message,x.details);default:return new d.UnknownErrorException(x.message,x.toString())}}class pt{constructor(y,F,D){w(this,H);this.sourceName=y,this.targetName=F,this.comObj=D,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=Z=>{const U=Z.data;if(U.targetName!==this.sourceName)return;if(U.stream){A(this,H,Lr).call(this,U);return}if(U.callback){const P=U.callbackId,B=this.callbackCapabilities[P];if(!B)throw new Error(`Cannot resolve callback ${P}`);if(delete this.callbackCapabilities[P],U.callback===J.DATA)B.resolve(U.data);else if(U.callback===J.ERROR)B.reject(Y(U.reason));else throw new Error("Unexpected callback case");return}const K=this.actionHandler[U.action];if(!K)throw new Error(`Unknown action from worker: ${U.action}`);if(U.callbackId){const P=this.sourceName,B=U.sourceName;new Promise(function(R){R(K(U.data))}).then(function(R){D.postMessage({sourceName:P,targetName:B,callback:J.DATA,callbackId:U.callbackId,data:R})},function(R){D.postMessage({sourceName:P,targetName:B,callback:J.ERROR,callbackId:U.callbackId,reason:Y(R)})});return}if(U.streamId){A(this,H,kr).call(this,U);return}K(U.data)},D.addEventListener("message",this._onComObjOnMessage)}on(y,F){const D=this.actionHandler;if(D[y])throw new Error(`There is already an actionName called "${y}"`);D[y]=F}send(y,F,D){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:y,data:F},D)}sendWithPromise(y,F,D){const Z=this.callbackId++,U=Promise.withResolvers();this.callbackCapabilities[Z]=U;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:y,callbackId:Z,data:F},D)}catch(K){U.reject(K)}return U.promise}sendWithStream(y,F,D,Z){const U=this.streamId++,K=this.sourceName,P=this.targetName,B=this.comObj;return new ReadableStream({start:R=>{const L=Promise.withResolvers();return this.streamControllers[U]={controller:R,startCall:L,pullCall:null,cancelCall:null,isClosed:!1},B.postMessage({sourceName:K,targetName:P,action:y,streamId:U,data:F,desiredSize:R.desiredSize},Z),L.promise},pull:R=>{const L=Promise.withResolvers();return this.streamControllers[U].pullCall=L,B.postMessage({sourceName:K,targetName:P,stream:N.PULL,streamId:U,desiredSize:R.desiredSize}),L.promise},cancel:R=>{(0,d.assert)(R instanceof Error,"cancel must have a valid reason");const L=Promise.withResolvers();return this.streamControllers[U].cancelCall=L,this.streamControllers[U].isClosed=!0,B.postMessage({sourceName:K,targetName:P,stream:N.CANCEL,streamId:U,reason:Y(R)}),L.promise}},D)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}H=new WeakSet,kr=function(y){const F=y.streamId,D=this.sourceName,Z=y.sourceName,U=this.comObj,K=this,P=this.actionHandler[y.action],B={enqueue(R,L=1,ht){if(this.isCancelled)return;const st=this.desiredSize;this.desiredSize-=L,st>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),U.postMessage({sourceName:D,targetName:Z,stream:N.ENQUEUE,streamId:F,chunk:R},ht)},close(){this.isCancelled||(this.isCancelled=!0,U.postMessage({sourceName:D,targetName:Z,stream:N.CLOSE,streamId:F}),delete K.streamSinks[F])},error(R){(0,d.assert)(R instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,U.postMessage({sourceName:D,targetName:Z,stream:N.ERROR,streamId:F,reason:Y(R)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:y.desiredSize,ready:null};B.sinkCapability.resolve(),B.ready=B.sinkCapability.promise,this.streamSinks[F]=B,new Promise(function(R){R(P(y.data,B))}).then(function(){U.postMessage({sourceName:D,targetName:Z,stream:N.START_COMPLETE,streamId:F,success:!0})},function(R){U.postMessage({sourceName:D,targetName:Z,stream:N.START_COMPLETE,streamId:F,reason:Y(R)})})},Lr=function(y){const F=y.streamId,D=this.sourceName,Z=y.sourceName,U=this.comObj,K=this.streamControllers[F],P=this.streamSinks[F];switch(y.stream){case N.START_COMPLETE:y.success?K.startCall.resolve():K.startCall.reject(Y(y.reason));break;case N.PULL_COMPLETE:y.success?K.pullCall.resolve():K.pullCall.reject(Y(y.reason));break;case N.PULL:if(!P){U.postMessage({sourceName:D,targetName:Z,stream:N.PULL_COMPLETE,streamId:F,success:!0});break}P.desiredSize<=0&&y.desiredSize>0&&P.sinkCapability.resolve(),P.desiredSize=y.desiredSize,new Promise(function(B){var R;B((R=P.onPull)==null?void 0:R.call(P))}).then(function(){U.postMessage({sourceName:D,targetName:Z,stream:N.PULL_COMPLETE,streamId:F,success:!0})},function(B){U.postMessage({sourceName:D,targetName:Z,stream:N.PULL_COMPLETE,streamId:F,reason:Y(B)})});break;case N.ENQUEUE:if((0,d.assert)(K,"enqueue should have stream controller"),K.isClosed)break;K.controller.enqueue(y.chunk);break;case N.CLOSE:if((0,d.assert)(K,"close should have stream controller"),K.isClosed)break;K.isClosed=!0,K.controller.close(),A(this,H,pi).call(this,K,F);break;case N.ERROR:(0,d.assert)(K,"error should have stream controller"),K.controller.error(Y(y.reason)),A(this,H,pi).call(this,K,F);break;case N.CANCEL_COMPLETE:y.success?K.cancelCall.resolve():K.cancelCall.reject(Y(y.reason)),A(this,H,pi).call(this,K,F);break;case N.CANCEL:if(!P)break;new Promise(function(B){var R;B((R=P.onCancel)==null?void 0:R.call(P,Y(y.reason)))}).then(function(){U.postMessage({sourceName:D,targetName:Z,stream:N.CANCEL_COMPLETE,streamId:F,success:!0})},function(B){U.postMessage({sourceName:D,targetName:Z,stream:N.CANCEL_COMPLETE,streamId:F,reason:Y(B)})}),P.sinkCapability.reject(Y(y.reason)),P.isCancelled=!0,delete this.streamSinks[F];break;default:throw new Error("Unexpected stream case")}},pi=async function(y,F){var D,Z,U;await Promise.allSettled([(D=y.startCall)==null?void 0:D.promise,(Z=y.pullCall)==null?void 0:Z.promise,(U=y.cancelCall)==null?void 0:U.promise]),delete this.streamControllers[F]}},651:(se,Vt,dt)=>{dt.d(Vt,{MurmurHash3_64:()=>Y});const d=3285377520,J=4294901760,N=65535;class Y{constructor(H){this.h1=H?H&4294967295:d,this.h2=H?H&4294967295:d}update(H){let I,k;if(typeof H=="string"){I=new Uint8Array(H.length*2),k=0;for(let L=0,ht=H.length;L<ht;L++){const st=H.charCodeAt(L);st<=255?I[k++]=st:(I[k++]=st>>>8,I[k++]=st&255)}}else if(ArrayBuffer.isView(H))I=H.slice(),k=I.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const j=k>>2,x=k-j*4,y=new Uint32Array(I.buffer,0,j);let F=0,D=0,Z=this.h1,U=this.h2;const K=3432918353,P=461845907,B=K&N,R=P&N;for(let L=0;L<j;L++)L&1?(F=y[L],F=F*K&J|F*B&N,F=F<<15|F>>>17,F=F*P&J|F*R&N,Z^=F,Z=Z<<13|Z>>>19,Z=Z*5+3864292196):(D=y[L],D=D*K&J|D*B&N,D=D<<15|D>>>17,D=D*P&J|D*R&N,U^=D,U=U<<13|U>>>19,U=U*5+3864292196);switch(F=0,x){case 3:F^=I[j*4+2]<<16;case 2:F^=I[j*4+1]<<8;case 1:F^=I[j*4],F=F*K&J|F*B&N,F=F<<15|F>>>17,F=F*P&J|F*R&N,j&1?Z^=F:U^=F}this.h1=Z,this.h2=U}hexdigest(){let H=this.h1,I=this.h2;return H^=I>>>1,H=H*3981806797&J|H*36045&N,I=I*4283543511&J|((I<<16|H>>>16)*2950163797&J)>>>16,H^=I>>>1,H=H*444984403&J|H*60499&N,I=I*3301882366&J|((I<<16|H>>>16)*3120437893&J)>>>16,H^=I>>>1,(H>>>0).toString(16).padStart(8,"0")+(I>>>0).toString(16).padStart(8,"0")}}},292:(se,Vt,dt)=>{var u,gi,fn;dt.d(Vt,{AbortException:()=>ue,AnnotationBorderStyleType:()=>U,AnnotationEditorParamsType:()=>x,AnnotationEditorPrefix:()=>k,AnnotationEditorType:()=>j,AnnotationMode:()=>I,AnnotationPrefix:()=>l,AnnotationType:()=>Z,BaseException:()=>Xt,CMapCompressionType:()=>P,FONT_IDENTITY_MATRIX:()=>N,FeatureTest:()=>Ot,FontRenderOps:()=>g,FormatError:()=>Qt,IDENTITY_MATRIX:()=>J,ImageKind:()=>D,InvalidPDFException:()=>ne,LINE_FACTOR:()=>pt,MAX_IMAGE_SIZE_TO_CACHE:()=>Y,MissingPDFException:()=>oe,OPS:()=>B,PasswordException:()=>ae,PasswordResponses:()=>R,PermissionFlag:()=>y,RenderingIntentFlag:()=>H,TextRenderingMode:()=>F,UnexpectedResponseException:()=>Rt,UnknownErrorException:()=>Jt,Util:()=>gt,VerbosityLevel:()=>K,assert:()=>nt,bytesToString:()=>be,createValidAbsoluteUrl:()=>Dt,getUuid:()=>h,getVerbosityLevel:()=>st,info:()=>At,isNodeJS:()=>d,normalizeUnicode:()=>a,objectFromMap:()=>ee,setVerbosityLevel:()=>ht,shadow:()=>Lt,string32:()=>le,stringToBytes:()=>Ut,unreachable:()=>ot,warn:()=>Tt});const d=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),J=[1,0,0,1,0,0],N=[.001,0,0,.001,0,0],Y=1e7,pt=1.35,H={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},I={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},k="pdfjs_internal_editor_",j={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},x={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},y={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},F={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},D={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Z={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},U={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},K={ERRORS:0,WARNINGS:1,INFOS:5},P={NONE:0,BINARY:1},B={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},R={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let L=K.WARNINGS;function ht(e){Number.isInteger(e)&&(L=e)}function st(){return L}function At(e){L>=K.INFOS&&console.log(`Info: ${e}`)}function Tt(e){L>=K.WARNINGS&&console.log(`Warning: ${e}`)}function ot(e){throw new Error(e)}function nt(e,i){e||ot(i)}function Mt(e){switch(e==null?void 0:e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Dt(e,i=null,o=null){var m;if(!e)return null;try{if(o&&typeof e=="string"&&(o.addDefaultProtocol&&e.startsWith("www.")&&((m=e.match(/\./g))==null?void 0:m.length)>=2&&(e=`http://${e}`),o.tryConvertEncoding))try{e=S(e)}catch{}const T=i?new URL(e,i):new URL(e);if(Mt(T))return T}catch{}return null}function Lt(e,i,o,m=!1){return Object.defineProperty(e,i,{value:o,enumerable:!m,configurable:!0,writable:!1}),o}const Xt=function(){function e(i,o){this.constructor===e&&ot("Cannot initialize BaseException."),this.message=i,this.name=o}return e.prototype=new Error,e.constructor=e,e}();class ae extends Xt{constructor(i,o){super(i,"PasswordException"),this.code=o}}class Jt extends Xt{constructor(i,o){super(i,"UnknownErrorException"),this.details=o}}class ne extends Xt{constructor(i){super(i,"InvalidPDFException")}}class oe extends Xt{constructor(i){super(i,"MissingPDFException")}}class Rt extends Xt{constructor(i,o){super(i,"UnexpectedResponseException"),this.status=o}}class Qt extends Xt{constructor(i){super(i,"FormatError")}}class ue extends Xt{constructor(i){super(i,"AbortException")}}function be(e){(typeof e!="object"||(e==null?void 0:e.length)===void 0)&&ot("Invalid argument for bytesToString");const i=e.length,o=8192;if(i<o)return String.fromCharCode.apply(null,e);const m=[];for(let T=0;T<i;T+=o){const $=Math.min(T+o,i),W=e.subarray(T,$);m.push(String.fromCharCode.apply(null,W))}return m.join("")}function Ut(e){typeof e!="string"&&ot("Invalid argument for stringToBytes");const i=e.length,o=new Uint8Array(i);for(let m=0;m<i;++m)o[m]=e.charCodeAt(m)&255;return o}function le(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,e&255)}function ee(e){const i=Object.create(null);for(const[o,m]of e)i[o]=m;return i}function ce(){const e=new Uint8Array(4);return e[0]=1,new Uint32Array(e.buffer,0,1)[0]===1}function Zt(){try{return new Function(""),!0}catch{return!1}}class Ot{static get isLittleEndian(){return Lt(this,"isLittleEndian",ce())}static get isEvalSupported(){return Lt(this,"isEvalSupported",Zt())}static get isOffscreenCanvasSupported(){return Lt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Lt(this,"platform",{isMac:navigator.platform.includes("Mac")}):Lt(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var i,o;return Lt(this,"isCSSRoundSupported",(o=(i=globalThis.CSS)==null?void 0:i.supports)==null?void 0:o.call(i,"width: round(1.5px, 1px)"))}}const bt=Array.from(Array(256).keys(),e=>e.toString(16).padStart(2,"0"));class gt{static makeHexColor(i,o,m){return`#${bt[i]}${bt[o]}${bt[m]}`}static scaleMinMax(i,o){let m;i[0]?(i[0]<0&&(m=o[0],o[0]=o[2],o[2]=m),o[0]*=i[0],o[2]*=i[0],i[3]<0&&(m=o[1],o[1]=o[3],o[3]=m),o[1]*=i[3],o[3]*=i[3]):(m=o[0],o[0]=o[1],o[1]=m,m=o[2],o[2]=o[3],o[3]=m,i[1]<0&&(m=o[1],o[1]=o[3],o[3]=m),o[1]*=i[1],o[3]*=i[1],i[2]<0&&(m=o[0],o[0]=o[2],o[2]=m),o[0]*=i[2],o[2]*=i[2]),o[0]+=i[4],o[1]+=i[5],o[2]+=i[4],o[3]+=i[5]}static transform(i,o){return[i[0]*o[0]+i[2]*o[1],i[1]*o[0]+i[3]*o[1],i[0]*o[2]+i[2]*o[3],i[1]*o[2]+i[3]*o[3],i[0]*o[4]+i[2]*o[5]+i[4],i[1]*o[4]+i[3]*o[5]+i[5]]}static applyTransform(i,o){const m=i[0]*o[0]+i[1]*o[2]+o[4],T=i[0]*o[1]+i[1]*o[3]+o[5];return[m,T]}static applyInverseTransform(i,o){const m=o[0]*o[3]-o[1]*o[2],T=(i[0]*o[3]-i[1]*o[2]+o[2]*o[5]-o[4]*o[3])/m,$=(-i[0]*o[1]+i[1]*o[0]+o[4]*o[1]-o[5]*o[0])/m;return[T,$]}static getAxialAlignedBoundingBox(i,o){const m=this.applyTransform(i,o),T=this.applyTransform(i.slice(2,4),o),$=this.applyTransform([i[0],i[3]],o),W=this.applyTransform([i[2],i[1]],o);return[Math.min(m[0],T[0],$[0],W[0]),Math.min(m[1],T[1],$[1],W[1]),Math.max(m[0],T[0],$[0],W[0]),Math.max(m[1],T[1],$[1],W[1])]}static inverseTransform(i){const o=i[0]*i[3]-i[1]*i[2];return[i[3]/o,-i[1]/o,-i[2]/o,i[0]/o,(i[2]*i[5]-i[4]*i[3])/o,(i[4]*i[1]-i[5]*i[0])/o]}static singularValueDecompose2dScale(i){const o=[i[0],i[2],i[1],i[3]],m=i[0]*o[0]+i[1]*o[2],T=i[0]*o[1]+i[1]*o[3],$=i[2]*o[0]+i[3]*o[2],W=i[2]*o[1]+i[3]*o[3],tt=(m+W)/2,ft=Math.sqrt((m+W)**2-4*(m*W-$*T))/2,it=tt+ft||1,wt=tt-ft||1;return[Math.sqrt(it),Math.sqrt(wt)]}static normalizeRect(i){const o=i.slice(0);return i[0]>i[2]&&(o[0]=i[2],o[2]=i[0]),i[1]>i[3]&&(o[1]=i[3],o[3]=i[1]),o}static intersect(i,o){const m=Math.max(Math.min(i[0],i[2]),Math.min(o[0],o[2])),T=Math.min(Math.max(i[0],i[2]),Math.max(o[0],o[2]));if(m>T)return null;const $=Math.max(Math.min(i[1],i[3]),Math.min(o[1],o[3])),W=Math.min(Math.max(i[1],i[3]),Math.max(o[1],o[3]));return $>W?null:[m,$,T,W]}static bezierBoundingBox(i,o,m,T,$,W,tt,ft,it){return it?(it[0]=Math.min(it[0],i,tt),it[1]=Math.min(it[1],o,ft),it[2]=Math.max(it[2],i,tt),it[3]=Math.max(it[3],o,ft)):it=[Math.min(i,tt),Math.min(o,ft),Math.max(i,tt),Math.max(o,ft)],A(this,u,fn).call(this,i,m,$,tt,o,T,W,ft,3*(-i+3*(m-$)+tt),6*(i-2*m+$),3*(m-i),it),A(this,u,fn).call(this,i,m,$,tt,o,T,W,ft,3*(-o+3*(T-W)+ft),6*(o-2*T+W),3*(T-o),it),it}}u=new WeakSet,gi=function(i,o,m,T,$,W,tt,ft,it,wt){if(it<=0||it>=1)return;const Nt=1-it,Gt=it*it,Wt=Gt*it,Ht=Nt*(Nt*(Nt*i+3*it*o)+3*Gt*m)+Wt*T,lt=Nt*(Nt*(Nt*$+3*it*W)+3*Gt*tt)+Wt*ft;wt[0]=Math.min(wt[0],Ht),wt[1]=Math.min(wt[1],lt),wt[2]=Math.max(wt[2],Ht),wt[3]=Math.max(wt[3],lt)},fn=function(i,o,m,T,$,W,tt,ft,it,wt,Nt,Gt){if(Math.abs(it)<1e-12){Math.abs(wt)>=1e-12&&A(this,u,gi).call(this,i,o,m,T,$,W,tt,ft,-Nt/wt,Gt);return}const Wt=wt**2-4*Nt*it;if(Wt<0)return;const Ht=Math.sqrt(Wt),lt=2*it;A(this,u,gi).call(this,i,o,m,T,$,W,tt,ft,(-wt+Ht)/lt,Gt),A(this,u,gi).call(this,i,o,m,T,$,W,tt,ft,(-wt-Ht)/lt,Gt)},w(gt,u);function S(e){return decodeURIComponent(escape(e))}let n=null,s=null;function a(e){return n||(n=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,s=new Map([["\uFB05","\u017Ft"]])),e.replaceAll(n,(i,o,m)=>o?o.normalize("NFKC"):s.get(m))}function h(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const e=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(e);else for(let i=0;i<32;i++)e[i]=Math.floor(Math.random()*255);return be(e)}const l="pdfjs_internal_id_",g={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8}}},zs={};function rs(se){var Vt=zs[se];if(Vt!==void 0)return Vt.exports;var dt=zs[se]={exports:{}};return us[se](dt,dt.exports,rs),dt.exports}(()=>{var se=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",Vt=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",dt=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",d=N=>{N&&N.d<1&&(N.d=1,N.forEach(Y=>Y.r--),N.forEach(Y=>Y.r--?Y.r++:Y()))},J=N=>N.map(Y=>{if(Y!==null&&typeof Y=="object"){if(Y[se])return Y;if(Y.then){var pt=[];pt.d=0,Y.then(k=>{H[Vt]=k,d(pt)},k=>{H[dt]=k,d(pt)});var H={};return H[se]=k=>k(pt),H}}var I={};return I[se]=k=>{},I[Vt]=Y,I});rs.a=(N,Y,pt)=>{var H;pt&&((H=[]).d=-1);var I=new Set,k=N.exports,j,x,y,F=new Promise((D,Z)=>{y=Z,x=D});F[Vt]=k,F[se]=D=>(H&&D(H),I.forEach(D),F.catch(Z=>{})),N.exports=F,Y(D=>{j=J(D);var Z,U=()=>j.map(P=>{if(P[dt])throw P[dt];return P[Vt]}),K=new Promise(P=>{Z=()=>P(U),Z.r=0;var B=R=>R!==H&&!I.has(R)&&(I.add(R),R&&!R.d&&(Z.r++,R.push(Z)));j.map(R=>R[se](B))});return Z.r?K:U()},D=>(D?y(F[dt]=D):x(k),d(H))),H&&H.d<0&&(H.d=0)}})(),rs.d=(se,Vt)=>{for(var dt in Vt)rs.o(Vt,dt)&&!rs.o(se,dt)&&Object.defineProperty(se,dt,{enumerable:!0,get:Vt[dt]})},rs.o=(se,Vt)=>Object.prototype.hasOwnProperty.call(se,Vt);var re=rs(228);re=globalThis.pdfjsLib=await(globalThis.pdfjsLibPromise=re),re.AbortException,re.AnnotationEditorLayer,re.AnnotationEditorParamsType,re.AnnotationEditorType,re.AnnotationEditorUIManager,re.AnnotationLayer,re.AnnotationMode,re.CMapCompressionType,re.ColorPicker,re.DOMSVGFactory,re.DrawLayer,re.FeatureTest,An=re.GlobalWorkerOptions,re.ImageKind,re.InvalidPDFException,re.MissingPDFException,re.OPS,re.Outliner,re.PDFDataRangeTransport,re.PDFDateString,re.PDFWorker,re.PasswordResponses,re.PermissionFlag,re.PixelsPerInch,re.RenderingCancelledException,re.UnexpectedResponseException,re.Util,re.VerbosityLevel,re.XfaLayer,re.build,re.createValidAbsoluteUrl,re.fetchData,yn=re.getDocument,re.getFilenameFromUrl,re.getPdfFilenameFromUrl,re.getXfaPageViewport,re.isDataScheme,re.isPdfFile,re.noContextMenu,re.normalizeUnicode,re.renderTextLayer,re.setLayerDimensions,re.shadow,re.updateTextLayer,vn=re.version})();export{Qe as _,Br as __tla,An as a,vn as b,yn as c};
